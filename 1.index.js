(window.webpackJsonp=window.webpackJsonp||[]).push([[1],[,,,,,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._disposables=[],this._isDisposed=!1}return e.prototype.dispose=function(){this._isDisposed=!0,this._disposables.forEach(function(e){return e.dispose()}),this._disposables.length=0},e.prototype.register=function(e){this._disposables.push(e)},e.prototype.unregister=function(e){var t=this._disposables.indexOf(e);-1!==t&&this._disposables.splice(t,1)},e}();t.Disposable=i},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(16),s=r(12);t.DEFAULT_ATTR=256|s.DEFAULT_COLOR<<9,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32;var a=3,l=function(){function e(){this.fg=0,this.bg=0}return e.toColorRGB=function(e){return[e>>>16&255,e>>>8&255,255&e]},e.fromColorRGB=function(e){return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},e.prototype.clone=function(){var t=new e;return t.fg=this.fg,t.bg=this.bg,t},e.prototype.isInverse=function(){return 67108864&this.fg},e.prototype.isBold=function(){return 134217728&this.fg},e.prototype.isUnderline=function(){return 268435456&this.fg},e.prototype.isBlink=function(){return 536870912&this.fg},e.prototype.isInvisible=function(){return 1073741824&this.fg},e.prototype.isItalic=function(){return 67108864&this.bg},e.prototype.isDim=function(){return 134217728&this.bg},e.prototype.getFgColorMode=function(){return 50331648&this.fg},e.prototype.getBgColorMode=function(){return 50331648&this.bg},e.prototype.isFgRGB=function(){return 50331648==(50331648&this.fg)},e.prototype.isBgRGB=function(){return 50331648==(50331648&this.bg)},e.prototype.isFgPalette=function(){return 16777216==(50331648&this.fg)||33554432==(50331648&this.fg)},e.prototype.isBgPalette=function(){return 16777216==(50331648&this.bg)||33554432==(50331648&this.bg)},e.prototype.isFgDefault=function(){return 0==(50331648&this.fg)},e.prototype.isBgDefault=function(){return 0==(50331648&this.bg)},e.prototype.getFgColor=function(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}},e.prototype.getBgColor=function(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}},e}();t.AttributeData=l,t.DEFAULT_ATTR_DATA=Object.freeze(new l);var c=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=0,t.fg=0,t.bg=0,t.combinedData="",t}return n(r,e),r.fromCharData=function(e){var t=new r;return t.setFromCharData(e),t},r.prototype.isCombined=function(){return 2097152&this.content},r.prototype.getWidth=function(){return this.content>>22},r.prototype.getChars=function(){return 2097152&this.content?this.combinedData:2097151&this.content?o.stringFromCodePoint(2097151&this.content):""},r.prototype.getCode=function(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content},r.prototype.setFromCharData=function(e){this.fg=e[t.CHAR_DATA_ATTR_INDEX],this.bg=0;var r=!1;if(e[t.CHAR_DATA_CHAR_INDEX].length>2)r=!0;else if(2===e[t.CHAR_DATA_CHAR_INDEX].length){var i=e[t.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=i&&i<=56319){var n=e[t.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=n&&n<=57343?this.content=1024*(i-55296)+n-56320+65536|e[t.CHAR_DATA_WIDTH_INDEX]<<22:r=!0}else r=!0}else this.content=e[t.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|e[t.CHAR_DATA_WIDTH_INDEX]<<22;r&&(this.combinedData=e[t.CHAR_DATA_CHAR_INDEX],this.content=2097152|e[t.CHAR_DATA_WIDTH_INDEX]<<22)},r.prototype.getAsCharData=function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]},r}(l);t.CellData=c;var h=function(){function e(e,r,i){void 0===i&&(i=!1),this.isWrapped=i,this._combined={},this._data=new Uint32Array(e*a);for(var n=r||c.fromCharData([0,t.NULL_CELL_CHAR,t.NULL_CELL_WIDTH,t.NULL_CELL_CODE]),o=0;o<e;++o)this.setCell(o,n);this.length=e}return e.prototype.get=function(e){var t=this._data[e*a+0],r=2097151&t;return[this._data[e*a+1],2097152&t?this._combined[e]:r?o.stringFromCodePoint(r):"",t>>22,2097152&t?this._combined[e].charCodeAt(this._combined[e].length-1):r]},e.prototype.set=function(e,r){this._data[e*a+1]=r[t.CHAR_DATA_ATTR_INDEX],r[t.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[e]=r[1],this._data[e*a+0]=2097152|e|r[t.CHAR_DATA_WIDTH_INDEX]<<22):this._data[e*a+0]=r[t.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|r[t.CHAR_DATA_WIDTH_INDEX]<<22},e.prototype.getWidth=function(e){return this._data[e*a+0]>>22},e.prototype.hasWidth=function(e){return 12582912&this._data[e*a+0]},e.prototype.getFg=function(e){return this._data[e*a+1]},e.prototype.getBg=function(e){return this._data[e*a+2]},e.prototype.hasContent=function(e){return 4194303&this._data[e*a+0]},e.prototype.getCodePoint=function(e){var t=this._data[e*a+0];return 2097152&t?this._combined[e].charCodeAt(this._combined[e].length-1):2097151&t},e.prototype.isCombined=function(e){return 2097152&this._data[e*a+0]},e.prototype.getString=function(e){var t=this._data[e*a+0];return 2097152&t?this._combined[e]:2097151&t?o.stringFromCodePoint(2097151&t):""},e.prototype.loadCell=function(e,t){var r=e*a;return t.content=this._data[r+0],t.fg=this._data[r+1],t.bg=this._data[r+2],2097152&t.content&&(t.combinedData=this._combined[e]),t},e.prototype.setCell=function(e,t){2097152&t.content&&(this._combined[e]=t.combinedData),this._data[e*a+0]=t.content,this._data[e*a+1]=t.fg,this._data[e*a+2]=t.bg},e.prototype.setCellFromCodePoint=function(e,t,r,i,n){this._data[e*a+0]=t|r<<22,this._data[e*a+1]=i,this._data[e*a+2]=n},e.prototype.addCodepointToCell=function(e,t){var r=this._data[e*a+0];2097152&r?this._combined[e]+=o.stringFromCodePoint(t):(2097151&r?(this._combined[e]=o.stringFromCodePoint(2097151&r)+o.stringFromCodePoint(t),r&=-2097152,r|=2097152):r=t|1<<22,this._data[e*a+0]=r)},e.prototype.insertCells=function(e,t,r){if(e%=this.length,t<this.length-e){for(var i=new c,n=this.length-e-t-1;n>=0;--n)this.setCell(e+t+n,this.loadCell(e+n,i));for(n=0;n<t;++n)this.setCell(e+n,r)}else for(n=e;n<this.length;++n)this.setCell(n,r)},e.prototype.deleteCells=function(e,t,r){if(e%=this.length,t<this.length-e){for(var i=new c,n=0;n<this.length-e-t;++n)this.setCell(e+n,this.loadCell(e+t+n,i));for(n=this.length-t;n<this.length;++n)this.setCell(n,r)}else for(n=e;n<this.length;++n)this.setCell(n,r)},e.prototype.replaceCells=function(e,t,r){for(;e<t&&e<this.length;)this.setCell(e++,r)},e.prototype.resize=function(e,t){if(e!==this.length){if(e>this.length){var r=new Uint32Array(e*a);this.length&&(e*a<this._data.length?r.set(this._data.subarray(0,e*a)):r.set(this._data)),this._data=r;for(var i=this.length;i<e;++i)this.setCell(i,t)}else if(e){(r=new Uint32Array(e*a)).set(this._data.subarray(0,e*a)),this._data=r;var n=Object.keys(this._combined);for(i=0;i<n.length;i++){var o=parseInt(n[i],10);o>=e&&delete this._combined[o]}}else this._data=new Uint32Array(0),this._combined={};this.length=e}},e.prototype.fill=function(e){this._combined={};for(var t=0;t<this.length;++t)this.setCell(t,e)},e.prototype.copyFrom=function(e){for(var t in this.length!==e.length?this._data=new Uint32Array(e._data):this._data.set(e._data),this.length=e.length,this._combined={},e._combined)this._combined[t]=e._combined[t];this.isWrapped=e.isWrapped},e.prototype.clone=function(){var t=new e(0);for(var r in t._data=new Uint32Array(this._data),t.length=this.length,this._combined)t._combined[r]=this._combined[r];return t.isWrapped=this.isWrapped,t},e.prototype.getTrimmedLength=function(){for(var e=this.length-1;e>=0;--e)if(4194303&this._data[e*a+0])return e+(this._data[e*a+0]>>22);return 0},e.prototype.copyCellsFrom=function(e,t,r,i,n){var o=e._data;if(n)for(var s=i-1;s>=0;s--)for(var l=0;l<a;l++)this._data[(r+s)*a+l]=o[(t+s)*a+l];else for(s=0;s<i;s++)for(l=0;l<a;l++)this._data[(r+s)*a+l]=o[(t+s)*a+l];var c=Object.keys(e._combined);for(l=0;l<c.length;l++){var h=parseInt(c[l],10);h>=t&&(this._combined[h-t+r]=e._combined[h])}},e.prototype.translateToString=function(e,r,i){void 0===e&&(e=!1),void 0===r&&(r=0),void 0===i&&(i=this.length),e&&(i=Math.min(i,this.getTrimmedLength()));for(var n="";r<i;){var s=this._data[r*a+0],l=2097151&s;n+=2097152&s?this._combined[r]:l?o.stringFromCodePoint(l):t.WHITESPACE_CELL_CHAR,r+=s>>22||1}return n},e}();t.BufferLine=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._listeners=[]}return Object.defineProperty(e.prototype,"event",{get:function(){var e=this;return this._event||(this._event=function(t){return e._listeners.push(t),{dispose:function(){for(var r=0;r<e._listeners.length;r++)if(e._listeners[r]===t)return void e._listeners.splice(r,1)}}}),this._event},enumerable:!0,configurable:!0}),e.prototype.fire=function(e){for(var t=[],r=0;r<this._listeners.length;r++)t.push(this._listeners[r]);for(r=0;r<t.length;r++)t[r].call(void 0,e)},e}();t.EventEmitter2=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.CHAR_ATLAS_CELL_SPACING=1},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addDisposableDomListener=function(e,t,r,i){return e.addEventListener(t,r,i),{dispose:function(){r&&e.removeEventListener(t,r,i)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="undefined"==typeof navigator,n=i?"node":navigator.userAgent,o=i?"node":navigator.platform;function s(e,t){return e.indexOf(t)>=0}t.isFirefox=!!~n.indexOf("Firefox"),t.isSafari=/^((?!chrome|android).)*safari/i.test(n),t.isMSIE=!!~n.indexOf("MSIE")||!!~n.indexOf("Trident"),t.isMac=s(["Macintosh","MacIntel","MacPPC","Mac68K"],o),t.isIpad="iPad"===o,t.isIphone="iPhone"===o,t.isMSWindows=s(["Windows","Win16","Win32","WinCE"],o),t.isLinux=o.indexOf("Linux")>=0},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_COLOR=256},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.NUL="\0",e.SOH="",e.STX="",e.ETX="",e.EOT="",e.ENQ="",e.ACK="",e.BEL="",e.BS="\b",e.HT="\t",e.LF="\n",e.VT="\v",e.FF="\f",e.CR="\r",e.SO="",e.SI="",e.DLE="",e.DC1="",e.DC2="",e.DC3="",e.DC4="",e.NAK="",e.SYN="",e.ETB="",e.CAN="",e.EM="",e.SUB="",e.ESC="",e.FS="",e.GS="",e.RS="",e.US="",e.SP=" ",e.DEL=""}(t.C0||(t.C0={})),function(e){e.PAD="",e.HOP="",e.BPH="",e.NBH="",e.IND="",e.NEL="",e.SSA="",e.ESA="",e.HTS="",e.HTJ="",e.VTS="",e.PLD="",e.PLU="",e.RI="",e.SS2="",e.SS3="",e.DCS="",e.PU1="",e.PU2="",e.STS="",e.CCH="",e.MW="",e.SPA="",e.EPA="",e.SOS="",e.SGCI="",e.SCI="",e.CSI="",e.ST="",e.OSC="",e.PM="",e.APC=""}(t.C1||(t.C1={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(12),n=r(9),o=r(23),s=r(7),a=function(){function e(e,t,r,i,n){this._container=e,this._alpha=i,this._colors=n,this._scaledCharWidth=0,this._scaledCharHeight=0,this._scaledCellWidth=0,this._scaledCellHeight=0,this._scaledCharLeft=0,this._scaledCharTop=0,this._currentGlyphIdentifier={chars:"",code:0,bg:0,fg:0,bold:!1,dim:!1,italic:!1},this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-"+t+"-layer"),this._canvas.style.zIndex=r.toString(),this._initCanvas(),this._container.appendChild(this._canvas)}return e.prototype.dispose=function(){this._container.removeChild(this._canvas),this._charAtlas&&this._charAtlas.dispose()},e.prototype._initCanvas=function(){this._ctx=this._canvas.getContext("2d",{alpha:this._alpha}),this._alpha||this.clearAll()},e.prototype.onOptionsChanged=function(e){},e.prototype.onBlur=function(e){},e.prototype.onFocus=function(e){},e.prototype.onCursorMove=function(e){},e.prototype.onGridChanged=function(e,t,r){},e.prototype.onSelectionChanged=function(e,t,r,i){void 0===i&&(i=!1)},e.prototype.setColors=function(e,t){this._refreshCharAtlas(e,t)},e.prototype.setTransparency=function(e,t){if(t!==this._alpha){var r=this._canvas;this._alpha=t,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,r),this._refreshCharAtlas(e,this._colors),this.onGridChanged(e,0,e.rows-1)}},e.prototype._refreshCharAtlas=function(e,t){this._scaledCharWidth<=0&&this._scaledCharHeight<=0||(this._charAtlas=o.acquireCharAtlas(e,t,this._scaledCharWidth,this._scaledCharHeight),this._charAtlas.warmUp())},e.prototype.resize=function(e,t){this._scaledCellWidth=t.scaledCellWidth,this._scaledCellHeight=t.scaledCellHeight,this._scaledCharWidth=t.scaledCharWidth,this._scaledCharHeight=t.scaledCharHeight,this._scaledCharLeft=t.scaledCharLeft,this._scaledCharTop=t.scaledCharTop,this._canvas.width=t.scaledCanvasWidth,this._canvas.height=t.scaledCanvasHeight,this._canvas.style.width=t.canvasWidth+"px",this._canvas.style.height=t.canvasHeight+"px",this._alpha||this.clearAll(),this._refreshCharAtlas(e,this._colors)},e.prototype.fillCells=function(e,t,r,i){this._ctx.fillRect(e*this._scaledCellWidth,t*this._scaledCellHeight,r*this._scaledCellWidth,i*this._scaledCellHeight)},e.prototype.fillBottomLineAtCells=function(e,t,r){void 0===r&&(r=1),this._ctx.fillRect(e*this._scaledCellWidth,(t+1)*this._scaledCellHeight-window.devicePixelRatio-1,r*this._scaledCellWidth,window.devicePixelRatio)},e.prototype.fillLeftLineAtCell=function(e,t){this._ctx.fillRect(e*this._scaledCellWidth,t*this._scaledCellHeight,window.devicePixelRatio,this._scaledCellHeight)},e.prototype.strokeRectAtCell=function(e,t,r,i){this._ctx.lineWidth=window.devicePixelRatio,this._ctx.strokeRect(e*this._scaledCellWidth+window.devicePixelRatio/2,t*this._scaledCellHeight+window.devicePixelRatio/2,r*this._scaledCellWidth-window.devicePixelRatio,i*this._scaledCellHeight-window.devicePixelRatio)},e.prototype.clearAll=function(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))},e.prototype.clearCells=function(e,t,r,i){this._alpha?this._ctx.clearRect(e*this._scaledCellWidth,t*this._scaledCellHeight,r*this._scaledCellWidth,i*this._scaledCellHeight):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(e*this._scaledCellWidth,t*this._scaledCellHeight,r*this._scaledCellWidth,i*this._scaledCellHeight))},e.prototype.fillCharTrueColor=function(e,t,r,i){this._ctx.font=this._getFont(e,!1,!1),this._ctx.textBaseline="middle",this._clipRow(e,i),this._ctx.fillText(t.getChars(),r*this._scaledCellWidth+this._scaledCharLeft,i*this._scaledCellHeight+this._scaledCharTop+this._scaledCharHeight/2)},e.prototype.drawChars=function(e,t,r,o){var a,l;t.isFgRGB()||t.isBgRGB()?this._drawUncachedChars(e,t,r,o):(t.isInverse()?(a=t.isBgDefault()?n.INVERTED_DEFAULT_COLOR:t.getBgColor(),l=t.isFgDefault()?n.INVERTED_DEFAULT_COLOR:t.getFgColor()):(l=t.isBgDefault()?i.DEFAULT_COLOR:t.getBgColor(),a=t.isFgDefault()?i.DEFAULT_COLOR:t.getFgColor()),a+=e.options.drawBoldTextInBrightColors&&t.isBold()&&a<8&&a!==n.INVERTED_DEFAULT_COLOR?8:0,this._currentGlyphIdentifier.chars=t.getChars()||s.WHITESPACE_CELL_CHAR,this._currentGlyphIdentifier.code=t.getCode()||s.WHITESPACE_CELL_CODE,this._currentGlyphIdentifier.bg=l,this._currentGlyphIdentifier.fg=a,this._currentGlyphIdentifier.bold=t.isBold()&&e.options.enableBold,this._currentGlyphIdentifier.dim=!!t.isDim(),this._currentGlyphIdentifier.italic=!!t.isItalic(),this._charAtlas&&this._charAtlas.draw(this._ctx,this._currentGlyphIdentifier,r*this._scaledCellWidth+this._scaledCharLeft,o*this._scaledCellHeight+this._scaledCharTop)||this._drawUncachedChars(e,t,r,o))},e.prototype._drawUncachedChars=function(e,t,r,i){if(this._ctx.save(),this._ctx.font=this._getFont(e,t.isBold()&&e.options.enableBold,!!t.isItalic()),this._ctx.textBaseline="middle",t.isInverse())t.isBgDefault()?this._ctx.fillStyle=this._colors.background.css:t.isBgRGB()?this._ctx.fillStyle="rgb("+s.AttributeData.toColorRGB(t.getBgColor()).join(",")+")":this._ctx.fillStyle=this._colors.ansi[t.getBgColor()].css;else if(t.isFgDefault())this._ctx.fillStyle=this._colors.foreground.css;else if(t.isFgRGB())this._ctx.fillStyle="rgb("+s.AttributeData.toColorRGB(t.getFgColor()).join(",")+")";else{var o=t.getFgColor();e.options.drawBoldTextInBrightColors&&t.isBold()&&o<8&&(o+=8),this._ctx.fillStyle=this._colors.ansi[o].css}this._clipRow(e,i),t.isDim()&&(this._ctx.globalAlpha=n.DIM_OPACITY),this._ctx.fillText(t.getChars(),r*this._scaledCellWidth+this._scaledCharLeft,i*this._scaledCellHeight+this._scaledCharTop+this._scaledCharHeight/2),this._ctx.restore()},e.prototype._clipRow=function(e,t){this._ctx.beginPath(),this._ctx.rect(0,t*this._scaledCellHeight,e.cols*this._scaledCellWidth,this._scaledCellHeight),this._ctx.clip()},e.prototype._getFont=function(e,t,r){return(r?"italic":"")+" "+(t?e.options.fontWeightBold:e.options.fontWeight)+" "+e.options.fontSize*window.devicePixelRatio+"px "+e.options.fontFamily},e}();t.BaseRenderLayer=a},function(e,t,r){e.exports=function(){"use strict";var e=navigator.userAgent,t=navigator.platform,r=/gecko\/\d/i.test(e),i=/MSIE \d/.test(e),n=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(e),o=/Edge\/(\d+)/.exec(e),s=i||n||o,a=s&&(i?document.documentMode||6:+(o||n)[1]),l=!o&&/WebKit\//.test(e),c=l&&/Qt\/\d+\.\d+/.test(e),h=!o&&/Chrome\//.test(e),u=/Opera\//.test(e),f=/Apple Computer/.test(navigator.vendor),d=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(e),p=/PhantomJS/.test(e),m=!o&&/AppleWebKit/.test(e)&&/Mobile\/\w+/.test(e),g=/Android/.test(e),_=m||g||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(e),v=m||/Mac/.test(t),y=/\bCrOS\b/.test(e),C=/win/i.test(t),b=u&&e.match(/Version\/(\d*\.\d*)/);b&&(b=Number(b[1])),b&&b>=15&&(u=!1,l=!0);var w=v&&(c||u&&(null==b||b<12.11)),x=r||s&&a>=9;function S(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}var L,k=function(e,t){var r=e.className,i=S(t).exec(r);if(i){var n=r.slice(i.index+i[0].length);e.className=r.slice(0,i.index)+(n?i[1]+n:"")}};function T(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function A(e,t){return T(e).appendChild(t)}function E(e,t,r,i){var n=document.createElement(e);if(r&&(n.className=r),i&&(n.style.cssText=i),"string"==typeof t)n.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)n.appendChild(t[o]);return n}function M(e,t,r,i){var n=E(e,t,r,i);return n.setAttribute("role","presentation"),n}function D(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do{if(11==t.nodeType&&(t=t.host),t==e)return!0}while(t=t.parentNode)}function R(){var e;try{e=document.activeElement}catch(t){e=document.body||null}for(;e&&e.shadowRoot&&e.shadowRoot.activeElement;)e=e.shadowRoot.activeElement;return e}function O(e,t){var r=e.className;S(t).test(r)||(e.className+=(r?" ":"")+t)}function H(e,t){for(var r=e.split(" "),i=0;i<r.length;i++)r[i]&&!S(r[i]).test(t)&&(t+=" "+r[i]);return t}L=document.createRange?function(e,t,r,i){var n=document.createRange();return n.setEnd(i||e,r),n.setStart(e,t),n}:function(e,t,r){var i=document.body.createTextRange();try{i.moveToElementText(e.parentNode)}catch(e){return i}return i.collapse(!0),i.moveEnd("character",r),i.moveStart("character",t),i};var P=function(e){e.select()};function B(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function F(e,t,r){for(var i in t||(t={}),e)!e.hasOwnProperty(i)||!1===r&&t.hasOwnProperty(i)||(t[i]=e[i]);return t}function I(e,t,r,i,n){null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length);for(var o=i||0,s=n||0;;){var a=e.indexOf("\t",o);if(a<0||a>=t)return s+(t-o);s+=a-o,s+=r-s%r,o=a+1}}m?P=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:s&&(P=function(e){try{e.select()}catch(e){}});var W=function(){this.id=null};function N(e,t){for(var r=0;r<e.length;++r)if(e[r]==t)return r;return-1}W.prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)};var U=30,z={toString:function(){return"CodeMirror.Pass"}},j={scroll:!1},K={origin:"*mouse"},G={origin:"+move"};function V(e,t,r){for(var i=0,n=0;;){var o=e.indexOf("\t",i);-1==o&&(o=e.length);var s=o-i;if(o==e.length||n+s>=t)return i+Math.min(s,t-n);if(n+=o-i,i=o+1,(n+=r-n%r)>=t)return i}}var X=[""];function Y(e){for(;X.length<=e;)X.push(q(X)+" ");return X[e]}function q(e){return e[e.length-1]}function Z(e,t){for(var r=[],i=0;i<e.length;i++)r[i]=t(e[i],i);return r}function J(){}function $(e,t){var r;return Object.create?r=Object.create(e):(J.prototype=e,r=new J),t&&F(t,r),r}var Q=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function ee(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||Q.test(e))}function te(e,t){return t?!!(t.source.indexOf("\\w")>-1&&ee(e))||t.test(e):ee(e)}function re(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}var ie=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function ne(e){return e.charCodeAt(0)>=768&&ie.test(e)}function oe(e,t,r){for(;(r<0?t>0:t<e.length)&&ne(e.charAt(t));)t+=r;return t}function se(e,t,r){for(var i=t>r?-1:1;;){if(t==r)return t;var n=(t+r)/2,o=i<0?Math.ceil(n):Math.floor(n);if(o==t)return e(o)?t:r;e(o)?r=o:t=o+i}}var ae=null;function le(e,t,r){var i;ae=null;for(var n=0;n<e.length;++n){var o=e[n];if(o.from<t&&o.to>t)return n;o.to==t&&(o.from!=o.to&&"before"==r?i=n:ae=n),o.from==t&&(o.from!=o.to&&"before"!=r?i=n:ae=n)}return null!=i?i:ae}var ce=function(){var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",t="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";var r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,i=/[stwN]/,n=/[LRr]/,o=/[Lb1n]/,s=/[1n]/;function a(e,t,r){this.level=e,this.from=t,this.to=r}return function(l,c){var h,u="ltr"==c?"L":"R";if(0==l.length||"ltr"==c&&!r.test(l))return!1;for(var f=l.length,d=[],p=0;p<f;++p)d.push((h=l.charCodeAt(p))<=247?e.charAt(h):1424<=h&&h<=1524?"R":1536<=h&&h<=1785?t.charAt(h-1536):1774<=h&&h<=2220?"r":8192<=h&&h<=8203?"w":8204==h?"b":"L");for(var m=0,g=u;m<f;++m){var _=d[m];"m"==_?d[m]=g:g=_}for(var v=0,y=u;v<f;++v){var C=d[v];"1"==C&&"r"==y?d[v]="n":n.test(C)&&(y=C,"r"==C&&(d[v]="R"))}for(var b=1,w=d[0];b<f-1;++b){var x=d[b];"+"==x&&"1"==w&&"1"==d[b+1]?d[b]="1":","!=x||w!=d[b+1]||"1"!=w&&"n"!=w||(d[b]=w),w=x}for(var S=0;S<f;++S){var L=d[S];if(","==L)d[S]="N";else if("%"==L){var k=void 0;for(k=S+1;k<f&&"%"==d[k];++k);for(var T=S&&"!"==d[S-1]||k<f&&"1"==d[k]?"1":"N",A=S;A<k;++A)d[A]=T;S=k-1}}for(var E=0,M=u;E<f;++E){var D=d[E];"L"==M&&"1"==D?d[E]="L":n.test(D)&&(M=D)}for(var R=0;R<f;++R)if(i.test(d[R])){var O=void 0;for(O=R+1;O<f&&i.test(d[O]);++O);for(var H="L"==(R?d[R-1]:u),P="L"==(O<f?d[O]:u),B=H==P?H?"L":"R":u,F=R;F<O;++F)d[F]=B;R=O-1}for(var I,W=[],N=0;N<f;)if(o.test(d[N])){var U=N;for(++N;N<f&&o.test(d[N]);++N);W.push(new a(0,U,N))}else{var z=N,j=W.length;for(++N;N<f&&"L"!=d[N];++N);for(var K=z;K<N;)if(s.test(d[K])){z<K&&W.splice(j,0,new a(1,z,K));var G=K;for(++K;K<N&&s.test(d[K]);++K);W.splice(j,0,new a(2,G,K)),z=K}else++K;z<N&&W.splice(j,0,new a(1,z,N))}return"ltr"==c&&(1==W[0].level&&(I=l.match(/^\s+/))&&(W[0].from=I[0].length,W.unshift(new a(0,0,I[0].length))),1==q(W).level&&(I=l.match(/\s+$/))&&(q(W).to-=I[0].length,W.push(new a(0,f-I[0].length,f)))),"rtl"==c?W.reverse():W}}();function he(e,t){var r=e.order;return null==r&&(r=e.order=ce(e.text,t)),r}var ue=[],fe=function(e,t,r){if(e.addEventListener)e.addEventListener(t,r,!1);else if(e.attachEvent)e.attachEvent("on"+t,r);else{var i=e._handlers||(e._handlers={});i[t]=(i[t]||ue).concat(r)}};function de(e,t){return e._handlers&&e._handlers[t]||ue}function pe(e,t,r){if(e.removeEventListener)e.removeEventListener(t,r,!1);else if(e.detachEvent)e.detachEvent("on"+t,r);else{var i=e._handlers,n=i&&i[t];if(n){var o=N(n,r);o>-1&&(i[t]=n.slice(0,o).concat(n.slice(o+1)))}}}function me(e,t){var r=de(e,t);if(r.length)for(var i=Array.prototype.slice.call(arguments,2),n=0;n<r.length;++n)r[n].apply(null,i)}function ge(e,t,r){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),me(e,r||t.type,e,t),we(t)||t.codemirrorIgnore}function _e(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var r=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),i=0;i<t.length;++i)-1==N(r,t[i])&&r.push(t[i])}function ve(e,t){return de(e,t).length>0}function ye(e){e.prototype.on=function(e,t){fe(this,e,t)},e.prototype.off=function(e,t){pe(this,e,t)}}function Ce(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function be(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function we(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function xe(e){Ce(e),be(e)}function Se(e){return e.target||e.srcElement}function Le(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),v&&e.ctrlKey&&1==t&&(t=3),t}var ke,Te,Ae=function(){if(s&&a<9)return!1;var e=E("div");return"draggable"in e||"dragDrop"in e}();function Ee(e){if(null==ke){var t=E("span","​");A(e,E("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(ke=t.offsetWidth<=1&&t.offsetHeight>2&&!(s&&a<8))}var r=ke?E("span","​"):E("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return r.setAttribute("cm-text",""),r}function Me(e){if(null!=Te)return Te;var t=A(e,document.createTextNode("AخA")),r=L(t,0,1).getBoundingClientRect(),i=L(t,1,2).getBoundingClientRect();return T(e),!(!r||r.left==r.right)&&(Te=i.right-r.right<3)}var De,Re=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,r=[],i=e.length;t<=i;){var n=e.indexOf("\n",t);-1==n&&(n=e.length);var o=e.slice(t,"\r"==e.charAt(n-1)?n-1:n),s=o.indexOf("\r");-1!=s?(r.push(o.slice(0,s)),t+=s+1):(r.push(o),t=n+1)}return r}:function(e){return e.split(/\r\n?|\n/)},Oe=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(e){return!1}}:function(e){var t;try{t=e.ownerDocument.selection.createRange()}catch(e){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)},He="oncopy"in(De=E("div"))||(De.setAttribute("oncopy","return;"),"function"==typeof De.oncopy),Pe=null,Be={},Fe={};function Ie(e,t){arguments.length>2&&(t.dependencies=Array.prototype.slice.call(arguments,2)),Be[e]=t}function We(e){if("string"==typeof e&&Fe.hasOwnProperty(e))e=Fe[e];else if(e&&"string"==typeof e.name&&Fe.hasOwnProperty(e.name)){var t=Fe[e.name];"string"==typeof t&&(t={name:t}),(e=$(t,e)).name=t.name}else{if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return We("application/xml");if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return We("application/json")}return"string"==typeof e?{name:e}:e||{name:"null"}}function Ne(e,t){t=We(t);var r=Be[t.name];if(!r)return Ne(e,"text/plain");var i=r(e,t);if(Ue.hasOwnProperty(t.name)){var n=Ue[t.name];for(var o in n)n.hasOwnProperty(o)&&(i.hasOwnProperty(o)&&(i["_"+o]=i[o]),i[o]=n[o])}if(i.name=t.name,t.helperType&&(i.helperType=t.helperType),t.modeProps)for(var s in t.modeProps)i[s]=t.modeProps[s];return i}var Ue={};function ze(e,t){var r=Ue.hasOwnProperty(e)?Ue[e]:Ue[e]={};F(t,r)}function je(e,t){if(!0===t)return t;if(e.copyState)return e.copyState(t);var r={};for(var i in t){var n=t[i];n instanceof Array&&(n=n.concat([])),r[i]=n}return r}function Ke(e,t){for(var r;e.innerMode&&(r=e.innerMode(t))&&r.mode!=e;)t=r.state,e=r.mode;return r||{mode:e,state:t}}function Ge(e,t,r){return!e.startState||e.startState(t,r)}var Ve=function(e,t,r){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=r};function Xe(e,t){if((t-=e.first)<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var r=e;!r.lines;)for(var i=0;;++i){var n=r.children[i],o=n.chunkSize();if(t<o){r=n;break}t-=o}return r.lines[t]}function Ye(e,t,r){var i=[],n=t.line;return e.iter(t.line,r.line+1,function(e){var o=e.text;n==r.line&&(o=o.slice(0,r.ch)),n==t.line&&(o=o.slice(t.ch)),i.push(o),++n}),i}function qe(e,t,r){var i=[];return e.iter(t,r,function(e){i.push(e.text)}),i}function Ze(e,t){var r=t-e.height;if(r)for(var i=e;i;i=i.parent)i.height+=r}function Je(e){if(null==e.parent)return null;for(var t=e.parent,r=N(t.lines,e),i=t.parent;i;t=i,i=i.parent)for(var n=0;i.children[n]!=t;++n)r+=i.children[n].chunkSize();return r+t.first}function $e(e,t){var r=e.first;e:do{for(var i=0;i<e.children.length;++i){var n=e.children[i],o=n.height;if(t<o){e=n;continue e}t-=o,r+=n.chunkSize()}return r}while(!e.lines);for(var s=0;s<e.lines.length;++s){var a=e.lines[s],l=a.height;if(t<l)break;t-=l}return r+s}function Qe(e,t){return t>=e.first&&t<e.first+e.size}function et(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function tt(e,t,r){if(void 0===r&&(r=null),!(this instanceof tt))return new tt(e,t,r);this.line=e,this.ch=t,this.sticky=r}function rt(e,t){return e.line-t.line||e.ch-t.ch}function it(e,t){return e.sticky==t.sticky&&0==rt(e,t)}function nt(e){return tt(e.line,e.ch)}function ot(e,t){return rt(e,t)<0?t:e}function st(e,t){return rt(e,t)<0?e:t}function at(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function lt(e,t){if(t.line<e.first)return tt(e.first,0);var r=e.first+e.size-1;return t.line>r?tt(r,Xe(e,r).text.length):function(e,t){var r=e.ch;return null==r||r>t?tt(e.line,t):r<0?tt(e.line,0):e}(t,Xe(e,t.line).text.length)}function ct(e,t){for(var r=[],i=0;i<t.length;i++)r[i]=lt(e,t[i]);return r}Ve.prototype.eol=function(){return this.pos>=this.string.length},Ve.prototype.sol=function(){return this.pos==this.lineStart},Ve.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},Ve.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},Ve.prototype.eat=function(e){var t=this.string.charAt(this.pos);if("string"==typeof e?t==e:t&&(e.test?e.test(t):e(t)))return++this.pos,t},Ve.prototype.eatWhile=function(e){for(var t=this.pos;this.eat(e););return this.pos>t},Ve.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},Ve.prototype.skipToEnd=function(){this.pos=this.string.length},Ve.prototype.skipTo=function(e){var t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0},Ve.prototype.backUp=function(e){this.pos-=e},Ve.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=I(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?I(this.string,this.lineStart,this.tabSize):0)},Ve.prototype.indentation=function(){return I(this.string,null,this.tabSize)-(this.lineStart?I(this.string,this.lineStart,this.tabSize):0)},Ve.prototype.match=function(e,t,r){if("string"!=typeof e){var i=this.string.slice(this.pos).match(e);return i&&i.index>0?null:(i&&!1!==t&&(this.pos+=i[0].length),i)}var n=function(e){return r?e.toLowerCase():e},o=this.string.substr(this.pos,e.length);if(n(o)==n(e))return!1!==t&&(this.pos+=e.length),!0},Ve.prototype.current=function(){return this.string.slice(this.start,this.pos)},Ve.prototype.hideFirstChars=function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}},Ve.prototype.lookAhead=function(e){var t=this.lineOracle;return t&&t.lookAhead(e)},Ve.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)};var ht=function(e,t){this.state=e,this.lookAhead=t},ut=function(e,t,r,i){this.state=t,this.doc=e,this.line=r,this.maxLookAhead=i||0,this.baseTokens=null,this.baseTokenPos=1};function ft(e,t,r,i){var n=[e.state.modeGen],o={};bt(e,t.text,e.doc.mode,r,function(e,t){return n.push(e,t)},o,i);for(var s=r.state,a=function(i){r.baseTokens=n;var a=e.state.overlays[i],l=1,c=0;r.state=!0,bt(e,t.text,a.mode,r,function(e,t){for(var r=l;c<e;){var i=n[l];i>e&&n.splice(l,1,e,n[l+1],i),l+=2,c=Math.min(e,i)}if(t)if(a.opaque)n.splice(r,l-r,e,"overlay "+t),l=r+2;else for(;r<l;r+=2){var o=n[r+1];n[r+1]=(o?o+" ":"")+"overlay "+t}},o),r.state=s,r.baseTokens=null,r.baseTokenPos=1},l=0;l<e.state.overlays.length;++l)a(l);return{styles:n,classes:o.bgClass||o.textClass?o:null}}function dt(e,t,r){if(!t.styles||t.styles[0]!=e.state.modeGen){var i=pt(e,Je(t)),n=t.text.length>e.options.maxHighlightLength&&je(e.doc.mode,i.state),o=ft(e,t,i);n&&(i.state=n),t.stateAfter=i.save(!n),t.styles=o.styles,o.classes?t.styleClasses=o.classes:t.styleClasses&&(t.styleClasses=null),r===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))}return t.styles}function pt(e,t,r){var i=e.doc,n=e.display;if(!i.mode.startState)return new ut(i,!0,t);var o=function(e,t,r){for(var i,n,o=e.doc,s=r?-1:t-(e.doc.mode.innerMode?1e3:100),a=t;a>s;--a){if(a<=o.first)return o.first;var l=Xe(o,a-1),c=l.stateAfter;if(c&&(!r||a+(c instanceof ht?c.lookAhead:0)<=o.modeFrontier))return a;var h=I(l.text,null,e.options.tabSize);(null==n||i>h)&&(n=a-1,i=h)}return n}(e,t,r),s=o>i.first&&Xe(i,o-1).stateAfter,a=s?ut.fromSaved(i,s,o):new ut(i,Ge(i.mode),o);return i.iter(o,t,function(r){mt(e,r.text,a);var i=a.line;r.stateAfter=i==t-1||i%5==0||i>=n.viewFrom&&i<n.viewTo?a.save():null,a.nextLine()}),r&&(i.modeFrontier=a.line),a}function mt(e,t,r,i){var n=e.doc.mode,o=new Ve(t,e.options.tabSize,r);for(o.start=o.pos=i||0,""==t&&gt(n,r.state);!o.eol();)_t(n,o,r.state),o.start=o.pos}function gt(e,t){if(e.blankLine)return e.blankLine(t);if(e.innerMode){var r=Ke(e,t);return r.mode.blankLine?r.mode.blankLine(r.state):void 0}}function _t(e,t,r,i){for(var n=0;n<10;n++){i&&(i[0]=Ke(e,r).mode);var o=e.token(t,r);if(t.pos>t.start)return o}throw new Error("Mode "+e.name+" failed to advance stream.")}ut.prototype.lookAhead=function(e){var t=this.doc.getLine(this.line+e);return null!=t&&e>this.maxLookAhead&&(this.maxLookAhead=e),t},ut.prototype.baseToken=function(e){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=e;)this.baseTokenPos+=2;var t=this.baseTokens[this.baseTokenPos+1];return{type:t&&t.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}},ut.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},ut.fromSaved=function(e,t,r){return t instanceof ht?new ut(e,je(e.mode,t.state),r,t.lookAhead):new ut(e,je(e.mode,t),r)},ut.prototype.save=function(e){var t=!1!==e?je(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new ht(t,this.maxLookAhead):t};var vt=function(e,t,r){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=t||null,this.state=r};function yt(e,t,r,i){var n,o=e.doc,s=o.mode;t=lt(o,t);var a,l=Xe(o,t.line),c=pt(e,t.line,r),h=new Ve(l.text,e.options.tabSize,c);for(i&&(a=[]);(i||h.pos<t.ch)&&!h.eol();)h.start=h.pos,n=_t(s,h,c.state),i&&a.push(new vt(h,n,je(o.mode,c.state)));return i?a:new vt(h,n,c.state)}function Ct(e,t){if(e)for(;;){var r=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!r)break;e=e.slice(0,r.index)+e.slice(r.index+r[0].length);var i=r[1]?"bgClass":"textClass";null==t[i]?t[i]=r[2]:new RegExp("(?:^|s)"+r[2]+"(?:$|s)").test(t[i])||(t[i]+=" "+r[2])}return e}function bt(e,t,r,i,n,o,s){var a=r.flattenSpans;null==a&&(a=e.options.flattenSpans);var l,c=0,h=null,u=new Ve(t,e.options.tabSize,i),f=e.options.addModeClass&&[null];for(""==t&&Ct(gt(r,i.state),o);!u.eol();){if(u.pos>e.options.maxHighlightLength?(a=!1,s&&mt(e,t,i,u.pos),u.pos=t.length,l=null):l=Ct(_t(r,u,i.state,f),o),f){var d=f[0].name;d&&(l="m-"+(l?d+" "+l:d))}if(!a||h!=l){for(;c<u.start;)c=Math.min(u.start,c+5e3),n(c,h);h=l}u.start=u.pos}for(;c<u.pos;){var p=Math.min(u.pos,c+5e3);n(p,h),c=p}}var wt=!1,xt=!1;function St(e,t,r){this.marker=e,this.from=t,this.to=r}function Lt(e,t){if(e)for(var r=0;r<e.length;++r){var i=e[r];if(i.marker==t)return i}}function kt(e,t){for(var r,i=0;i<e.length;++i)e[i]!=t&&(r||(r=[])).push(e[i]);return r}function Tt(e,t){if(t.full)return null;var r=Qe(e,t.from.line)&&Xe(e,t.from.line).markedSpans,i=Qe(e,t.to.line)&&Xe(e,t.to.line).markedSpans;if(!r&&!i)return null;var n=t.from.ch,o=t.to.ch,s=0==rt(t.from,t.to),a=function(e,t,r){var i;if(e)for(var n=0;n<e.length;++n){var o=e[n],s=o.marker,a=null==o.from||(s.inclusiveLeft?o.from<=t:o.from<t);if(a||o.from==t&&"bookmark"==s.type&&(!r||!o.marker.insertLeft)){var l=null==o.to||(s.inclusiveRight?o.to>=t:o.to>t);(i||(i=[])).push(new St(s,o.from,l?null:o.to))}}return i}(r,n,s),l=function(e,t,r){var i;if(e)for(var n=0;n<e.length;++n){var o=e[n],s=o.marker,a=null==o.to||(s.inclusiveRight?o.to>=t:o.to>t);if(a||o.from==t&&"bookmark"==s.type&&(!r||o.marker.insertLeft)){var l=null==o.from||(s.inclusiveLeft?o.from<=t:o.from<t);(i||(i=[])).push(new St(s,l?null:o.from-t,null==o.to?null:o.to-t))}}return i}(i,o,s),c=1==t.text.length,h=q(t.text).length+(c?n:0);if(a)for(var u=0;u<a.length;++u){var f=a[u];if(null==f.to){var d=Lt(l,f.marker);d?c&&(f.to=null==d.to?null:d.to+h):f.to=n}}if(l)for(var p=0;p<l.length;++p){var m=l[p];if(null!=m.to&&(m.to+=h),null==m.from){var g=Lt(a,m.marker);g||(m.from=h,c&&(a||(a=[])).push(m))}else m.from+=h,c&&(a||(a=[])).push(m)}a&&(a=At(a)),l&&l!=a&&(l=At(l));var _=[a];if(!c){var v,y=t.text.length-2;if(y>0&&a)for(var C=0;C<a.length;++C)null==a[C].to&&(v||(v=[])).push(new St(a[C].marker,null,null));for(var b=0;b<y;++b)_.push(v);_.push(l)}return _}function At(e){for(var t=0;t<e.length;++t){var r=e[t];null!=r.from&&r.from==r.to&&!1!==r.marker.clearWhenEmpty&&e.splice(t--,1)}return e.length?e:null}function Et(e){var t=e.markedSpans;if(t){for(var r=0;r<t.length;++r)t[r].marker.detachLine(e);e.markedSpans=null}}function Mt(e,t){if(t){for(var r=0;r<t.length;++r)t[r].marker.attachLine(e);e.markedSpans=t}}function Dt(e){return e.inclusiveLeft?-1:0}function Rt(e){return e.inclusiveRight?1:0}function Ot(e,t){var r=e.lines.length-t.lines.length;if(0!=r)return r;var i=e.find(),n=t.find(),o=rt(i.from,n.from)||Dt(e)-Dt(t);if(o)return-o;var s=rt(i.to,n.to)||Rt(e)-Rt(t);return s||t.id-e.id}function Ht(e,t){var r,i=xt&&e.markedSpans;if(i)for(var n=void 0,o=0;o<i.length;++o)(n=i[o]).marker.collapsed&&null==(t?n.from:n.to)&&(!r||Ot(r,n.marker)<0)&&(r=n.marker);return r}function Pt(e){return Ht(e,!0)}function Bt(e){return Ht(e,!1)}function Ft(e,t){var r,i=xt&&e.markedSpans;if(i)for(var n=0;n<i.length;++n){var o=i[n];o.marker.collapsed&&(null==o.from||o.from<t)&&(null==o.to||o.to>t)&&(!r||Ot(r,o.marker)<0)&&(r=o.marker)}return r}function It(e,t,r,i,n){var o=Xe(e,t),s=xt&&o.markedSpans;if(s)for(var a=0;a<s.length;++a){var l=s[a];if(l.marker.collapsed){var c=l.marker.find(0),h=rt(c.from,r)||Dt(l.marker)-Dt(n),u=rt(c.to,i)||Rt(l.marker)-Rt(n);if(!(h>=0&&u<=0||h<=0&&u>=0)&&(h<=0&&(l.marker.inclusiveRight&&n.inclusiveLeft?rt(c.to,r)>=0:rt(c.to,r)>0)||h>=0&&(l.marker.inclusiveRight&&n.inclusiveLeft?rt(c.from,i)<=0:rt(c.from,i)<0)))return!0}}}function Wt(e){for(var t;t=Pt(e);)e=t.find(-1,!0).line;return e}function Nt(e,t){var r=Xe(e,t),i=Wt(r);return r==i?t:Je(i)}function Ut(e,t){if(t>e.lastLine())return t;var r,i=Xe(e,t);if(!zt(e,i))return t;for(;r=Bt(i);)i=r.find(1,!0).line;return Je(i)+1}function zt(e,t){var r=xt&&t.markedSpans;if(r)for(var i=void 0,n=0;n<r.length;++n)if((i=r[n]).marker.collapsed){if(null==i.from)return!0;if(!i.marker.widgetNode&&0==i.from&&i.marker.inclusiveLeft&&jt(e,t,i))return!0}}function jt(e,t,r){if(null==r.to){var i=r.marker.find(1,!0);return jt(e,i.line,Lt(i.line.markedSpans,r.marker))}if(r.marker.inclusiveRight&&r.to==t.text.length)return!0;for(var n=void 0,o=0;o<t.markedSpans.length;++o)if((n=t.markedSpans[o]).marker.collapsed&&!n.marker.widgetNode&&n.from==r.to&&(null==n.to||n.to!=r.from)&&(n.marker.inclusiveLeft||r.marker.inclusiveRight)&&jt(e,t,n))return!0}function Kt(e){e=Wt(e);for(var t=0,r=e.parent,i=0;i<r.lines.length;++i){var n=r.lines[i];if(n==e)break;t+=n.height}for(var o=r.parent;o;o=(r=o).parent)for(var s=0;s<o.children.length;++s){var a=o.children[s];if(a==r)break;t+=a.height}return t}function Gt(e){if(0==e.height)return 0;for(var t,r=e.text.length,i=e;t=Pt(i);){var n=t.find(0,!0);i=n.from.line,r+=n.from.ch-n.to.ch}for(i=e;t=Bt(i);){var o=t.find(0,!0);r-=i.text.length-o.from.ch,i=o.to.line,r+=i.text.length-o.to.ch}return r}function Vt(e){var t=e.display,r=e.doc;t.maxLine=Xe(r,r.first),t.maxLineLength=Gt(t.maxLine),t.maxLineChanged=!0,r.iter(function(e){var r=Gt(e);r>t.maxLineLength&&(t.maxLineLength=r,t.maxLine=e)})}var Xt=function(e,t,r){this.text=e,Mt(this,t),this.height=r?r(this):1};function Yt(e){e.parent=null,Et(e)}Xt.prototype.lineNo=function(){return Je(this)},ye(Xt);var qt={},Zt={};function Jt(e,t){if(!e||/^\s*$/.test(e))return null;var r=t.addModeClass?Zt:qt;return r[e]||(r[e]=e.replace(/\S+/g,"cm-$&"))}function $t(e,t){var r=M("span",null,null,l?"padding-right: .1px":null),i={pre:M("pre",[r],"CodeMirror-line"),content:r,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:e.getOption("lineWrapping")};t.measure={};for(var n=0;n<=(t.rest?t.rest.length:0);n++){var o=n?t.rest[n-1]:t.line,s=void 0;i.pos=0,i.addToken=er,Me(e.display.measure)&&(s=he(o,e.doc.direction))&&(i.addToken=tr(i.addToken,s)),i.map=[];var a=t!=e.display.externalMeasured&&Je(o);ir(o,i,dt(e,o,a)),o.styleClasses&&(o.styleClasses.bgClass&&(i.bgClass=H(o.styleClasses.bgClass,i.bgClass||"")),o.styleClasses.textClass&&(i.textClass=H(o.styleClasses.textClass,i.textClass||""))),0==i.map.length&&i.map.push(0,0,i.content.appendChild(Ee(e.display.measure))),0==n?(t.measure.map=i.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(i.map),(t.measure.caches||(t.measure.caches=[])).push({}))}if(l){var c=i.content.lastChild;(/\bcm-tab\b/.test(c.className)||c.querySelector&&c.querySelector(".cm-tab"))&&(i.content.className="cm-tab-wrap-hack")}return me(e,"renderLine",e,t.line,i.pre),i.pre.className&&(i.textClass=H(i.pre.className,i.textClass||"")),i}function Qt(e){var t=E("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function er(e,t,r,i,n,o,l){if(t){var c,h=e.splitSpaces?function(e,t){if(e.length>1&&!/  /.test(e))return e;for(var r=t,i="",n=0;n<e.length;n++){var o=e.charAt(n);" "!=o||!r||n!=e.length-1&&32!=e.charCodeAt(n+1)||(o=" "),i+=o,r=" "==o}return i}(t,e.trailingSpace):t,u=e.cm.state.specialChars,f=!1;if(u.test(t)){c=document.createDocumentFragment();for(var d=0;;){u.lastIndex=d;var p=u.exec(t),m=p?p.index-d:t.length-d;if(m){var g=document.createTextNode(h.slice(d,d+m));s&&a<9?c.appendChild(E("span",[g])):c.appendChild(g),e.map.push(e.pos,e.pos+m,g),e.col+=m,e.pos+=m}if(!p)break;d+=m+1;var _=void 0;if("\t"==p[0]){var v=e.cm.options.tabSize,y=v-e.col%v;(_=c.appendChild(E("span",Y(y),"cm-tab"))).setAttribute("role","presentation"),_.setAttribute("cm-text","\t"),e.col+=y}else"\r"==p[0]||"\n"==p[0]?((_=c.appendChild(E("span","\r"==p[0]?"␍":"␤","cm-invalidchar"))).setAttribute("cm-text",p[0]),e.col+=1):((_=e.cm.options.specialCharPlaceholder(p[0])).setAttribute("cm-text",p[0]),s&&a<9?c.appendChild(E("span",[_])):c.appendChild(_),e.col+=1);e.map.push(e.pos,e.pos+1,_),e.pos++}}else e.col+=t.length,c=document.createTextNode(h),e.map.push(e.pos,e.pos+t.length,c),s&&a<9&&(f=!0),e.pos+=t.length;if(e.trailingSpace=32==h.charCodeAt(t.length-1),r||i||n||f||o){var C=r||"";i&&(C+=i),n&&(C+=n);var b=E("span",[c],C,o);if(l)for(var w in l)l.hasOwnProperty(w)&&"style"!=w&&"class"!=w&&b.setAttribute(w,l[w]);return e.content.appendChild(b)}e.content.appendChild(c)}}function tr(e,t){return function(r,i,n,o,s,a,l){n=n?n+" cm-force-border":"cm-force-border";for(var c=r.pos,h=c+i.length;;){for(var u=void 0,f=0;f<t.length&&!((u=t[f]).to>c&&u.from<=c);f++);if(u.to>=h)return e(r,i,n,o,s,a,l);e(r,i.slice(0,u.to-c),n,o,null,a,l),o=null,i=i.slice(u.to-c),c=u.to}}}function rr(e,t,r,i){var n=!i&&r.widgetNode;n&&e.map.push(e.pos,e.pos+t,n),!i&&e.cm.display.input.needsContentAttribute&&(n||(n=e.content.appendChild(document.createElement("span"))),n.setAttribute("cm-marker",r.id)),n&&(e.cm.display.input.setUneditable(n),e.content.appendChild(n)),e.pos+=t,e.trailingSpace=!1}function ir(e,t,r){var i=e.markedSpans,n=e.text,o=0;if(i)for(var s,a,l,c,h,u,f,d=n.length,p=0,m=1,g="",_=0;;){if(_==p){l=c=h=a="",f=null,u=null,_=1/0;for(var v=[],y=void 0,C=0;C<i.length;++C){var b=i[C],w=b.marker;if("bookmark"==w.type&&b.from==p&&w.widgetNode)v.push(w);else if(b.from<=p&&(null==b.to||b.to>p||w.collapsed&&b.to==p&&b.from==p)){if(null!=b.to&&b.to!=p&&_>b.to&&(_=b.to,c=""),w.className&&(l+=" "+w.className),w.css&&(a=(a?a+";":"")+w.css),w.startStyle&&b.from==p&&(h+=" "+w.startStyle),w.endStyle&&b.to==_&&(y||(y=[])).push(w.endStyle,b.to),w.title&&((f||(f={})).title=w.title),w.attributes)for(var x in w.attributes)(f||(f={}))[x]=w.attributes[x];w.collapsed&&(!u||Ot(u.marker,w)<0)&&(u=b)}else b.from>p&&_>b.from&&(_=b.from)}if(y)for(var S=0;S<y.length;S+=2)y[S+1]==_&&(c+=" "+y[S]);if(!u||u.from==p)for(var L=0;L<v.length;++L)rr(t,0,v[L]);if(u&&(u.from||0)==p){if(rr(t,(null==u.to?d+1:u.to)-p,u.marker,null==u.from),null==u.to)return;u.to==p&&(u=!1)}}if(p>=d)break;for(var k=Math.min(d,_);;){if(g){var T=p+g.length;if(!u){var A=T>k?g.slice(0,k-p):g;t.addToken(t,A,s?s+l:l,h,p+A.length==_?c:"",a,f)}if(T>=k){g=g.slice(k-p),p=k;break}p=T,h=""}g=n.slice(o,o=r[m++]),s=Jt(r[m++],t.cm.options)}}else for(var E=1;E<r.length;E+=2)t.addToken(t,n.slice(o,o=r[E]),Jt(r[E+1],t.cm.options))}function nr(e,t,r){this.line=t,this.rest=function(e){for(var t,r;t=Bt(e);)e=t.find(1,!0).line,(r||(r=[])).push(e);return r}(t),this.size=this.rest?Je(q(this.rest))-r+1:1,this.node=this.text=null,this.hidden=zt(e,t)}function or(e,t,r){for(var i,n=[],o=t;o<r;o=i){var s=new nr(e.doc,Xe(e.doc,o),o);i=o+s.size,n.push(s)}return n}var sr=null,ar=null;function lr(e,t){var r=de(e,t);if(r.length){var i,n=Array.prototype.slice.call(arguments,2);sr?i=sr.delayedCallbacks:ar?i=ar:(i=ar=[],setTimeout(cr,0));for(var o=function(e){i.push(function(){return r[e].apply(null,n)})},s=0;s<r.length;++s)o(s)}}function cr(){var e=ar;ar=null;for(var t=0;t<e.length;++t)e[t]()}function hr(e,t,r,i){for(var n=0;n<t.changes.length;n++){var o=t.changes[n];"text"==o?dr(e,t):"gutter"==o?mr(e,t,r,i):"class"==o?pr(e,t):"widget"==o&&gr(e,t,i)}t.changes=null}function ur(e){return e.node==e.text&&(e.node=E("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),s&&a<8&&(e.node.style.zIndex=2)),e.node}function fr(e,t){var r=e.display.externalMeasured;return r&&r.line==t.line?(e.display.externalMeasured=null,t.measure=r.measure,r.built):$t(e,t)}function dr(e,t){var r=t.text.className,i=fr(e,t);t.text==t.node&&(t.node=i.pre),t.text.parentNode.replaceChild(i.pre,t.text),t.text=i.pre,i.bgClass!=t.bgClass||i.textClass!=t.textClass?(t.bgClass=i.bgClass,t.textClass=i.textClass,pr(e,t)):r&&(t.text.className=r)}function pr(e,t){!function(e,t){var r=t.bgClass?t.bgClass+" "+(t.line.bgClass||""):t.line.bgClass;if(r&&(r+=" CodeMirror-linebackground"),t.background)r?t.background.className=r:(t.background.parentNode.removeChild(t.background),t.background=null);else if(r){var i=ur(t);t.background=i.insertBefore(E("div",null,r),i.firstChild),e.display.input.setUneditable(t.background)}}(e,t),t.line.wrapClass?ur(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var r=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=r||""}function mr(e,t,r,i){if(t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass){var n=ur(t);t.gutterBackground=E("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px; width: "+i.gutterTotalWidth+"px"),e.display.input.setUneditable(t.gutterBackground),n.insertBefore(t.gutterBackground,t.text)}var o=t.line.gutterMarkers;if(e.options.lineNumbers||o){var s=ur(t),a=t.gutter=E("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px");if(e.display.input.setUneditable(a),s.insertBefore(a,t.text),t.line.gutterClass&&(a.className+=" "+t.line.gutterClass),!e.options.lineNumbers||o&&o["CodeMirror-linenumbers"]||(t.lineNumber=a.appendChild(E("div",et(e.options,r),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+i.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),o)for(var l=0;l<e.display.gutterSpecs.length;++l){var c=e.display.gutterSpecs[l].className,h=o.hasOwnProperty(c)&&o[c];h&&a.appendChild(E("div",[h],"CodeMirror-gutter-elt","left: "+i.gutterLeft[c]+"px; width: "+i.gutterWidth[c]+"px"))}}}function gr(e,t,r){t.alignable&&(t.alignable=null);for(var i=t.node.firstChild,n=void 0;i;i=n)n=i.nextSibling,"CodeMirror-linewidget"==i.className&&t.node.removeChild(i);vr(e,t,r)}function _r(e,t,r,i){var n=fr(e,t);return t.text=t.node=n.pre,n.bgClass&&(t.bgClass=n.bgClass),n.textClass&&(t.textClass=n.textClass),pr(e,t),mr(e,t,r,i),vr(e,t,i),t.node}function vr(e,t,r){if(yr(e,t.line,t,r,!0),t.rest)for(var i=0;i<t.rest.length;i++)yr(e,t.rest[i],t,r,!1)}function yr(e,t,r,i,n){if(t.widgets)for(var o=ur(r),s=0,a=t.widgets;s<a.length;++s){var l=a[s],c=E("div",[l.node],"CodeMirror-linewidget");l.handleMouseEvents||c.setAttribute("cm-ignore-events","true"),Cr(l,c,r,i),e.display.input.setUneditable(c),n&&l.above?o.insertBefore(c,r.gutter||r.text):o.appendChild(c),lr(l,"redraw")}}function Cr(e,t,r,i){if(e.noHScroll){(r.alignable||(r.alignable=[])).push(t);var n=i.wrapperWidth;t.style.left=i.fixedPos+"px",e.coverGutter||(n-=i.gutterTotalWidth,t.style.paddingLeft=i.gutterTotalWidth+"px"),t.style.width=n+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-i.gutterTotalWidth+"px"))}function br(e){if(null!=e.height)return e.height;var t=e.doc.cm;if(!t)return 0;if(!D(document.body,e.node)){var r="position: relative;";e.coverGutter&&(r+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(r+="width: "+t.display.wrapper.clientWidth+"px;"),A(t.display.measure,E("div",[e.node],null,r))}return e.height=e.node.parentNode.offsetHeight}function wr(e,t){for(var r=Se(t);r!=e.wrapper;r=r.parentNode)if(!r||1==r.nodeType&&"true"==r.getAttribute("cm-ignore-events")||r.parentNode==e.sizer&&r!=e.mover)return!0}function xr(e){return e.lineSpace.offsetTop}function Sr(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Lr(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=A(e.measure,E("pre","x")),r=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,i={left:parseInt(r.paddingLeft),right:parseInt(r.paddingRight)};return isNaN(i.left)||isNaN(i.right)||(e.cachedPaddingH=i),i}function kr(e){return U-e.display.nativeBarWidth}function Tr(e){return e.display.scroller.clientWidth-kr(e)-e.display.barWidth}function Ar(e){return e.display.scroller.clientHeight-kr(e)-e.display.barHeight}function Er(e,t,r){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var i=0;i<e.rest.length;i++)if(e.rest[i]==t)return{map:e.measure.maps[i],cache:e.measure.caches[i]};for(var n=0;n<e.rest.length;n++)if(Je(e.rest[n])>r)return{map:e.measure.maps[n],cache:e.measure.caches[n],before:!0}}function Mr(e,t,r,i){return Or(e,Rr(e,t),r,i)}function Dr(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[li(e,t)];var r=e.display.externalMeasured;return r&&t>=r.lineN&&t<r.lineN+r.size?r:void 0}function Rr(e,t){var r=Je(t),i=Dr(e,r);i&&!i.text?i=null:i&&i.changes&&(hr(e,i,r,ii(e)),e.curOp.forceUpdate=!0),i||(i=function(e,t){var r=Je(t=Wt(t)),i=e.display.externalMeasured=new nr(e.doc,t,r);i.lineN=r;var n=i.built=$t(e,i);return i.text=n.pre,A(e.display.lineMeasure,n.pre),i}(e,t));var n=Er(i,t,r);return{line:t,view:i,rect:null,map:n.map,cache:n.cache,before:n.before,hasHeights:!1}}function Or(e,t,r,i,n){t.before&&(r=-1);var o,l=r+(i||"");return t.cache.hasOwnProperty(l)?o=t.cache[l]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(function(e,t,r){var i=e.options.lineWrapping,n=i&&Tr(e);if(!t.measure.heights||i&&t.measure.width!=n){var o=t.measure.heights=[];if(i){t.measure.width=n;for(var s=t.text.firstChild.getClientRects(),a=0;a<s.length-1;a++){var l=s[a],c=s[a+1];Math.abs(l.bottom-c.bottom)>2&&o.push((l.bottom+c.top)/2-r.top)}}o.push(r.bottom-r.top)}}(e,t.view,t.rect),t.hasHeights=!0),(o=function(e,t,r,i){var n,o=Br(t.map,r,i),l=o.node,c=o.start,h=o.end,u=o.collapse;if(3==l.nodeType){for(var f=0;f<4;f++){for(;c&&ne(t.line.text.charAt(o.coverStart+c));)--c;for(;o.coverStart+h<o.coverEnd&&ne(t.line.text.charAt(o.coverStart+h));)++h;if((n=s&&a<9&&0==c&&h==o.coverEnd-o.coverStart?l.parentNode.getBoundingClientRect():Fr(L(l,c,h).getClientRects(),i)).left||n.right||0==c)break;h=c,c-=1,u="right"}s&&a<11&&(n=function(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!function(e){if(null!=Pe)return Pe;var t=A(e,E("span","x")),r=t.getBoundingClientRect(),i=L(t,0,1).getBoundingClientRect();return Pe=Math.abs(r.left-i.left)>1}(e))return t;var r=screen.logicalXDPI/screen.deviceXDPI,i=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*r,right:t.right*r,top:t.top*i,bottom:t.bottom*i}}(e.display.measure,n))}else{var d;c>0&&(u=i="right"),n=e.options.lineWrapping&&(d=l.getClientRects()).length>1?d["right"==i?d.length-1:0]:l.getBoundingClientRect()}if(s&&a<9&&!c&&(!n||!n.left&&!n.right)){var p=l.parentNode.getClientRects()[0];n=p?{left:p.left,right:p.left+ri(e.display),top:p.top,bottom:p.bottom}:Pr}for(var m=n.top-t.rect.top,g=n.bottom-t.rect.top,_=(m+g)/2,v=t.view.measure.heights,y=0;y<v.length-1&&!(_<v[y]);y++);var C=y?v[y-1]:0,b=v[y],w={left:("right"==u?n.right:n.left)-t.rect.left,right:("left"==u?n.left:n.right)-t.rect.left,top:C,bottom:b};return n.left||n.right||(w.bogus=!0),e.options.singleCursorHeightPerLine||(w.rtop=m,w.rbottom=g),w}(e,t,r,i)).bogus||(t.cache[l]=o)),{left:o.left,right:o.right,top:n?o.rtop:o.top,bottom:n?o.rbottom:o.bottom}}var Hr,Pr={left:0,right:0,top:0,bottom:0};function Br(e,t,r){for(var i,n,o,s,a,l,c=0;c<e.length;c+=3)if(a=e[c],l=e[c+1],t<a?(n=0,o=1,s="left"):t<l?o=1+(n=t-a):(c==e.length-3||t==l&&e[c+3]>t)&&(n=(o=l-a)-1,t>=l&&(s="right")),null!=n){if(i=e[c+2],a==l&&r==(i.insertLeft?"left":"right")&&(s=r),"left"==r&&0==n)for(;c&&e[c-2]==e[c-3]&&e[c-1].insertLeft;)i=e[2+(c-=3)],s="left";if("right"==r&&n==l-a)for(;c<e.length-3&&e[c+3]==e[c+4]&&!e[c+5].insertLeft;)i=e[(c+=3)+2],s="right";break}return{node:i,start:n,end:o,collapse:s,coverStart:a,coverEnd:l}}function Fr(e,t){var r=Pr;if("left"==t)for(var i=0;i<e.length&&(r=e[i]).left==r.right;i++);else for(var n=e.length-1;n>=0&&(r=e[n]).left==r.right;n--);return r}function Ir(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function Wr(e){e.display.externalMeasure=null,T(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)Ir(e.display.view[t])}function Nr(e){Wr(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function Ur(){return h&&g?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function zr(){return h&&g?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function jr(e){var t=0;if(e.widgets)for(var r=0;r<e.widgets.length;++r)e.widgets[r].above&&(t+=br(e.widgets[r]));return t}function Kr(e,t,r,i,n){if(!n){var o=jr(t);r.top+=o,r.bottom+=o}if("line"==i)return r;i||(i="local");var s=Kt(t);if("local"==i?s+=xr(e.display):s-=e.display.viewOffset,"page"==i||"window"==i){var a=e.display.lineSpace.getBoundingClientRect();s+=a.top+("window"==i?0:zr());var l=a.left+("window"==i?0:Ur());r.left+=l,r.right+=l}return r.top+=s,r.bottom+=s,r}function Gr(e,t,r){if("div"==r)return t;var i=t.left,n=t.top;if("page"==r)i-=Ur(),n-=zr();else if("local"==r||!r){var o=e.display.sizer.getBoundingClientRect();i+=o.left,n+=o.top}var s=e.display.lineSpace.getBoundingClientRect();return{left:i-s.left,top:n-s.top}}function Vr(e,t,r,i,n){return i||(i=Xe(e.doc,t.line)),Kr(e,i,Mr(e,i,t.ch,n),r)}function Xr(e,t,r,i,n,o){function s(t,s){var a=Or(e,n,t,s?"right":"left",o);return s?a.left=a.right:a.right=a.left,Kr(e,i,a,r)}i=i||Xe(e.doc,t.line),n||(n=Rr(e,i));var a=he(i,e.doc.direction),l=t.ch,c=t.sticky;if(l>=i.text.length?(l=i.text.length,c="before"):l<=0&&(l=0,c="after"),!a)return s("before"==c?l-1:l,"before"==c);function h(e,t,r){var i=a[t],n=1==i.level;return s(r?e-1:e,n!=r)}var u=le(a,l,c),f=ae,d=h(l,u,"before"==c);return null!=f&&(d.other=h(l,f,"before"!=c)),d}function Yr(e,t){var r=0;t=lt(e.doc,t),e.options.lineWrapping||(r=ri(e.display)*t.ch);var i=Xe(e.doc,t.line),n=Kt(i)+xr(e.display);return{left:r,right:r,top:n,bottom:n+i.height}}function qr(e,t,r,i,n){var o=tt(e,t,r);return o.xRel=n,i&&(o.outside=!0),o}function Zr(e,t,r){var i=e.doc;if((r+=e.display.viewOffset)<0)return qr(i.first,0,null,!0,-1);var n=$e(i,r),o=i.first+i.size-1;if(n>o)return qr(i.first+i.size-1,Xe(i,o).text.length,null,!0,1);t<0&&(t=0);for(var s=Xe(i,n);;){var a=ei(e,s,n,t,r),l=Ft(s,a.ch+(a.xRel>0?1:0));if(!l)return a;var c=l.find(1);if(c.line==n)return c;s=Xe(i,n=c.line)}}function Jr(e,t,r,i){i-=jr(t);var n=t.text.length,o=se(function(t){return Or(e,r,t-1).bottom<=i},n,0);return n=se(function(t){return Or(e,r,t).top>i},o,n),{begin:o,end:n}}function $r(e,t,r,i){r||(r=Rr(e,t));var n=Kr(e,t,Or(e,r,i),"line").top;return Jr(e,t,r,n)}function Qr(e,t,r,i){return!(e.bottom<=r)&&(e.top>r||(i?e.left:e.right)>t)}function ei(e,t,r,i,n){n-=Kt(t);var o=Rr(e,t),s=jr(t),a=0,l=t.text.length,c=!0,h=he(t,e.doc.direction);if(h){var u=(e.options.lineWrapping?function(e,t,r,i,n,o,s){var a=Jr(e,t,i,s),l=a.begin,c=a.end;/\s/.test(t.text.charAt(c-1))&&c--;for(var h=null,u=null,f=0;f<n.length;f++){var d=n[f];if(!(d.from>=c||d.to<=l)){var p=1!=d.level,m=Or(e,i,p?Math.min(c,d.to)-1:Math.max(l,d.from)).right,g=m<o?o-m+1e9:m-o;(!h||u>g)&&(h=d,u=g)}}return h||(h=n[n.length-1]),h.from<l&&(h={from:l,to:h.to,level:h.level}),h.to>c&&(h={from:h.from,to:c,level:h.level}),h}:function(e,t,r,i,n,o,s){var a=se(function(a){var l=n[a],c=1!=l.level;return Qr(Xr(e,tt(r,c?l.to:l.from,c?"before":"after"),"line",t,i),o,s,!0)},0,n.length-1),l=n[a];if(a>0){var c=1!=l.level,h=Xr(e,tt(r,c?l.from:l.to,c?"after":"before"),"line",t,i);Qr(h,o,s,!0)&&h.top>s&&(l=n[a-1])}return l})(e,t,r,o,h,i,n);c=1!=u.level,a=c?u.from:u.to-1,l=c?u.to:u.from-1}var f,d,p=null,m=null,g=se(function(t){var r=Or(e,o,t);return r.top+=s,r.bottom+=s,!!Qr(r,i,n,!1)&&(r.top<=n&&r.left<=i&&(p=t,m=r),!0)},a,l),_=!1;if(m){var v=i-m.left<m.right-i,y=v==c;g=p+(y?0:1),d=y?"after":"before",f=v?m.left:m.right}else{c||g!=l&&g!=a||g++,d=0==g?"after":g==t.text.length?"before":Or(e,o,g-(c?1:0)).bottom+s<=n==c?"after":"before";var C=Xr(e,tt(r,g,d),"line",t,o);f=C.left,_=n<C.top||n>=C.bottom}return g=oe(t.text,g,1),qr(r,g,d,_,i-f)}function ti(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==Hr){Hr=E("pre");for(var t=0;t<49;++t)Hr.appendChild(document.createTextNode("x")),Hr.appendChild(E("br"));Hr.appendChild(document.createTextNode("x"))}A(e.measure,Hr);var r=Hr.offsetHeight/50;return r>3&&(e.cachedTextHeight=r),T(e.measure),r||1}function ri(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=E("span","xxxxxxxxxx"),r=E("pre",[t]);A(e.measure,r);var i=t.getBoundingClientRect(),n=(i.right-i.left)/10;return n>2&&(e.cachedCharWidth=n),n||10}function ii(e){for(var t=e.display,r={},i={},n=t.gutters.clientLeft,o=t.gutters.firstChild,s=0;o;o=o.nextSibling,++s){var a=e.display.gutterSpecs[s].className;r[a]=o.offsetLeft+o.clientLeft+n,i[a]=o.clientWidth}return{fixedPos:ni(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:r,gutterWidth:i,wrapperWidth:t.wrapper.clientWidth}}function ni(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function oi(e){var t=ti(e.display),r=e.options.lineWrapping,i=r&&Math.max(5,e.display.scroller.clientWidth/ri(e.display)-3);return function(n){if(zt(e.doc,n))return 0;var o=0;if(n.widgets)for(var s=0;s<n.widgets.length;s++)n.widgets[s].height&&(o+=n.widgets[s].height);return r?o+(Math.ceil(n.text.length/i)||1)*t:o+t}}function si(e){var t=e.doc,r=oi(e);t.iter(function(e){var t=r(e);t!=e.height&&Ze(e,t)})}function ai(e,t,r,i){var n=e.display;if(!r&&"true"==Se(t).getAttribute("cm-not-content"))return null;var o,s,a=n.lineSpace.getBoundingClientRect();try{o=t.clientX-a.left,s=t.clientY-a.top}catch(t){return null}var l,c=Zr(e,o,s);if(i&&1==c.xRel&&(l=Xe(e.doc,c.line).text).length==c.ch){var h=I(l,l.length,e.options.tabSize)-l.length;c=tt(c.line,Math.max(0,Math.round((o-Lr(e.display).left)/ri(e.display))-h))}return c}function li(e,t){if(t>=e.display.viewTo)return null;if((t-=e.display.viewFrom)<0)return null;for(var r=e.display.view,i=0;i<r.length;i++)if((t-=r[i].size)<0)return i}function ci(e,t,r,i){null==t&&(t=e.doc.first),null==r&&(r=e.doc.first+e.doc.size),i||(i=0);var n=e.display;if(i&&r<n.viewTo&&(null==n.updateLineNumbers||n.updateLineNumbers>t)&&(n.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=n.viewTo)xt&&Nt(e.doc,t)<n.viewTo&&ui(e);else if(r<=n.viewFrom)xt&&Ut(e.doc,r+i)>n.viewFrom?ui(e):(n.viewFrom+=i,n.viewTo+=i);else if(t<=n.viewFrom&&r>=n.viewTo)ui(e);else if(t<=n.viewFrom){var o=fi(e,r,r+i,1);o?(n.view=n.view.slice(o.index),n.viewFrom=o.lineN,n.viewTo+=i):ui(e)}else if(r>=n.viewTo){var s=fi(e,t,t,-1);s?(n.view=n.view.slice(0,s.index),n.viewTo=s.lineN):ui(e)}else{var a=fi(e,t,t,-1),l=fi(e,r,r+i,1);a&&l?(n.view=n.view.slice(0,a.index).concat(or(e,a.lineN,l.lineN)).concat(n.view.slice(l.index)),n.viewTo+=i):ui(e)}var c=n.externalMeasured;c&&(r<c.lineN?c.lineN+=i:t<c.lineN+c.size&&(n.externalMeasured=null))}function hi(e,t,r){e.curOp.viewChanged=!0;var i=e.display,n=e.display.externalMeasured;if(n&&t>=n.lineN&&t<n.lineN+n.size&&(i.externalMeasured=null),!(t<i.viewFrom||t>=i.viewTo)){var o=i.view[li(e,t)];if(null!=o.node){var s=o.changes||(o.changes=[]);-1==N(s,r)&&s.push(r)}}}function ui(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function fi(e,t,r,i){var n,o=li(e,t),s=e.display.view;if(!xt||r==e.doc.first+e.doc.size)return{index:o,lineN:r};for(var a=e.display.viewFrom,l=0;l<o;l++)a+=s[l].size;if(a!=t){if(i>0){if(o==s.length-1)return null;n=a+s[o].size-t,o++}else n=a-t;t+=n,r+=n}for(;Nt(e.doc,r)!=r;){if(o==(i<0?0:s.length-1))return null;r+=i*s[o-(i<0?1:0)].size,o+=i}return{index:o,lineN:r}}function di(e){for(var t=e.display.view,r=0,i=0;i<t.length;i++){var n=t[i];n.hidden||n.node&&!n.changes||++r}return r}function pi(e){e.display.input.showSelection(e.display.input.prepareSelection())}function mi(e,t){void 0===t&&(t=!0);for(var r=e.doc,i={},n=i.cursors=document.createDocumentFragment(),o=i.selection=document.createDocumentFragment(),s=0;s<r.sel.ranges.length;s++)if(t||s!=r.sel.primIndex){var a=r.sel.ranges[s];if(!(a.from().line>=e.display.viewTo||a.to().line<e.display.viewFrom)){var l=a.empty();(l||e.options.showCursorWhenSelecting)&&gi(e,a.head,n),l||vi(e,a,o)}}return i}function gi(e,t,r){var i=Xr(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),n=r.appendChild(E("div"," ","CodeMirror-cursor"));if(n.style.left=i.left+"px",n.style.top=i.top+"px",n.style.height=Math.max(0,i.bottom-i.top)*e.options.cursorHeight+"px",i.other){var o=r.appendChild(E("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));o.style.display="",o.style.left=i.other.left+"px",o.style.top=i.other.top+"px",o.style.height=.85*(i.other.bottom-i.other.top)+"px"}}function _i(e,t){return e.top-t.top||e.left-t.left}function vi(e,t,r){var i=e.display,n=e.doc,o=document.createDocumentFragment(),s=Lr(e.display),a=s.left,l=Math.max(i.sizerWidth,Tr(e)-i.sizer.offsetLeft)-s.right,c="ltr"==n.direction;function h(e,t,r,i){t<0&&(t=0),t=Math.round(t),i=Math.round(i),o.appendChild(E("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px;\n                             top: "+t+"px; width: "+(null==r?l-e:r)+"px;\n                             height: "+(i-t)+"px"))}function u(t,r,i){var o,s,u=Xe(n,t),f=u.text.length;function d(r,i){return Vr(e,tt(t,r),"div",u,i)}function p(t,r,i){var n=$r(e,u,null,t),o="ltr"==r==("after"==i)?"left":"right",s="after"==i?n.begin:n.end-(/\s/.test(u.text.charAt(n.end-1))?2:1);return d(s,o)[o]}var m=he(u,n.direction);return function(e,t,r,i){if(!e)return i(t,r,"ltr",0);for(var n=!1,o=0;o<e.length;++o){var s=e[o];(s.from<r&&s.to>t||t==r&&s.to==t)&&(i(Math.max(s.from,t),Math.min(s.to,r),1==s.level?"rtl":"ltr",o),n=!0)}n||i(t,r,"ltr")}(m,r||0,null==i?f:i,function(e,t,n,u){var g="ltr"==n,_=d(e,g?"left":"right"),v=d(t-1,g?"right":"left"),y=null==r&&0==e,C=null==i&&t==f,b=0==u,w=!m||u==m.length-1;if(v.top-_.top<=3){var x=(c?y:C)&&b,S=(c?C:y)&&w,L=x?a:(g?_:v).left,k=S?l:(g?v:_).right;h(L,_.top,k-L,_.bottom)}else{var T,A,E,M;g?(T=c&&y&&b?a:_.left,A=c?l:p(e,n,"before"),E=c?a:p(t,n,"after"),M=c&&C&&w?l:v.right):(T=c?p(e,n,"before"):a,A=!c&&y&&b?l:_.right,E=!c&&C&&w?a:v.left,M=c?p(t,n,"after"):l),h(T,_.top,A-T,_.bottom),_.bottom<v.top&&h(a,_.bottom,null,v.top),h(E,v.top,M-E,v.bottom)}(!o||_i(_,o)<0)&&(o=_),_i(v,o)<0&&(o=v),(!s||_i(_,s)<0)&&(s=_),_i(v,s)<0&&(s=v)}),{start:o,end:s}}var f=t.from(),d=t.to();if(f.line==d.line)u(f.line,f.ch,d.ch);else{var p=Xe(n,f.line),m=Xe(n,d.line),g=Wt(p)==Wt(m),_=u(f.line,f.ch,g?p.text.length+1:null).end,v=u(d.line,g?0:null,d.ch).start;g&&(_.top<v.top-2?(h(_.right,_.top,null,_.bottom),h(a,v.top,v.left,v.bottom)):h(_.right,_.top,v.left-_.right,_.bottom)),_.bottom<v.top&&h(a,_.bottom,null,v.top)}r.appendChild(o)}function yi(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var r=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(function(){return t.cursorDiv.style.visibility=(r=!r)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function Ci(e){e.state.focused||(e.display.input.focus(),wi(e))}function bi(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,xi(e))},100)}function wi(e,t){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(me(e,"focus",e,t),e.state.focused=!0,O(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),l&&setTimeout(function(){return e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),yi(e))}function xi(e,t){e.state.delayingBlurEvent||(e.state.focused&&(me(e,"blur",e,t),e.state.focused=!1,k(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function Si(e){for(var t=e.display,r=t.lineDiv.offsetTop,i=0;i<t.view.length;i++){var n=t.view[i],o=e.options.lineWrapping,l=void 0,c=0;if(!n.hidden){if(s&&a<8){var h=n.node.offsetTop+n.node.offsetHeight;l=h-r,r=h}else{var u=n.node.getBoundingClientRect();l=u.bottom-u.top,!o&&n.text.firstChild&&(c=n.text.firstChild.getBoundingClientRect().right-u.left-1)}var f=n.line.height-l;if((f>.005||f<-.005)&&(Ze(n.line,l),Li(n.line),n.rest))for(var d=0;d<n.rest.length;d++)Li(n.rest[d]);if(c>e.display.sizerWidth){var p=Math.ceil(c/ri(e.display));p>e.display.maxLineLength&&(e.display.maxLineLength=p,e.display.maxLine=n.line,e.display.maxLineChanged=!0)}}}}function Li(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t){var r=e.widgets[t],i=r.node.parentNode;i&&(r.height=i.offsetHeight)}}function ki(e,t,r){var i=r&&null!=r.top?Math.max(0,r.top):e.scroller.scrollTop;i=Math.floor(i-xr(e));var n=r&&null!=r.bottom?r.bottom:i+e.wrapper.clientHeight,o=$e(t,i),s=$e(t,n);if(r&&r.ensure){var a=r.ensure.from.line,l=r.ensure.to.line;a<o?(o=a,s=$e(t,Kt(Xe(t,a))+e.wrapper.clientHeight)):Math.min(l,t.lastLine())>=s&&(o=$e(t,Kt(Xe(t,l))-e.wrapper.clientHeight),s=l)}return{from:o,to:Math.max(s,o+1)}}function Ti(e,t){var r=e.display,i=ti(e.display);t.top<0&&(t.top=0);var n=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:r.scroller.scrollTop,o=Ar(e),s={};t.bottom-t.top>o&&(t.bottom=t.top+o);var a=e.doc.height+Sr(r),l=t.top<i,c=t.bottom>a-i;if(t.top<n)s.scrollTop=l?0:t.top;else if(t.bottom>n+o){var h=Math.min(t.top,(c?a:t.bottom)-o);h!=n&&(s.scrollTop=h)}var u=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:r.scroller.scrollLeft,f=Tr(e)-(e.options.fixedGutter?r.gutters.offsetWidth:0),d=t.right-t.left>f;return d&&(t.right=t.left+f),t.left<10?s.scrollLeft=0:t.left<u?s.scrollLeft=Math.max(0,t.left-(d?0:10)):t.right>f+u-3&&(s.scrollLeft=t.right+(d?0:10)-f),s}function Ai(e,t){null!=t&&(Di(e),e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+t)}function Ei(e){Di(e);var t=e.getCursor();e.curOp.scrollToPos={from:t,to:t,margin:e.options.cursorScrollMargin}}function Mi(e,t,r){null==t&&null==r||Di(e),null!=t&&(e.curOp.scrollLeft=t),null!=r&&(e.curOp.scrollTop=r)}function Di(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var r=Yr(e,t.from),i=Yr(e,t.to);Ri(e,r,i,t.margin)}}function Ri(e,t,r,i){var n=Ti(e,{left:Math.min(t.left,r.left),top:Math.min(t.top,r.top)-i,right:Math.max(t.right,r.right),bottom:Math.max(t.bottom,r.bottom)+i});Mi(e,n.scrollLeft,n.scrollTop)}function Oi(e,t){Math.abs(e.doc.scrollTop-t)<2||(r||sn(e,{top:t}),Hi(e,t,!0),r&&sn(e),en(e,100))}function Hi(e,t,r){t=Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,t),(e.display.scroller.scrollTop!=t||r)&&(e.doc.scrollTop=t,e.display.scrollbars.setScrollTop(t),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t))}function Pi(e,t,r,i){t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),(r?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)&&!i||(e.doc.scrollLeft=t,cn(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function Bi(e){var t=e.display,r=t.gutters.offsetWidth,i=Math.round(e.doc.height+Sr(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?r:0,docHeight:i,scrollHeight:i+kr(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:r}}var Fi=function(e,t,r){this.cm=r;var i=this.vert=E("div",[E("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),n=this.horiz=E("div",[E("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");i.tabIndex=n.tabIndex=-1,e(i),e(n),fe(i,"scroll",function(){i.clientHeight&&t(i.scrollTop,"vertical")}),fe(n,"scroll",function(){n.clientWidth&&t(n.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,s&&a<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};Fi.prototype.update=function(e){var t=e.scrollWidth>e.clientWidth+1,r=e.scrollHeight>e.clientHeight+1,i=e.nativeBarWidth;if(r){this.vert.style.display="block",this.vert.style.bottom=t?i+"px":"0";var n=e.viewHeight-(t?i:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+n)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=r?i+"px":"0",this.horiz.style.left=e.barLeft+"px";var o=e.viewWidth-e.barLeft-(r?i:0);this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+o)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(0==i&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:r?i:0,bottom:t?i:0}},Fi.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},Fi.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},Fi.prototype.zeroWidthHack=function(){var e=v&&!d?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new W,this.disableVert=new W},Fi.prototype.enableZeroWidthBar=function(e,t,r){e.style.pointerEvents="auto",t.set(1e3,function i(){var n=e.getBoundingClientRect(),o="vert"==r?document.elementFromPoint(n.right-1,(n.top+n.bottom)/2):document.elementFromPoint((n.right+n.left)/2,n.bottom-1);o!=e?e.style.pointerEvents="none":t.set(1e3,i)})},Fi.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)};var Ii=function(){};function Wi(e,t){t||(t=Bi(e));var r=e.display.barWidth,i=e.display.barHeight;Ni(e,t);for(var n=0;n<4&&r!=e.display.barWidth||i!=e.display.barHeight;n++)r!=e.display.barWidth&&e.options.lineWrapping&&Si(e),Ni(e,Bi(e)),r=e.display.barWidth,i=e.display.barHeight}function Ni(e,t){var r=e.display,i=r.scrollbars.update(t);r.sizer.style.paddingRight=(r.barWidth=i.right)+"px",r.sizer.style.paddingBottom=(r.barHeight=i.bottom)+"px",r.heightForcer.style.borderBottom=i.bottom+"px solid transparent",i.right&&i.bottom?(r.scrollbarFiller.style.display="block",r.scrollbarFiller.style.height=i.bottom+"px",r.scrollbarFiller.style.width=i.right+"px"):r.scrollbarFiller.style.display="",i.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(r.gutterFiller.style.display="block",r.gutterFiller.style.height=i.bottom+"px",r.gutterFiller.style.width=t.gutterWidth+"px"):r.gutterFiller.style.display=""}Ii.prototype.update=function(){return{bottom:0,right:0}},Ii.prototype.setScrollLeft=function(){},Ii.prototype.setScrollTop=function(){},Ii.prototype.clear=function(){};var Ui={native:Fi,null:Ii};function zi(e){e.display.scrollbars&&(e.display.scrollbars.clear(),e.display.scrollbars.addClass&&k(e.display.wrapper,e.display.scrollbars.addClass)),e.display.scrollbars=new Ui[e.options.scrollbarStyle](function(t){e.display.wrapper.insertBefore(t,e.display.scrollbarFiller),fe(t,"mousedown",function(){e.state.focused&&setTimeout(function(){return e.display.input.focus()},0)}),t.setAttribute("cm-not-content","true")},function(t,r){"horizontal"==r?Pi(e,t):Oi(e,t)},e),e.display.scrollbars.addClass&&O(e.display.wrapper,e.display.scrollbars.addClass)}var ji=0;function Ki(e){var t;e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++ji},t=e.curOp,sr?sr.ops.push(t):t.ownsGroup=sr={ops:[t],delayedCallbacks:[]}}function Gi(e){var t=e.curOp;t&&function(e,t){var r=e.ownsGroup;if(r)try{!function(e){var t=e.delayedCallbacks,r=0;do{for(;r<t.length;r++)t[r].call(null);for(var i=0;i<e.ops.length;i++){var n=e.ops[i];if(n.cursorActivityHandlers)for(;n.cursorActivityCalled<n.cursorActivityHandlers.length;)n.cursorActivityHandlers[n.cursorActivityCalled++].call(null,n.cm)}}while(r<t.length)}(r)}finally{sr=null,t(r)}}(t,function(e){for(var t=0;t<e.ops.length;t++)e.ops[t].cm.curOp=null;!function(e){for(var t=e.ops,r=0;r<t.length;r++)Vi(t[r]);for(var i=0;i<t.length;i++)(n=t[i]).updatedDisplay=n.mustUpdate&&nn(n.cm,n.update);for(var n,o=0;o<t.length;o++)Xi(t[o]);for(var s=0;s<t.length;s++)Yi(t[s]);for(var a=0;a<t.length;a++)qi(t[a])}(e)})}function Vi(e){var t=e.cm,r=t.display;!function(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=kr(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=kr(e)+"px",t.scrollbarsClipped=!0)}(t),e.updateMaxLine&&Vt(t),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<r.viewFrom||e.scrollToPos.to.line>=r.viewTo)||r.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new rn(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function Xi(e){var t=e.cm,r=t.display;e.updatedDisplay&&Si(t),e.barMeasure=Bi(t),r.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=Mr(t,r.maxLine,r.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(r.scroller.clientWidth,r.sizer.offsetLeft+e.adjustWidthTo+kr(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,r.sizer.offsetLeft+e.adjustWidthTo-Tr(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=r.input.prepareSelection())}function Yi(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&Pi(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1);var r=e.focus&&e.focus==R();e.preparedSelection&&t.display.input.showSelection(e.preparedSelection,r),(e.updatedDisplay||e.startHeight!=t.doc.height)&&Wi(t,e.barMeasure),e.updatedDisplay&&ln(t,e.barMeasure),e.selectionChanged&&yi(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),r&&Ci(e.cm)}function qi(e){var t=e.cm,r=t.display,i=t.doc;if(e.updatedDisplay&&on(t,e.update),null==r.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(r.wheelStartX=r.wheelStartY=null),null!=e.scrollTop&&Hi(t,e.scrollTop,e.forceScroll),null!=e.scrollLeft&&Pi(t,e.scrollLeft,!0,!0),e.scrollToPos){var n=function(e,t,r,i){var n;null==i&&(i=0),e.options.lineWrapping||t!=r||(t=t.ch?tt(t.line,"before"==t.sticky?t.ch-1:t.ch,"after"):t,r="before"==t.sticky?tt(t.line,t.ch+1,"before"):t);for(var o=0;o<5;o++){var s=!1,a=Xr(e,t),l=r&&r!=t?Xr(e,r):a;n={left:Math.min(a.left,l.left),top:Math.min(a.top,l.top)-i,right:Math.max(a.left,l.left),bottom:Math.max(a.bottom,l.bottom)+i};var c=Ti(e,n),h=e.doc.scrollTop,u=e.doc.scrollLeft;if(null!=c.scrollTop&&(Oi(e,c.scrollTop),Math.abs(e.doc.scrollTop-h)>1&&(s=!0)),null!=c.scrollLeft&&(Pi(e,c.scrollLeft),Math.abs(e.doc.scrollLeft-u)>1&&(s=!0)),!s)break}return n}(t,lt(i,e.scrollToPos.from),lt(i,e.scrollToPos.to),e.scrollToPos.margin);!function(e,t){if(!ge(e,"scrollCursorIntoView")){var r=e.display,i=r.sizer.getBoundingClientRect(),n=null;if(t.top+i.top<0?n=!0:t.bottom+i.top>(window.innerHeight||document.documentElement.clientHeight)&&(n=!1),null!=n&&!p){var o=E("div","​",null,"position: absolute;\n                         top: "+(t.top-r.viewOffset-xr(e.display))+"px;\n                         height: "+(t.bottom-t.top+kr(e)+r.barHeight)+"px;\n                         left: "+t.left+"px; width: "+Math.max(2,t.right-t.left)+"px;");e.display.lineSpace.appendChild(o),o.scrollIntoView(n),e.display.lineSpace.removeChild(o)}}}(t,n)}var o=e.maybeHiddenMarkers,s=e.maybeUnhiddenMarkers;if(o)for(var a=0;a<o.length;++a)o[a].lines.length||me(o[a],"hide");if(s)for(var l=0;l<s.length;++l)s[l].lines.length&&me(s[l],"unhide");r.wrapper.offsetHeight&&(i.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&me(t,"changes",t,e.changeObjs),e.update&&e.update.finish()}function Zi(e,t){if(e.curOp)return t();Ki(e);try{return t()}finally{Gi(e)}}function Ji(e,t){return function(){if(e.curOp)return t.apply(e,arguments);Ki(e);try{return t.apply(e,arguments)}finally{Gi(e)}}}function $i(e){return function(){if(this.curOp)return e.apply(this,arguments);Ki(this);try{return e.apply(this,arguments)}finally{Gi(this)}}}function Qi(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);Ki(t);try{return e.apply(this,arguments)}finally{Gi(t)}}}function en(e,t){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(t,B(tn,e))}function tn(e){var t=e.doc;if(!(t.highlightFrontier>=e.display.viewTo)){var r=+new Date+e.options.workTime,i=pt(e,t.highlightFrontier),n=[];t.iter(i.line,Math.min(t.first+t.size,e.display.viewTo+500),function(o){if(i.line>=e.display.viewFrom){var s=o.styles,a=o.text.length>e.options.maxHighlightLength?je(t.mode,i.state):null,l=ft(e,o,i,!0);a&&(i.state=a),o.styles=l.styles;var c=o.styleClasses,h=l.classes;h?o.styleClasses=h:c&&(o.styleClasses=null);for(var u=!s||s.length!=o.styles.length||c!=h&&(!c||!h||c.bgClass!=h.bgClass||c.textClass!=h.textClass),f=0;!u&&f<s.length;++f)u=s[f]!=o.styles[f];u&&n.push(i.line),o.stateAfter=i.save(),i.nextLine()}else o.text.length<=e.options.maxHighlightLength&&mt(e,o.text,i),o.stateAfter=i.line%5==0?i.save():null,i.nextLine();if(+new Date>r)return en(e,e.options.workDelay),!0}),t.highlightFrontier=i.line,t.modeFrontier=Math.max(t.modeFrontier,i.line),n.length&&Zi(e,function(){for(var t=0;t<n.length;t++)hi(e,n[t],"text")})}}var rn=function(e,t,r){var i=e.display;this.viewport=t,this.visible=ki(i,e.doc,t),this.editorIsHidden=!i.wrapper.offsetWidth,this.wrapperHeight=i.wrapper.clientHeight,this.wrapperWidth=i.wrapper.clientWidth,this.oldDisplayWidth=Tr(e),this.force=r,this.dims=ii(e),this.events=[]};function nn(e,t){var r=e.display,i=e.doc;if(t.editorIsHidden)return ui(e),!1;if(!t.force&&t.visible.from>=r.viewFrom&&t.visible.to<=r.viewTo&&(null==r.updateLineNumbers||r.updateLineNumbers>=r.viewTo)&&r.renderedView==r.view&&0==di(e))return!1;hn(e)&&(ui(e),t.dims=ii(e));var n=i.first+i.size,o=Math.max(t.visible.from-e.options.viewportMargin,i.first),s=Math.min(n,t.visible.to+e.options.viewportMargin);r.viewFrom<o&&o-r.viewFrom<20&&(o=Math.max(i.first,r.viewFrom)),r.viewTo>s&&r.viewTo-s<20&&(s=Math.min(n,r.viewTo)),xt&&(o=Nt(e.doc,o),s=Ut(e.doc,s));var a=o!=r.viewFrom||s!=r.viewTo||r.lastWrapHeight!=t.wrapperHeight||r.lastWrapWidth!=t.wrapperWidth;!function(e,t,r){var i=e.display;0==i.view.length||t>=i.viewTo||r<=i.viewFrom?(i.view=or(e,t,r),i.viewFrom=t):(i.viewFrom>t?i.view=or(e,t,i.viewFrom).concat(i.view):i.viewFrom<t&&(i.view=i.view.slice(li(e,t))),i.viewFrom=t,i.viewTo<r?i.view=i.view.concat(or(e,i.viewTo,r)):i.viewTo>r&&(i.view=i.view.slice(0,li(e,r)))),i.viewTo=r}(e,o,s),r.viewOffset=Kt(Xe(e.doc,r.viewFrom)),e.display.mover.style.top=r.viewOffset+"px";var c=di(e);if(!a&&0==c&&!t.force&&r.renderedView==r.view&&(null==r.updateLineNumbers||r.updateLineNumbers>=r.viewTo))return!1;var h=function(e){if(e.hasFocus())return null;var t=R();if(!t||!D(e.display.lineDiv,t))return null;var r={activeElt:t};if(window.getSelection){var i=window.getSelection();i.anchorNode&&i.extend&&D(e.display.lineDiv,i.anchorNode)&&(r.anchorNode=i.anchorNode,r.anchorOffset=i.anchorOffset,r.focusNode=i.focusNode,r.focusOffset=i.focusOffset)}return r}(e);return c>4&&(r.lineDiv.style.display="none"),function(e,t,r){var i=e.display,n=e.options.lineNumbers,o=i.lineDiv,s=o.firstChild;function a(t){var r=t.nextSibling;return l&&v&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),r}for(var c=i.view,h=i.viewFrom,u=0;u<c.length;u++){var f=c[u];if(f.hidden);else if(f.node&&f.node.parentNode==o){for(;s!=f.node;)s=a(s);var d=n&&null!=t&&t<=h&&f.lineNumber;f.changes&&(N(f.changes,"gutter")>-1&&(d=!1),hr(e,f,h,r)),d&&(T(f.lineNumber),f.lineNumber.appendChild(document.createTextNode(et(e.options,h)))),s=f.node.nextSibling}else{var p=_r(e,f,h,r);o.insertBefore(p,s)}h+=f.size}for(;s;)s=a(s)}(e,r.updateLineNumbers,t.dims),c>4&&(r.lineDiv.style.display=""),r.renderedView=r.view,function(e){if(e&&e.activeElt&&e.activeElt!=R()&&(e.activeElt.focus(),e.anchorNode&&D(document.body,e.anchorNode)&&D(document.body,e.focusNode))){var t=window.getSelection(),r=document.createRange();r.setEnd(e.anchorNode,e.anchorOffset),r.collapse(!1),t.removeAllRanges(),t.addRange(r),t.extend(e.focusNode,e.focusOffset)}}(h),T(r.cursorDiv),T(r.selectionDiv),r.gutters.style.height=r.sizer.style.minHeight=0,a&&(r.lastWrapHeight=t.wrapperHeight,r.lastWrapWidth=t.wrapperWidth,en(e,400)),r.updateLineNumbers=null,!0}function on(e,t){for(var r=t.viewport,i=!0;(i&&e.options.lineWrapping&&t.oldDisplayWidth!=Tr(e)||(r&&null!=r.top&&(r={top:Math.min(e.doc.height+Sr(e.display)-Ar(e),r.top)}),t.visible=ki(e.display,e.doc,r),!(t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)))&&nn(e,t);i=!1){Si(e);var n=Bi(e);pi(e),Wi(e,n),ln(e,n),t.force=!1}t.signal(e,"update",e),e.display.viewFrom==e.display.reportedViewFrom&&e.display.viewTo==e.display.reportedViewTo||(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function sn(e,t){var r=new rn(e,t);if(nn(e,r)){Si(e),on(e,r);var i=Bi(e);pi(e),Wi(e,i),ln(e,i),r.finish()}}function an(e){var t=e.gutters.offsetWidth;e.sizer.style.marginLeft=t+"px"}function ln(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+kr(e)+"px"}function cn(e){var t=e.display,r=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var i=ni(t)-t.scroller.scrollLeft+e.doc.scrollLeft,n=t.gutters.offsetWidth,o=i+"px",s=0;s<r.length;s++)if(!r[s].hidden){e.options.fixedGutter&&(r[s].gutter&&(r[s].gutter.style.left=o),r[s].gutterBackground&&(r[s].gutterBackground.style.left=o));var a=r[s].alignable;if(a)for(var l=0;l<a.length;l++)a[l].style.left=o}e.options.fixedGutter&&(t.gutters.style.left=i+n+"px")}}function hn(e){if(!e.options.lineNumbers)return!1;var t=e.doc,r=et(e.options,t.first+t.size-1),i=e.display;if(r.length!=i.lineNumChars){var n=i.measure.appendChild(E("div",[E("div",r)],"CodeMirror-linenumber CodeMirror-gutter-elt")),o=n.firstChild.offsetWidth,s=n.offsetWidth-o;return i.lineGutter.style.width="",i.lineNumInnerWidth=Math.max(o,i.lineGutter.offsetWidth-s)+1,i.lineNumWidth=i.lineNumInnerWidth+s,i.lineNumChars=i.lineNumInnerWidth?r.length:-1,i.lineGutter.style.width=i.lineNumWidth+"px",an(e.display),!0}return!1}function un(e,t){for(var r=[],i=!1,n=0;n<e.length;n++){var o=e[n],s=null;if("string"!=typeof o&&(s=o.style,o=o.className),"CodeMirror-linenumbers"==o){if(!t)continue;i=!0}r.push({className:o,style:s})}return t&&!i&&r.push({className:"CodeMirror-linenumbers",style:null}),r}function fn(e){var t=e.gutters,r=e.gutterSpecs;T(t),e.lineGutter=null;for(var i=0;i<r.length;++i){var n=r[i],o=n.className,s=n.style,a=t.appendChild(E("div",null,"CodeMirror-gutter "+o));s&&(a.style.cssText=s),"CodeMirror-linenumbers"==o&&(e.lineGutter=a,a.style.width=(e.lineNumWidth||1)+"px")}t.style.display=r.length?"":"none",an(e)}function dn(e){fn(e.display),ci(e),cn(e)}function pn(e,t,i,n){var o=this;this.input=i,o.scrollbarFiller=E("div",null,"CodeMirror-scrollbar-filler"),o.scrollbarFiller.setAttribute("cm-not-content","true"),o.gutterFiller=E("div",null,"CodeMirror-gutter-filler"),o.gutterFiller.setAttribute("cm-not-content","true"),o.lineDiv=M("div",null,"CodeMirror-code"),o.selectionDiv=E("div",null,null,"position: relative; z-index: 1"),o.cursorDiv=E("div",null,"CodeMirror-cursors"),o.measure=E("div",null,"CodeMirror-measure"),o.lineMeasure=E("div",null,"CodeMirror-measure"),o.lineSpace=M("div",[o.measure,o.lineMeasure,o.selectionDiv,o.cursorDiv,o.lineDiv],null,"position: relative; outline: none");var c=M("div",[o.lineSpace],"CodeMirror-lines");o.mover=E("div",[c],null,"position: relative"),o.sizer=E("div",[o.mover],"CodeMirror-sizer"),o.sizerWidth=null,o.heightForcer=E("div",null,null,"position: absolute; height: "+U+"px; width: 1px;"),o.gutters=E("div",null,"CodeMirror-gutters"),o.lineGutter=null,o.scroller=E("div",[o.sizer,o.heightForcer,o.gutters],"CodeMirror-scroll"),o.scroller.setAttribute("tabIndex","-1"),o.wrapper=E("div",[o.scrollbarFiller,o.gutterFiller,o.scroller],"CodeMirror"),s&&a<8&&(o.gutters.style.zIndex=-1,o.scroller.style.paddingRight=0),l||r&&_||(o.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(o.wrapper):e(o.wrapper)),o.viewFrom=o.viewTo=t.first,o.reportedViewFrom=o.reportedViewTo=t.first,o.view=[],o.renderedView=null,o.externalMeasured=null,o.viewOffset=0,o.lastWrapHeight=o.lastWrapWidth=0,o.updateLineNumbers=null,o.nativeBarWidth=o.barHeight=o.barWidth=0,o.scrollbarsClipped=!1,o.lineNumWidth=o.lineNumInnerWidth=o.lineNumChars=null,o.alignWidgets=!1,o.cachedCharWidth=o.cachedTextHeight=o.cachedPaddingH=null,o.maxLine=null,o.maxLineLength=0,o.maxLineChanged=!1,o.wheelDX=o.wheelDY=o.wheelStartX=o.wheelStartY=null,o.shift=!1,o.selForContextMenu=null,o.activeTouch=null,o.gutterSpecs=un(n.gutters,n.lineNumbers),fn(o),i.init(o)}rn.prototype.signal=function(e,t){ve(e,t)&&this.events.push(arguments)},rn.prototype.finish=function(){for(var e=0;e<this.events.length;e++)me.apply(null,this.events[e])};var mn=0,gn=null;function _n(e){var t=e.wheelDeltaX,r=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==r&&e.detail&&e.axis==e.VERTICAL_AXIS?r=e.detail:null==r&&(r=e.wheelDelta),{x:t,y:r}}function vn(e){var t=_n(e);return t.x*=gn,t.y*=gn,t}function yn(e,t){var i=_n(t),n=i.x,o=i.y,s=e.display,a=s.scroller,c=a.scrollWidth>a.clientWidth,h=a.scrollHeight>a.clientHeight;if(n&&c||o&&h){if(o&&v&&l)e:for(var f=t.target,d=s.view;f!=a;f=f.parentNode)for(var p=0;p<d.length;p++)if(d[p].node==f){e.display.currentWheelTarget=f;break e}if(n&&!r&&!u&&null!=gn)return o&&h&&Oi(e,Math.max(0,a.scrollTop+o*gn)),Pi(e,Math.max(0,a.scrollLeft+n*gn)),(!o||o&&h)&&Ce(t),void(s.wheelStartX=null);if(o&&null!=gn){var m=o*gn,g=e.doc.scrollTop,_=g+s.wrapper.clientHeight;m<0?g=Math.max(0,g+m-50):_=Math.min(e.doc.height,_+m+50),sn(e,{top:g,bottom:_})}mn<20&&(null==s.wheelStartX?(s.wheelStartX=a.scrollLeft,s.wheelStartY=a.scrollTop,s.wheelDX=n,s.wheelDY=o,setTimeout(function(){if(null!=s.wheelStartX){var e=a.scrollLeft-s.wheelStartX,t=a.scrollTop-s.wheelStartY,r=t&&s.wheelDY&&t/s.wheelDY||e&&s.wheelDX&&e/s.wheelDX;s.wheelStartX=s.wheelStartY=null,r&&(gn=(gn*mn+r)/(mn+1),++mn)}},200)):(s.wheelDX+=n,s.wheelDY+=o))}}s?gn=-.53:r?gn=15:h?gn=-.7:f&&(gn=-1/3);var Cn=function(e,t){this.ranges=e,this.primIndex=t};Cn.prototype.primary=function(){return this.ranges[this.primIndex]},Cn.prototype.equals=function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var r=this.ranges[t],i=e.ranges[t];if(!it(r.anchor,i.anchor)||!it(r.head,i.head))return!1}return!0},Cn.prototype.deepCopy=function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new bn(nt(this.ranges[t].anchor),nt(this.ranges[t].head));return new Cn(e,this.primIndex)},Cn.prototype.somethingSelected=function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},Cn.prototype.contains=function(e,t){t||(t=e);for(var r=0;r<this.ranges.length;r++){var i=this.ranges[r];if(rt(t,i.from())>=0&&rt(e,i.to())<=0)return r}return-1};var bn=function(e,t){this.anchor=e,this.head=t};function wn(e,t,r){var i=e&&e.options.selectionsMayTouch,n=t[r];t.sort(function(e,t){return rt(e.from(),t.from())}),r=N(t,n);for(var o=1;o<t.length;o++){var s=t[o],a=t[o-1],l=rt(a.to(),s.from());if(i&&!s.empty()?l>0:l>=0){var c=st(a.from(),s.from()),h=ot(a.to(),s.to()),u=a.empty()?s.from()==s.head:a.from()==a.head;o<=r&&--r,t.splice(--o,2,new bn(u?h:c,u?c:h))}}return new Cn(t,r)}function xn(e,t){return new Cn([new bn(e,t||e)],0)}function Sn(e){return e.text?tt(e.from.line+e.text.length-1,q(e.text).length+(1==e.text.length?e.from.ch:0)):e.to}function Ln(e,t){if(rt(e,t.from)<0)return e;if(rt(e,t.to)<=0)return Sn(t);var r=e.line+t.text.length-(t.to.line-t.from.line)-1,i=e.ch;return e.line==t.to.line&&(i+=Sn(t).ch-t.to.ch),tt(r,i)}function kn(e,t){for(var r=[],i=0;i<e.sel.ranges.length;i++){var n=e.sel.ranges[i];r.push(new bn(Ln(n.anchor,t),Ln(n.head,t)))}return wn(e.cm,r,e.sel.primIndex)}function Tn(e,t,r){return e.line==t.line?tt(r.line,e.ch-t.ch+r.ch):tt(r.line+(e.line-t.line),e.ch)}function An(e){e.doc.mode=Ne(e.options,e.doc.modeOption),En(e)}function En(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,en(e,100),e.state.modeGen++,e.curOp&&ci(e)}function Mn(e,t){return 0==t.from.ch&&0==t.to.ch&&""==q(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function Dn(e,t,r,i){function n(e){return r?r[e]:null}function o(e,r,n){!function(e,t,r,i){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),Et(e),Mt(e,r);var n=i?i(e):1;n!=e.height&&Ze(e,n)}(e,r,n,i),lr(e,"change",e,t)}function s(e,t){for(var r=[],o=e;o<t;++o)r.push(new Xt(c[o],n(o),i));return r}var a=t.from,l=t.to,c=t.text,h=Xe(e,a.line),u=Xe(e,l.line),f=q(c),d=n(c.length-1),p=l.line-a.line;if(t.full)e.insert(0,s(0,c.length)),e.remove(c.length,e.size-c.length);else if(Mn(e,t)){var m=s(0,c.length-1);o(u,u.text,d),p&&e.remove(a.line,p),m.length&&e.insert(a.line,m)}else if(h==u)if(1==c.length)o(h,h.text.slice(0,a.ch)+f+h.text.slice(l.ch),d);else{var g=s(1,c.length-1);g.push(new Xt(f+h.text.slice(l.ch),d,i)),o(h,h.text.slice(0,a.ch)+c[0],n(0)),e.insert(a.line+1,g)}else if(1==c.length)o(h,h.text.slice(0,a.ch)+c[0]+u.text.slice(l.ch),n(0)),e.remove(a.line+1,p);else{o(h,h.text.slice(0,a.ch)+c[0],n(0)),o(u,f+u.text.slice(l.ch),d);var _=s(1,c.length-1);p>1&&e.remove(a.line+1,p-1),e.insert(a.line+1,_)}lr(e,"change",e,t)}function Rn(e,t,r){!function e(i,n,o){if(i.linked)for(var s=0;s<i.linked.length;++s){var a=i.linked[s];if(a.doc!=n){var l=o&&a.sharedHist;r&&!l||(t(a.doc,l),e(a.doc,i,l))}}}(e,null,!0)}function On(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,si(e),An(e),Hn(e),e.options.lineWrapping||Vt(e),e.options.mode=t.modeOption,ci(e)}function Hn(e){("rtl"==e.doc.direction?O:k)(e.display.lineDiv,"CodeMirror-rtl")}function Pn(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function Bn(e,t){var r={from:nt(t.from),to:Sn(t),text:Ye(e,t.from,t.to)};return Un(e,r,t.from.line,t.to.line+1),Rn(e,function(e){return Un(e,r,t.from.line,t.to.line+1)},!0),r}function Fn(e){for(;e.length;){var t=q(e);if(!t.ranges)break;e.pop()}}function In(e,t,r,i){var n=e.history;n.undone.length=0;var o,s,a=+new Date;if((n.lastOp==i||n.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&n.lastModTime>a-(e.cm?e.cm.options.historyEventDelay:500)||"*"==t.origin.charAt(0)))&&(o=function(e,t){return t?(Fn(e.done),q(e.done)):e.done.length&&!q(e.done).ranges?q(e.done):e.done.length>1&&!e.done[e.done.length-2].ranges?(e.done.pop(),q(e.done)):void 0}(n,n.lastOp==i)))s=q(o.changes),0==rt(t.from,t.to)&&0==rt(t.from,s.to)?s.to=Sn(t):o.changes.push(Bn(e,t));else{var l=q(n.done);for(l&&l.ranges||Nn(e.sel,n.done),o={changes:[Bn(e,t)],generation:n.generation},n.done.push(o);n.done.length>n.undoDepth;)n.done.shift(),n.done[0].ranges||n.done.shift()}n.done.push(r),n.generation=++n.maxGeneration,n.lastModTime=n.lastSelTime=a,n.lastOp=n.lastSelOp=i,n.lastOrigin=n.lastSelOrigin=t.origin,s||me(e,"historyAdded")}function Wn(e,t,r,i){var n=e.history,o=i&&i.origin;r==n.lastSelOp||o&&n.lastSelOrigin==o&&(n.lastModTime==n.lastSelTime&&n.lastOrigin==o||function(e,t,r,i){var n=t.charAt(0);return"*"==n||"+"==n&&r.ranges.length==i.ranges.length&&r.somethingSelected()==i.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}(e,o,q(n.done),t))?n.done[n.done.length-1]=t:Nn(t,n.done),n.lastSelTime=+new Date,n.lastSelOrigin=o,n.lastSelOp=r,i&&!1!==i.clearRedo&&Fn(n.undone)}function Nn(e,t){var r=q(t);r&&r.ranges&&r.equals(e)||t.push(e)}function Un(e,t,r,i){var n=t["spans_"+e.id],o=0;e.iter(Math.max(e.first,r),Math.min(e.first+e.size,i),function(r){r.markedSpans&&((n||(n=t["spans_"+e.id]={}))[o]=r.markedSpans),++o})}function zn(e){if(!e)return null;for(var t,r=0;r<e.length;++r)e[r].marker.explicitlyCleared?t||(t=e.slice(0,r)):t&&t.push(e[r]);return t?t.length?t:null:e}function jn(e,t){var r=function(e,t){var r=t["spans_"+e.id];if(!r)return null;for(var i=[],n=0;n<t.text.length;++n)i.push(zn(r[n]));return i}(e,t),i=Tt(e,t);if(!r)return i;if(!i)return r;for(var n=0;n<r.length;++n){var o=r[n],s=i[n];if(o&&s)e:for(var a=0;a<s.length;++a){for(var l=s[a],c=0;c<o.length;++c)if(o[c].marker==l.marker)continue e;o.push(l)}else s&&(r[n]=s)}return r}function Kn(e,t,r){for(var i=[],n=0;n<e.length;++n){var o=e[n];if(o.ranges)i.push(r?Cn.prototype.deepCopy.call(o):o);else{var s=o.changes,a=[];i.push({changes:a});for(var l=0;l<s.length;++l){var c=s[l],h=void 0;if(a.push({from:c.from,to:c.to,text:c.text}),t)for(var u in c)(h=u.match(/^spans_(\d+)$/))&&N(t,Number(h[1]))>-1&&(q(a)[u]=c[u],delete c[u])}}}return i}function Gn(e,t,r,i){if(i){var n=e.anchor;if(r){var o=rt(t,n)<0;o!=rt(r,n)<0?(n=t,t=r):o!=rt(t,r)<0&&(t=r)}return new bn(n,t)}return new bn(r||t,t)}function Vn(e,t,r,i,n){null==n&&(n=e.cm&&(e.cm.display.shift||e.extend)),Jn(e,new Cn([Gn(e.sel.primary(),t,r,n)],0),i)}function Xn(e,t,r){for(var i=[],n=e.cm&&(e.cm.display.shift||e.extend),o=0;o<e.sel.ranges.length;o++)i[o]=Gn(e.sel.ranges[o],t[o],null,n);var s=wn(e.cm,i,e.sel.primIndex);Jn(e,s,r)}function Yn(e,t,r,i){var n=e.sel.ranges.slice(0);n[t]=r,Jn(e,wn(e.cm,n,e.sel.primIndex),i)}function qn(e,t,r,i){Jn(e,xn(t,r),i)}function Zn(e,t,r){var i=e.history.done,n=q(i);n&&n.ranges?(i[i.length-1]=t,$n(e,t,r)):Jn(e,t,r)}function Jn(e,t,r){$n(e,t,r),Wn(e,e.sel,e.cm?e.cm.curOp.id:NaN,r)}function $n(e,t,r){(ve(e,"beforeSelectionChange")||e.cm&&ve(e.cm,"beforeSelectionChange"))&&(t=function(e,t,r){var i={ranges:t.ranges,update:function(t){this.ranges=[];for(var r=0;r<t.length;r++)this.ranges[r]=new bn(lt(e,t[r].anchor),lt(e,t[r].head))},origin:r&&r.origin};return me(e,"beforeSelectionChange",e,i),e.cm&&me(e.cm,"beforeSelectionChange",e.cm,i),i.ranges!=t.ranges?wn(e.cm,i.ranges,i.ranges.length-1):t}(e,t,r));var i=r&&r.bias||(rt(t.primary().head,e.sel.primary().head)<0?-1:1);Qn(e,to(e,t,i,!0)),r&&!1===r.scroll||!e.cm||Ei(e.cm)}function Qn(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=1,e.cm.curOp.selectionChanged=!0,_e(e.cm)),lr(e,"cursorActivity",e))}function eo(e){Qn(e,to(e,e.sel,null,!1))}function to(e,t,r,i){for(var n,o=0;o<t.ranges.length;o++){var s=t.ranges[o],a=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[o],l=io(e,s.anchor,a&&a.anchor,r,i),c=io(e,s.head,a&&a.head,r,i);(n||l!=s.anchor||c!=s.head)&&(n||(n=t.ranges.slice(0,o)),n[o]=new bn(l,c))}return n?wn(e.cm,n,t.primIndex):t}function ro(e,t,r,i,n){var o=Xe(e,t.line);if(o.markedSpans)for(var s=0;s<o.markedSpans.length;++s){var a=o.markedSpans[s],l=a.marker,c="selectLeft"in l?!l.selectLeft:l.inclusiveLeft,h="selectRight"in l?!l.selectRight:l.inclusiveRight;if((null==a.from||(c?a.from<=t.ch:a.from<t.ch))&&(null==a.to||(h?a.to>=t.ch:a.to>t.ch))){if(n&&(me(l,"beforeCursorEnter"),l.explicitlyCleared)){if(o.markedSpans){--s;continue}break}if(!l.atomic)continue;if(r){var u=l.find(i<0?1:-1),f=void 0;if((i<0?h:c)&&(u=no(e,u,-i,u&&u.line==t.line?o:null)),u&&u.line==t.line&&(f=rt(u,r))&&(i<0?f<0:f>0))return ro(e,u,t,i,n)}var d=l.find(i<0?-1:1);return(i<0?c:h)&&(d=no(e,d,i,d.line==t.line?o:null)),d?ro(e,d,t,i,n):null}}return t}function io(e,t,r,i,n){var o=i||1,s=ro(e,t,r,o,n)||!n&&ro(e,t,r,o,!0)||ro(e,t,r,-o,n)||!n&&ro(e,t,r,-o,!0);return s||(e.cantEdit=!0,tt(e.first,0))}function no(e,t,r,i){return r<0&&0==t.ch?t.line>e.first?lt(e,tt(t.line-1)):null:r>0&&t.ch==(i||Xe(e,t.line)).text.length?t.line<e.first+e.size-1?tt(t.line+1,0):null:new tt(t.line,t.ch+r)}function oo(e){e.setSelection(tt(e.firstLine(),0),tt(e.lastLine()),j)}function so(e,t,r){var i={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){return i.canceled=!0}};return r&&(i.update=function(t,r,n,o){t&&(i.from=lt(e,t)),r&&(i.to=lt(e,r)),n&&(i.text=n),void 0!==o&&(i.origin=o)}),me(e,"beforeChange",e,i),e.cm&&me(e.cm,"beforeChange",e.cm,i),i.canceled?(e.cm&&(e.cm.curOp.updateInput=2),null):{from:i.from,to:i.to,text:i.text,origin:i.origin}}function ao(e,t,r){if(e.cm){if(!e.cm.curOp)return Ji(e.cm,ao)(e,t,r);if(e.cm.state.suppressEdits)return}if(!(ve(e,"beforeChange")||e.cm&&ve(e.cm,"beforeChange"))||(t=so(e,t,!0))){var i=wt&&!r&&function(e,t,r){var i=null;if(e.iter(t.line,r.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var r=e.markedSpans[t].marker;!r.readOnly||i&&-1!=N(i,r)||(i||(i=[])).push(r)}}),!i)return null;for(var n=[{from:t,to:r}],o=0;o<i.length;++o)for(var s=i[o],a=s.find(0),l=0;l<n.length;++l){var c=n[l];if(!(rt(c.to,a.from)<0||rt(c.from,a.to)>0)){var h=[l,1],u=rt(c.from,a.from),f=rt(c.to,a.to);(u<0||!s.inclusiveLeft&&!u)&&h.push({from:c.from,to:a.from}),(f>0||!s.inclusiveRight&&!f)&&h.push({from:a.to,to:c.to}),n.splice.apply(n,h),l+=h.length-3}}return n}(e,t.from,t.to);if(i)for(var n=i.length-1;n>=0;--n)lo(e,{from:i[n].from,to:i[n].to,text:n?[""]:t.text,origin:t.origin});else lo(e,t)}}function lo(e,t){if(1!=t.text.length||""!=t.text[0]||0!=rt(t.from,t.to)){var r=kn(e,t);In(e,t,r,e.cm?e.cm.curOp.id:NaN),uo(e,t,r,Tt(e,t));var i=[];Rn(e,function(e,r){r||-1!=N(i,e.history)||(go(e.history,t),i.push(e.history)),uo(e,t,null,Tt(e,t))})}}function co(e,t,r){var i=e.cm&&e.cm.state.suppressEdits;if(!i||r){for(var n,o=e.history,s=e.sel,a="undo"==t?o.done:o.undone,l="undo"==t?o.undone:o.done,c=0;c<a.length&&(n=a[c],r?!n.ranges||n.equals(e.sel):n.ranges);c++);if(c!=a.length){for(o.lastOrigin=o.lastSelOrigin=null;;){if(!(n=a.pop()).ranges){if(i)return void a.push(n);break}if(Nn(n,l),r&&!n.equals(e.sel))return void Jn(e,n,{clearRedo:!1});s=n}var h=[];Nn(s,l),l.push({changes:h,generation:o.generation}),o.generation=n.generation||++o.maxGeneration;for(var u=ve(e,"beforeChange")||e.cm&&ve(e.cm,"beforeChange"),f=function(r){var i=n.changes[r];if(i.origin=t,u&&!so(e,i,!1))return a.length=0,{};h.push(Bn(e,i));var o=r?kn(e,i):q(a);uo(e,i,o,jn(e,i)),!r&&e.cm&&e.cm.scrollIntoView({from:i.from,to:Sn(i)});var s=[];Rn(e,function(e,t){t||-1!=N(s,e.history)||(go(e.history,i),s.push(e.history)),uo(e,i,null,jn(e,i))})},d=n.changes.length-1;d>=0;--d){var p=f(d);if(p)return p.v}}}}function ho(e,t){if(0!=t&&(e.first+=t,e.sel=new Cn(Z(e.sel.ranges,function(e){return new bn(tt(e.anchor.line+t,e.anchor.ch),tt(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){ci(e.cm,e.first,e.first-t,t);for(var r=e.cm.display,i=r.viewFrom;i<r.viewTo;i++)hi(e.cm,i,"gutter")}}function uo(e,t,r,i){if(e.cm&&!e.cm.curOp)return Ji(e.cm,uo)(e,t,r,i);if(t.to.line<e.first)ho(e,t.text.length-1-(t.to.line-t.from.line));else if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var n=t.text.length-1-(e.first-t.from.line);ho(e,n),t={from:tt(e.first,0),to:tt(t.to.line+n,t.to.ch),text:[q(t.text)],origin:t.origin}}var o=e.lastLine();t.to.line>o&&(t={from:t.from,to:tt(o,Xe(e,o).text.length),text:[t.text[0]],origin:t.origin}),t.removed=Ye(e,t.from,t.to),r||(r=kn(e,t)),e.cm?function(e,t,r){var i=e.doc,n=e.display,o=t.from,s=t.to,a=!1,l=o.line;e.options.lineWrapping||(l=Je(Wt(Xe(i,o.line))),i.iter(l,s.line+1,function(e){if(e==n.maxLine)return a=!0,!0})),i.sel.contains(t.from,t.to)>-1&&_e(e),Dn(i,t,r,oi(e)),e.options.lineWrapping||(i.iter(l,o.line+t.text.length,function(e){var t=Gt(e);t>n.maxLineLength&&(n.maxLine=e,n.maxLineLength=t,n.maxLineChanged=!0,a=!1)}),a&&(e.curOp.updateMaxLine=!0)),function(e,t){if(e.modeFrontier=Math.min(e.modeFrontier,t),!(e.highlightFrontier<t-10)){for(var r=e.first,i=t-1;i>r;i--){var n=Xe(e,i).stateAfter;if(n&&(!(n instanceof ht)||i+n.lookAhead<t)){r=i+1;break}}e.highlightFrontier=Math.min(e.highlightFrontier,r)}}(i,o.line),en(e,400);var c=t.text.length-(s.line-o.line)-1;t.full?ci(e):o.line!=s.line||1!=t.text.length||Mn(e.doc,t)?ci(e,o.line,s.line+1,c):hi(e,o.line,"text");var h=ve(e,"changes"),u=ve(e,"change");if(u||h){var f={from:o,to:s,text:t.text,removed:t.removed,origin:t.origin};u&&lr(e,"change",e,f),h&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(f)}e.display.selForContextMenu=null}(e.cm,t,i):Dn(e,t,i),$n(e,r,j)}}function fo(e,t,r,i,n){var o;i||(i=r),rt(i,r)<0&&(r=(o=[i,r])[0],i=o[1]),"string"==typeof t&&(t=e.splitLines(t)),ao(e,{from:r,to:i,text:t,origin:n})}function po(e,t,r,i){r<e.line?e.line+=i:t<e.line&&(e.line=t,e.ch=0)}function mo(e,t,r,i){for(var n=0;n<e.length;++n){var o=e[n],s=!0;if(o.ranges){o.copied||((o=e[n]=o.deepCopy()).copied=!0);for(var a=0;a<o.ranges.length;a++)po(o.ranges[a].anchor,t,r,i),po(o.ranges[a].head,t,r,i)}else{for(var l=0;l<o.changes.length;++l){var c=o.changes[l];if(r<c.from.line)c.from=tt(c.from.line+i,c.from.ch),c.to=tt(c.to.line+i,c.to.ch);else if(t<=c.to.line){s=!1;break}}s||(e.splice(0,n+1),n=0)}}}function go(e,t){var r=t.from.line,i=t.to.line,n=t.text.length-(i-r)-1;mo(e.done,r,i,n),mo(e.undone,r,i,n)}function _o(e,t,r,i){var n=t,o=t;return"number"==typeof t?o=Xe(e,at(e,t)):n=Je(t),null==n?null:(i(o,n)&&e.cm&&hi(e.cm,n,r),o)}function vo(e){this.lines=e,this.parent=null;for(var t=0,r=0;r<e.length;++r)e[r].parent=this,t+=e[r].height;this.height=t}function yo(e){this.children=e;for(var t=0,r=0,i=0;i<e.length;++i){var n=e[i];t+=n.chunkSize(),r+=n.height,n.parent=this}this.size=t,this.height=r,this.parent=null}bn.prototype.from=function(){return st(this.anchor,this.head)},bn.prototype.to=function(){return ot(this.anchor,this.head)},bn.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},vo.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var r=e,i=e+t;r<i;++r){var n=this.lines[r];this.height-=n.height,Yt(n),lr(n,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,r){this.height+=r,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var i=0;i<t.length;++i)t[i].parent=this},iterN:function(e,t,r){for(var i=e+t;e<i;++e)if(r(this.lines[e]))return!0}},yo.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var r=0;r<this.children.length;++r){var i=this.children[r],n=i.chunkSize();if(e<n){var o=Math.min(t,n-e),s=i.height;if(i.removeInner(e,o),this.height-=s-i.height,n==o&&(this.children.splice(r--,1),i.parent=null),0==(t-=o))break;e=0}else e-=n}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof vo))){var a=[];this.collapse(a),this.children=[new vo(a)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,r){this.size+=t.length,this.height+=r;for(var i=0;i<this.children.length;++i){var n=this.children[i],o=n.chunkSize();if(e<=o){if(n.insertInner(e,t,r),n.lines&&n.lines.length>50){for(var s=n.lines.length%25+25,a=s;a<n.lines.length;){var l=new vo(n.lines.slice(a,a+=25));n.height-=l.height,this.children.splice(++i,0,l),l.parent=this}n.lines=n.lines.slice(0,s),this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=e.children.splice(e.children.length-5,5),r=new yo(t);if(e.parent){e.size-=r.size,e.height-=r.height;var i=N(e.parent.children,e);e.parent.children.splice(i+1,0,r)}else{var n=new yo(e.children);n.parent=e,e.children=[n,r],e=n}r.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,r){for(var i=0;i<this.children.length;++i){var n=this.children[i],o=n.chunkSize();if(e<o){var s=Math.min(t,o-e);if(n.iterN(e,s,r))return!0;if(0==(t-=s))break;e=0}else e-=o}}};var Co=function(e,t,r){if(r)for(var i in r)r.hasOwnProperty(i)&&(this[i]=r[i]);this.doc=e,this.node=t};function bo(e,t,r){Kt(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&Ai(e,r)}Co.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,r=this.line,i=Je(r);if(null!=i&&t){for(var n=0;n<t.length;++n)t[n]==this&&t.splice(n--,1);t.length||(r.widgets=null);var o=br(this);Ze(r,Math.max(0,r.height-o)),e&&(Zi(e,function(){bo(e,r,-o),hi(e,i,"widget")}),lr(e,"lineWidgetCleared",e,this,i))}},Co.prototype.changed=function(){var e=this,t=this.height,r=this.doc.cm,i=this.line;this.height=null;var n=br(this)-t;n&&(zt(this.doc,i)||Ze(i,i.height+n),r&&Zi(r,function(){r.curOp.forceUpdate=!0,bo(r,i,n),lr(r,"lineWidgetChanged",r,e,Je(i))}))},ye(Co);var wo=0,xo=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++wo};function So(e,t,r,i,n){if(i&&i.shared)return function(e,t,r,i,n){(i=F(i)).shared=!1;var o=[So(e,t,r,i,n)],s=o[0],a=i.widgetNode;return Rn(e,function(e){a&&(i.widgetNode=a.cloneNode(!0)),o.push(So(e,lt(e,t),lt(e,r),i,n));for(var l=0;l<e.linked.length;++l)if(e.linked[l].isParent)return;s=q(o)}),new Lo(o,s)}(e,t,r,i,n);if(e.cm&&!e.cm.curOp)return Ji(e.cm,So)(e,t,r,i,n);var o=new xo(e,n),s=rt(t,r);if(i&&F(i,o,!1),s>0||0==s&&!1!==o.clearWhenEmpty)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=M("span",[o.replacedWith],"CodeMirror-widget"),i.handleMouseEvents||o.widgetNode.setAttribute("cm-ignore-events","true"),i.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if(It(e,t.line,t,r,o)||t.line!=r.line&&It(e,r.line,t,r,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");xt=!0}o.addToHistory&&In(e,{from:t,to:r,origin:"markText"},e.sel,NaN);var a,l=t.line,c=e.cm;if(e.iter(l,r.line+1,function(e){c&&o.collapsed&&!c.options.lineWrapping&&Wt(e)==c.display.maxLine&&(a=!0),o.collapsed&&l!=t.line&&Ze(e,0),function(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}(e,new St(o,l==t.line?t.ch:null,l==r.line?r.ch:null)),++l}),o.collapsed&&e.iter(t.line,r.line+1,function(t){zt(e,t)&&Ze(t,0)}),o.clearOnEnter&&fe(o,"beforeCursorEnter",function(){return o.clear()}),o.readOnly&&(wt=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory()),o.collapsed&&(o.id=++wo,o.atomic=!0),c){if(a&&(c.curOp.updateMaxLine=!0),o.collapsed)ci(c,t.line,r.line+1);else if(o.className||o.startStyle||o.endStyle||o.css||o.attributes||o.title)for(var h=t.line;h<=r.line;h++)hi(c,h,"text");o.atomic&&eo(c.doc),lr(c,"markerAdded",c,o)}return o}xo.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&Ki(e),ve(this,"clear")){var r=this.find();r&&lr(this,"clear",r.from,r.to)}for(var i=null,n=null,o=0;o<this.lines.length;++o){var s=this.lines[o],a=Lt(s.markedSpans,this);e&&!this.collapsed?hi(e,Je(s),"text"):e&&(null!=a.to&&(n=Je(s)),null!=a.from&&(i=Je(s))),s.markedSpans=kt(s.markedSpans,a),null==a.from&&this.collapsed&&!zt(this.doc,s)&&e&&Ze(s,ti(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var l=0;l<this.lines.length;++l){var c=Wt(this.lines[l]),h=Gt(c);h>e.display.maxLineLength&&(e.display.maxLine=c,e.display.maxLineLength=h,e.display.maxLineChanged=!0)}null!=i&&e&&this.collapsed&&ci(e,i,n+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&eo(e.doc)),e&&lr(e,"markerCleared",e,this,i,n),t&&Gi(e),this.parent&&this.parent.clear()}},xo.prototype.find=function(e,t){var r,i;null==e&&"bookmark"==this.type&&(e=1);for(var n=0;n<this.lines.length;++n){var o=this.lines[n],s=Lt(o.markedSpans,this);if(null!=s.from&&(r=tt(t?o:Je(o),s.from),-1==e))return r;if(null!=s.to&&(i=tt(t?o:Je(o),s.to),1==e))return i}return r&&{from:r,to:i}},xo.prototype.changed=function(){var e=this,t=this.find(-1,!0),r=this,i=this.doc.cm;t&&i&&Zi(i,function(){var n=t.line,o=Je(t.line),s=Dr(i,o);if(s&&(Ir(s),i.curOp.selectionChanged=i.curOp.forceUpdate=!0),i.curOp.updateMaxLine=!0,!zt(r.doc,n)&&null!=r.height){var a=r.height;r.height=null;var l=br(r)-a;l&&Ze(n,n.height+l)}lr(i,"markerChanged",i,e)})},xo.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=N(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},xo.prototype.detachLine=function(e){if(this.lines.splice(N(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}},ye(xo);var Lo=function(e,t){this.markers=e,this.primary=t;for(var r=0;r<e.length;++r)e[r].parent=this};function ko(e){return e.findMarks(tt(e.first,0),e.clipPos(tt(e.lastLine())),function(e){return e.parent})}function To(e){for(var t=function(t){var r=e[t],i=[r.primary.doc];Rn(r.primary.doc,function(e){return i.push(e)});for(var n=0;n<r.markers.length;n++){var o=r.markers[n];-1==N(i,o.doc)&&(o.parent=null,r.markers.splice(n--,1))}},r=0;r<e.length;r++)t(r)}Lo.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();lr(this,"clear")}},Lo.prototype.find=function(e,t){return this.primary.find(e,t)},ye(Lo);var Ao=0,Eo=function(e,t,r,i,n){if(!(this instanceof Eo))return new Eo(e,t,r,i,n);null==r&&(r=0),yo.call(this,[new vo([new Xt("",null)])]),this.first=r,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=r;var o=tt(r,0);this.sel=xn(o),this.history=new Pn(null),this.id=++Ao,this.modeOption=t,this.lineSep=i,this.direction="rtl"==n?"rtl":"ltr",this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),Dn(this,{from:o,to:o,text:e}),Jn(this,xn(o),j)};Eo.prototype=$(yo.prototype,{constructor:Eo,iter:function(e,t,r){r?this.iterN(e-this.first,t-e,r):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var r=0,i=0;i<t.length;++i)r+=t[i].height;this.insertInner(e-this.first,t,r)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=qe(this,this.first,this.first+this.size);return!1===e?t:t.join(e||this.lineSeparator())},setValue:Qi(function(e){var t=tt(this.first,0),r=this.first+this.size-1;ao(this,{from:t,to:tt(r,Xe(this,r).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&Mi(this.cm,0,0),Jn(this,xn(t),j)}),replaceRange:function(e,t,r,i){t=lt(this,t),r=r?lt(this,r):t,fo(this,e,t,r,i)},getRange:function(e,t,r){var i=Ye(this,lt(this,e),lt(this,t));return!1===r?i:i.join(r||this.lineSeparator())},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){if(Qe(this,e))return Xe(this,e)},getLineNumber:function(e){return Je(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=Xe(this,e)),Wt(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return lt(this,e)},getCursor:function(e){var t=this.sel.primary();return null==e||"head"==e?t.head:"anchor"==e?t.anchor:"end"==e||"to"==e||!1===e?t.to():t.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Qi(function(e,t,r){qn(this,lt(this,"number"==typeof e?tt(e,t||0):e),null,r)}),setSelection:Qi(function(e,t,r){qn(this,lt(this,e),lt(this,t||e),r)}),extendSelection:Qi(function(e,t,r){Vn(this,lt(this,e),t&&lt(this,t),r)}),extendSelections:Qi(function(e,t){Xn(this,ct(this,e),t)}),extendSelectionsBy:Qi(function(e,t){var r=Z(this.sel.ranges,e);Xn(this,ct(this,r),t)}),setSelections:Qi(function(e,t,r){if(e.length){for(var i=[],n=0;n<e.length;n++)i[n]=new bn(lt(this,e[n].anchor),lt(this,e[n].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),Jn(this,wn(this.cm,i,t),r)}}),addSelection:Qi(function(e,t,r){var i=this.sel.ranges.slice(0);i.push(new bn(lt(this,e),lt(this,t||e))),Jn(this,wn(this.cm,i,i.length-1),r)}),getSelection:function(e){for(var t,r=this.sel.ranges,i=0;i<r.length;i++){var n=Ye(this,r[i].from(),r[i].to());t=t?t.concat(n):n}return!1===e?t:t.join(e||this.lineSeparator())},getSelections:function(e){for(var t=[],r=this.sel.ranges,i=0;i<r.length;i++){var n=Ye(this,r[i].from(),r[i].to());!1!==e&&(n=n.join(e||this.lineSeparator())),t[i]=n}return t},replaceSelection:function(e,t,r){for(var i=[],n=0;n<this.sel.ranges.length;n++)i[n]=e;this.replaceSelections(i,t,r||"+input")},replaceSelections:Qi(function(e,t,r){for(var i=[],n=this.sel,o=0;o<n.ranges.length;o++){var s=n.ranges[o];i[o]={from:s.from(),to:s.to(),text:this.splitLines(e[o]),origin:r}}for(var a=t&&"end"!=t&&function(e,t,r){for(var i=[],n=tt(e.first,0),o=n,s=0;s<t.length;s++){var a=t[s],l=Tn(a.from,n,o),c=Tn(Sn(a),n,o);if(n=a.to,o=c,"around"==r){var h=e.sel.ranges[s],u=rt(h.head,h.anchor)<0;i[s]=new bn(u?c:l,u?l:c)}else i[s]=new bn(l,l)}return new Cn(i,e.sel.primIndex)}(this,i,t),l=i.length-1;l>=0;l--)ao(this,i[l]);a?Zn(this,a):this.cm&&Ei(this.cm)}),undo:Qi(function(){co(this,"undo")}),redo:Qi(function(){co(this,"redo")}),undoSelection:Qi(function(){co(this,"undo",!0)}),redoSelection:Qi(function(){co(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,r=0,i=0;i<e.done.length;i++)e.done[i].ranges||++t;for(var n=0;n<e.undone.length;n++)e.undone[n].ranges||++r;return{undo:t,redo:r}},clearHistory:function(){this.history=new Pn(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Kn(this.history.done),undone:Kn(this.history.undone)}},setHistory:function(e){var t=this.history=new Pn(this.history.maxGeneration);t.done=Kn(e.done.slice(0),null,!0),t.undone=Kn(e.undone.slice(0),null,!0)},setGutterMarker:Qi(function(e,t,r){return _o(this,e,"gutter",function(e){var i=e.gutterMarkers||(e.gutterMarkers={});return i[t]=r,!r&&re(i)&&(e.gutterMarkers=null),!0})}),clearGutter:Qi(function(e){var t=this;this.iter(function(r){r.gutterMarkers&&r.gutterMarkers[e]&&_o(t,r,"gutter",function(){return r.gutterMarkers[e]=null,re(r.gutterMarkers)&&(r.gutterMarkers=null),!0})})}),lineInfo:function(e){var t;if("number"==typeof e){if(!Qe(this,e))return null;if(t=e,!(e=Xe(this,e)))return null}else if(null==(t=Je(e)))return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:Qi(function(e,t,r){return _o(this,e,"gutter"==t?"gutter":"class",function(e){var i="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass";if(e[i]){if(S(r).test(e[i]))return!1;e[i]+=" "+r}else e[i]=r;return!0})}),removeLineClass:Qi(function(e,t,r){return _o(this,e,"gutter"==t?"gutter":"class",function(e){var i="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass",n=e[i];if(!n)return!1;if(null==r)e[i]=null;else{var o=n.match(S(r));if(!o)return!1;var s=o.index+o[0].length;e[i]=n.slice(0,o.index)+(o.index&&s!=n.length?" ":"")+n.slice(s)||null}return!0})}),addLineWidget:Qi(function(e,t,r){return function(e,t,r,i){var n=new Co(e,r,i),o=e.cm;return o&&n.noHScroll&&(o.display.alignWidgets=!0),_o(e,t,"widget",function(t){var r=t.widgets||(t.widgets=[]);if(null==n.insertAt?r.push(n):r.splice(Math.min(r.length-1,Math.max(0,n.insertAt)),0,n),n.line=t,o&&!zt(e,t)){var i=Kt(t)<e.scrollTop;Ze(t,t.height+br(n)),i&&Ai(o,n.height),o.curOp.forceUpdate=!0}return!0}),o&&lr(o,"lineWidgetAdded",o,n,"number"==typeof t?t:Je(t)),n}(this,e,t,r)}),removeLineWidget:function(e){e.clear()},markText:function(e,t,r){return So(this,lt(this,e),lt(this,t),r,r&&r.type||"range")},setBookmark:function(e,t){var r={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return So(this,e=lt(this,e),e,r,"bookmark")},findMarksAt:function(e){e=lt(this,e);var t=[],r=Xe(this,e.line).markedSpans;if(r)for(var i=0;i<r.length;++i){var n=r[i];(null==n.from||n.from<=e.ch)&&(null==n.to||n.to>=e.ch)&&t.push(n.marker.parent||n.marker)}return t},findMarks:function(e,t,r){e=lt(this,e),t=lt(this,t);var i=[],n=e.line;return this.iter(e.line,t.line+1,function(o){var s=o.markedSpans;if(s)for(var a=0;a<s.length;a++){var l=s[a];null!=l.to&&n==e.line&&e.ch>=l.to||null==l.from&&n!=e.line||null!=l.from&&n==t.line&&l.from>=t.ch||r&&!r(l.marker)||i.push(l.marker.parent||l.marker)}++n}),i},getAllMarks:function(){var e=[];return this.iter(function(t){var r=t.markedSpans;if(r)for(var i=0;i<r.length;++i)null!=r[i].from&&e.push(r[i].marker)}),e},posFromIndex:function(e){var t,r=this.first,i=this.lineSeparator().length;return this.iter(function(n){var o=n.text.length+i;if(o>e)return t=e,!0;e-=o,++r}),lt(this,tt(r,t))},indexFromPos:function(e){var t=(e=lt(this,e)).ch;if(e.line<this.first||e.ch<0)return 0;var r=this.lineSeparator().length;return this.iter(this.first,e.line,function(e){t+=e.text.length+r}),t},copy:function(e){var t=new Eo(qe(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,r=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<r&&(r=e.to);var i=new Eo(qe(this,t,r),e.mode||this.modeOption,t,this.lineSep,this.direction);return e.sharedHist&&(i.history=this.history),(this.linked||(this.linked=[])).push({doc:i,sharedHist:e.sharedHist}),i.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],function(e,t){for(var r=0;r<t.length;r++){var i=t[r],n=i.find(),o=e.clipPos(n.from),s=e.clipPos(n.to);if(rt(o,s)){var a=So(e,o,s,i.primary,i.primary.type);i.markers.push(a),a.parent=i}}}(i,ko(this)),i},unlinkDoc:function(e){if(e instanceof Ls&&(e=e.doc),this.linked)for(var t=0;t<this.linked.length;++t){var r=this.linked[t];if(r.doc==e){this.linked.splice(t,1),e.unlinkDoc(this),To(ko(this));break}}if(e.history==this.history){var i=[e.id];Rn(e,function(e){return i.push(e.id)},!0),e.history=new Pn(null),e.history.done=Kn(this.history.done,i),e.history.undone=Kn(this.history.undone,i)}},iterLinkedDocs:function(e){Rn(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):Re(e)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:Qi(function(e){var t;"rtl"!=e&&(e="ltr"),e!=this.direction&&(this.direction=e,this.iter(function(e){return e.order=null}),this.cm&&Zi(t=this.cm,function(){Hn(t),ci(t)}))})}),Eo.prototype.eachLine=Eo.prototype.iter;var Mo=0;function Do(e){var t=this;if(Ro(t),!ge(t,e)&&!wr(t.display,e)){Ce(e),s&&(Mo=+new Date);var r=ai(t,e,!0),i=e.dataTransfer.files;if(r&&!t.isReadOnly())if(i&&i.length&&window.FileReader&&window.File)for(var n=i.length,o=Array(n),a=0,l=function(e,i){if(!t.options.allowDropFileTypes||-1!=N(t.options.allowDropFileTypes,e.type)){var s=new FileReader;s.onload=Ji(t,function(){var e=s.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(e)&&(e=""),o[i]=e,++a==n){var l={from:r=lt(t.doc,r),to:r,text:t.doc.splitLines(o.join(t.doc.lineSeparator())),origin:"paste"};ao(t.doc,l),Zn(t.doc,xn(r,Sn(l)))}}),s.readAsText(e)}},c=0;c<n;++c)l(i[c],c);else{if(t.state.draggingText&&t.doc.sel.contains(r)>-1)return t.state.draggingText(e),void setTimeout(function(){return t.display.input.focus()},20);try{var h=e.dataTransfer.getData("Text");if(h){var u;if(t.state.draggingText&&!t.state.draggingText.copy&&(u=t.listSelections()),$n(t.doc,xn(r,r)),u)for(var f=0;f<u.length;++f)fo(t.doc,"",u[f].anchor,u[f].head,"drag");t.replaceSelection(h,"around","paste"),t.display.input.focus()}}catch(e){}}}}function Ro(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function Oo(e){if(document.getElementsByClassName){for(var t=document.getElementsByClassName("CodeMirror"),r=[],i=0;i<t.length;i++){var n=t[i].CodeMirror;n&&r.push(n)}r.length&&r[0].operation(function(){for(var t=0;t<r.length;t++)e(r[t])})}}var Ho=!1;function Po(){var e;Ho||(fe(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,Oo(Bo)},100))}),fe(window,"blur",function(){return Oo(xi)}),Ho=!0)}function Bo(e){var t=e.display;t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize()}for(var Fo={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},Io=0;Io<10;Io++)Fo[Io+48]=Fo[Io+96]=String(Io);for(var Wo=65;Wo<=90;Wo++)Fo[Wo]=String.fromCharCode(Wo);for(var No=1;No<=12;No++)Fo[No+111]=Fo[No+63235]="F"+No;var Uo={};function zo(e){var t,r,i,n,o=e.split(/-(?!$)/);e=o[o.length-1];for(var s=0;s<o.length-1;s++){var a=o[s];if(/^(cmd|meta|m)$/i.test(a))n=!0;else if(/^a(lt)?$/i.test(a))t=!0;else if(/^(c|ctrl|control)$/i.test(a))r=!0;else{if(!/^s(hift)?$/i.test(a))throw new Error("Unrecognized modifier name: "+a);i=!0}}return t&&(e="Alt-"+e),r&&(e="Ctrl-"+e),n&&(e="Cmd-"+e),i&&(e="Shift-"+e),e}function jo(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];if(/^(name|fallthrough|(de|at)tach)$/.test(r))continue;if("..."==i){delete e[r];continue}for(var n=Z(r.split(" "),zo),o=0;o<n.length;o++){var s=void 0,a=void 0;o==n.length-1?(a=n.join(" "),s=i):(a=n.slice(0,o+1).join(" "),s="...");var l=t[a];if(l){if(l!=s)throw new Error("Inconsistent bindings for "+a)}else t[a]=s}delete e[r]}for(var c in t)e[c]=t[c];return e}function Ko(e,t,r,i){var n=(t=Yo(t)).call?t.call(e,i):t[e];if(!1===n)return"nothing";if("..."===n)return"multi";if(null!=n&&r(n))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return Ko(e,t.fallthrough,r,i);for(var o=0;o<t.fallthrough.length;o++){var s=Ko(e,t.fallthrough[o],r,i);if(s)return s}}}function Go(e){var t="string"==typeof e?e:Fo[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t}function Vo(e,t,r){var i=e;return t.altKey&&"Alt"!=i&&(e="Alt-"+e),(w?t.metaKey:t.ctrlKey)&&"Ctrl"!=i&&(e="Ctrl-"+e),(w?t.ctrlKey:t.metaKey)&&"Cmd"!=i&&(e="Cmd-"+e),!r&&t.shiftKey&&"Shift"!=i&&(e="Shift-"+e),e}function Xo(e,t){if(u&&34==e.keyCode&&e.char)return!1;var r=Fo[e.keyCode];return null!=r&&!e.altGraphKey&&(3==e.keyCode&&e.code&&(r=e.code),Vo(r,e,t))}function Yo(e){return"string"==typeof e?Uo[e]:e}function qo(e,t){for(var r=e.doc.sel.ranges,i=[],n=0;n<r.length;n++){for(var o=t(r[n]);i.length&&rt(o.from,q(i).to)<=0;){var s=i.pop();if(rt(s.from,o.from)<0){o.from=s.from;break}}i.push(o)}Zi(e,function(){for(var t=i.length-1;t>=0;t--)fo(e.doc,"",i[t].from,i[t].to,"+delete");Ei(e)})}function Zo(e,t,r){var i=oe(e.text,t+r,r);return i<0||i>e.text.length?null:i}function Jo(e,t,r){var i=Zo(e,t.ch,r);return null==i?null:new tt(t.line,i,r<0?"after":"before")}function $o(e,t,r,i,n){if(e){var o=he(r,t.doc.direction);if(o){var s,a=n<0?q(o):o[0],l=n<0==(1==a.level),c=l?"after":"before";if(a.level>0||"rtl"==t.doc.direction){var h=Rr(t,r);s=n<0?r.text.length-1:0;var u=Or(t,h,s).top;s=se(function(e){return Or(t,h,e).top==u},n<0==(1==a.level)?a.from:a.to-1,s),"before"==c&&(s=Zo(r,s,1))}else s=n<0?a.to:a.from;return new tt(i,s,c)}}return new tt(i,n<0?r.text.length:0,n<0?"before":"after")}Uo.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},Uo.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},Uo.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},Uo.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},Uo.default=v?Uo.macDefault:Uo.pcDefault;var Qo={selectAll:oo,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),j)},killLine:function(e){return qo(e,function(t){if(t.empty()){var r=Xe(e.doc,t.head.line).text.length;return t.head.ch==r&&t.head.line<e.lastLine()?{from:t.head,to:tt(t.head.line+1,0)}:{from:t.head,to:tt(t.head.line,r)}}return{from:t.from(),to:t.to()}})},deleteLine:function(e){return qo(e,function(t){return{from:tt(t.from().line,0),to:lt(e.doc,tt(t.to().line+1,0))}})},delLineLeft:function(e){return qo(e,function(e){return{from:tt(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(e){return qo(e,function(t){var r=e.charCoords(t.head,"div").top+5,i=e.coordsChar({left:0,top:r},"div");return{from:i,to:t.from()}})},delWrappedLineRight:function(e){return qo(e,function(t){var r=e.charCoords(t.head,"div").top+5,i=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:r},"div");return{from:t.from(),to:i}})},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(tt(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(tt(e.lastLine()))},goLineStart:function(e){return e.extendSelectionsBy(function(t){return es(e,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){return e.extendSelectionsBy(function(t){return ts(e,t.head)},{origin:"+move",bias:1})},goLineEnd:function(e){return e.extendSelectionsBy(function(t){return function(e,t){var r=Xe(e.doc,t),i=function(e){for(var t;t=Bt(e);)e=t.find(1,!0).line;return e}(r);return i!=r&&(t=Je(i)),$o(!0,e,r,t,-1)}(e,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){return e.extendSelectionsBy(function(t){var r=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:r},"div")},G)},goLineLeft:function(e){return e.extendSelectionsBy(function(t){var r=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:r},"div")},G)},goLineLeftSmart:function(e){return e.extendSelectionsBy(function(t){var r=e.cursorCoords(t.head,"div").top+5,i=e.coordsChar({left:0,top:r},"div");return i.ch<e.getLine(i.line).search(/\S/)?ts(e,t.head):i},G)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"char")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("\t")},insertSoftTab:function(e){for(var t=[],r=e.listSelections(),i=e.options.tabSize,n=0;n<r.length;n++){var o=r[n].from(),s=I(e.getLine(o.line),o.ch,i);t.push(Y(i-s%i))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){return Zi(e,function(){for(var t=e.listSelections(),r=[],i=0;i<t.length;i++)if(t[i].empty()){var n=t[i].head,o=Xe(e.doc,n.line).text;if(o)if(n.ch==o.length&&(n=new tt(n.line,n.ch-1)),n.ch>0)n=new tt(n.line,n.ch+1),e.replaceRange(o.charAt(n.ch-1)+o.charAt(n.ch-2),tt(n.line,n.ch-2),n,"+transpose");else if(n.line>e.doc.first){var s=Xe(e.doc,n.line-1).text;s&&(n=new tt(n.line,1),e.replaceRange(o.charAt(0)+e.doc.lineSeparator()+s.charAt(s.length-1),tt(n.line-1,s.length-1),n,"+transpose"))}r.push(new bn(n,n))}e.setSelections(r)})},newlineAndIndent:function(e){return Zi(e,function(){for(var t=e.listSelections(),r=t.length-1;r>=0;r--)e.replaceRange(e.doc.lineSeparator(),t[r].anchor,t[r].head,"+input");t=e.listSelections();for(var i=0;i<t.length;i++)e.indentLine(t[i].from().line,null,!0);Ei(e)})},openLine:function(e){return e.replaceSelection("\n","start")},toggleOverwrite:function(e){return e.toggleOverwrite()}};function es(e,t){var r=Xe(e.doc,t),i=Wt(r);return i!=r&&(t=Je(i)),$o(!0,e,i,t,1)}function ts(e,t){var r=es(e,t.line),i=Xe(e.doc,r.line),n=he(i,e.doc.direction);if(!n||0==n[0].level){var o=Math.max(0,i.text.search(/\S/)),s=t.line==r.line&&t.ch<=o&&t.ch;return tt(r.line,s?0:o,r.sticky)}return r}function rs(e,t,r){if("string"==typeof t&&!(t=Qo[t]))return!1;e.display.input.ensurePolled();var i=e.display.shift,n=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),r&&(e.display.shift=!1),n=t(e)!=z}finally{e.display.shift=i,e.state.suppressEdits=!1}return n}var is=new W;function ns(e,t,r,i){var n=e.state.keySeq;if(n){if(Go(t))return"handled";if(/\'$/.test(t)?e.state.keySeq=null:is.set(50,function(){e.state.keySeq==n&&(e.state.keySeq=null,e.display.input.reset())}),os(e,n+" "+t,r,i))return!0}return os(e,t,r,i)}function os(e,t,r,i){var n=function(e,t,r){for(var i=0;i<e.state.keyMaps.length;i++){var n=Ko(t,e.state.keyMaps[i],r,e);if(n)return n}return e.options.extraKeys&&Ko(t,e.options.extraKeys,r,e)||Ko(t,e.options.keyMap,r,e)}(e,t,i);return"multi"==n&&(e.state.keySeq=t),"handled"==n&&lr(e,"keyHandled",e,t,r),"handled"!=n&&"multi"!=n||(Ce(r),yi(e)),!!n}function ss(e,t){var r=Xo(t,!0);return!!r&&(t.shiftKey&&!e.state.keySeq?ns(e,"Shift-"+r,t,function(t){return rs(e,t,!0)})||ns(e,r,t,function(t){if("string"==typeof t?/^go[A-Z]/.test(t):t.motion)return rs(e,t)}):ns(e,r,t,function(t){return rs(e,t)}))}var as=null;function ls(e){var t=this;if(t.curOp.focus=R(),!ge(t,e)){s&&a<11&&27==e.keyCode&&(e.returnValue=!1);var r=e.keyCode;t.display.shift=16==r||e.shiftKey;var i=ss(t,e);u&&(as=i?r:null,!i&&88==r&&!He&&(v?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),18!=r||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||function(e){var t=e.display.lineDiv;function r(e){18!=e.keyCode&&e.altKey||(k(t,"CodeMirror-crosshair"),pe(document,"keyup",r),pe(document,"mouseover",r))}O(t,"CodeMirror-crosshair"),fe(document,"keyup",r),fe(document,"mouseover",r)}(t)}}function cs(e){16==e.keyCode&&(this.doc.sel.shift=!1),ge(this,e)}function hs(e){var t=this;if(!(wr(t.display,e)||ge(t,e)||e.ctrlKey&&!e.altKey||v&&e.metaKey)){var r=e.keyCode,i=e.charCode;if(u&&r==as)return as=null,void Ce(e);if(!u||e.which&&!(e.which<10)||!ss(t,e)){var n=String.fromCharCode(null==i?r:i);"\b"!=n&&(function(e,t,r){return ns(e,"'"+r+"'",t,function(t){return rs(e,t,!0)})}(t,e,n)||t.display.input.onKeyPress(e))}}}var us,fs,ds=function(e,t,r){this.time=e,this.pos=t,this.button=r};function ps(e){var t=this,r=t.display;if(!(ge(t,e)||r.activeTouch&&r.input.supportsTouch()))if(r.input.ensurePolled(),r.shift=e.shiftKey,wr(r,e))l||(r.scroller.draggable=!1,setTimeout(function(){return r.scroller.draggable=!0},100));else if(!_s(t,e)){var i=ai(t,e),n=Le(e),o=i?function(e,t){var r=+new Date;return fs&&fs.compare(r,e,t)?(us=fs=null,"triple"):us&&us.compare(r,e,t)?(fs=new ds(r,e,t),us=null,"double"):(us=new ds(r,e,t),fs=null,"single")}(i,n):"single";window.focus(),1==n&&t.state.selectingText&&t.state.selectingText(e),i&&function(e,t,r,i,n){var o="Click";return"double"==i?o="Double"+o:"triple"==i&&(o="Triple"+o),ns(e,Vo(o=(1==t?"Left":2==t?"Middle":"Right")+o,n),n,function(t){if("string"==typeof t&&(t=Qo[t]),!t)return!1;var i=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),i=t(e,r)!=z}finally{e.state.suppressEdits=!1}return i})}(t,n,i,o,e)||(1==n?i?function(e,t,r,i){s?setTimeout(B(Ci,e),0):e.curOp.focus=R();var n,o=function(e,t,r){var i=e.getOption("configureMouse"),n=i?i(e,t,r):{};if(null==n.unit){var o=y?r.shiftKey&&r.metaKey:r.altKey;n.unit=o?"rectangle":"single"==t?"char":"double"==t?"word":"line"}return(null==n.extend||e.doc.extend)&&(n.extend=e.doc.extend||r.shiftKey),null==n.addNew&&(n.addNew=v?r.metaKey:r.ctrlKey),null==n.moveOnDrag&&(n.moveOnDrag=!(v?r.altKey:r.ctrlKey)),n}(e,r,i),c=e.doc.sel;e.options.dragDrop&&Ae&&!e.isReadOnly()&&"single"==r&&(n=c.contains(t))>-1&&(rt((n=c.ranges[n]).from(),t)<0||t.xRel>0)&&(rt(n.to(),t)>0||t.xRel<0)?function(e,t,r,i){var n=e.display,o=!1,c=Ji(e,function(t){l&&(n.scroller.draggable=!1),e.state.draggingText=!1,pe(n.wrapper.ownerDocument,"mouseup",c),pe(n.wrapper.ownerDocument,"mousemove",h),pe(n.scroller,"dragstart",u),pe(n.scroller,"drop",c),o||(Ce(t),i.addNew||Vn(e.doc,r,null,null,i.extend),l||s&&9==a?setTimeout(function(){n.wrapper.ownerDocument.body.focus(),n.input.focus()},20):n.input.focus())}),h=function(e){o=o||Math.abs(t.clientX-e.clientX)+Math.abs(t.clientY-e.clientY)>=10},u=function(){return o=!0};l&&(n.scroller.draggable=!0),e.state.draggingText=c,c.copy=!i.moveOnDrag,n.scroller.dragDrop&&n.scroller.dragDrop(),fe(n.wrapper.ownerDocument,"mouseup",c),fe(n.wrapper.ownerDocument,"mousemove",h),fe(n.scroller,"dragstart",u),fe(n.scroller,"drop",c),bi(e),setTimeout(function(){return n.input.focus()},20)}(e,i,t,o):function(e,t,r,i){var n=e.display,o=e.doc;Ce(t);var s,a,l=o.sel,c=l.ranges;if(i.addNew&&!i.extend?(a=o.sel.contains(r),s=a>-1?c[a]:new bn(r,r)):(s=o.sel.primary(),a=o.sel.primIndex),"rectangle"==i.unit)i.addNew||(s=new bn(r,r)),r=ai(e,t,!0,!0),a=-1;else{var h=ms(e,r,i.unit);s=i.extend?Gn(s,h.anchor,h.head,i.extend):h}i.addNew?-1==a?(a=c.length,Jn(o,wn(e,c.concat([s]),a),{scroll:!1,origin:"*mouse"})):c.length>1&&c[a].empty()&&"char"==i.unit&&!i.extend?(Jn(o,wn(e,c.slice(0,a).concat(c.slice(a+1)),0),{scroll:!1,origin:"*mouse"}),l=o.sel):Yn(o,a,s,K):(a=0,Jn(o,new Cn([s],0),K),l=o.sel);var u=r;function f(t){if(0!=rt(u,t))if(u=t,"rectangle"==i.unit){for(var n=[],c=e.options.tabSize,h=I(Xe(o,r.line).text,r.ch,c),f=I(Xe(o,t.line).text,t.ch,c),d=Math.min(h,f),p=Math.max(h,f),m=Math.min(r.line,t.line),g=Math.min(e.lastLine(),Math.max(r.line,t.line));m<=g;m++){var _=Xe(o,m).text,v=V(_,d,c);d==p?n.push(new bn(tt(m,v),tt(m,v))):_.length>v&&n.push(new bn(tt(m,v),tt(m,V(_,p,c))))}n.length||n.push(new bn(r,r)),Jn(o,wn(e,l.ranges.slice(0,a).concat(n),a),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var y,C=s,b=ms(e,t,i.unit),w=C.anchor;rt(b.anchor,w)>0?(y=b.head,w=st(C.from(),b.anchor)):(y=b.anchor,w=ot(C.to(),b.head));var x=l.ranges.slice(0);x[a]=function(e,t){var r=t.anchor,i=t.head,n=Xe(e.doc,r.line);if(0==rt(r,i)&&r.sticky==i.sticky)return t;var o=he(n);if(!o)return t;var s=le(o,r.ch,r.sticky),a=o[s];if(a.from!=r.ch&&a.to!=r.ch)return t;var l,c=s+(a.from==r.ch==(1!=a.level)?0:1);if(0==c||c==o.length)return t;if(i.line!=r.line)l=(i.line-r.line)*("ltr"==e.doc.direction?1:-1)>0;else{var h=le(o,i.ch,i.sticky),u=h-s||(i.ch-r.ch)*(1==a.level?-1:1);l=h==c-1||h==c?u<0:u>0}var f=o[c+(l?-1:0)],d=l==(1==f.level),p=d?f.from:f.to,m=d?"after":"before";return r.ch==p&&r.sticky==m?t:new bn(new tt(r.line,p,m),i)}(e,new bn(lt(o,w),y)),Jn(o,wn(e,x,a),K)}}var d=n.wrapper.getBoundingClientRect(),p=0;function m(t){e.state.selectingText=!1,p=1/0,t&&(Ce(t),n.input.focus()),pe(n.wrapper.ownerDocument,"mousemove",g),pe(n.wrapper.ownerDocument,"mouseup",_),o.history.lastSelOrigin=null}var g=Ji(e,function(t){0!==t.buttons&&Le(t)?function t(r){var s=++p,a=ai(e,r,!0,"rectangle"==i.unit);if(a)if(0!=rt(a,u)){e.curOp.focus=R(),f(a);var l=ki(n,o);(a.line>=l.to||a.line<l.from)&&setTimeout(Ji(e,function(){p==s&&t(r)}),150)}else{var c=r.clientY<d.top?-20:r.clientY>d.bottom?20:0;c&&setTimeout(Ji(e,function(){p==s&&(n.scroller.scrollTop+=c,t(r))}),50)}}(t):m(t)}),_=Ji(e,m);e.state.selectingText=_,fe(n.wrapper.ownerDocument,"mousemove",g),fe(n.wrapper.ownerDocument,"mouseup",_)}(e,i,t,o)}(t,i,o,e):Se(e)==r.scroller&&Ce(e):2==n?(i&&Vn(t.doc,i),setTimeout(function(){return r.input.focus()},20)):3==n&&(x?t.display.input.onContextMenu(e):bi(t)))}}function ms(e,t,r){if("char"==r)return new bn(t,t);if("word"==r)return e.findWordAt(t);if("line"==r)return new bn(tt(t.line,0),lt(e.doc,tt(t.line+1,0)));var i=r(e,t);return new bn(i.from,i.to)}function gs(e,t,r,i){var n,o;if(t.touches)n=t.touches[0].clientX,o=t.touches[0].clientY;else try{n=t.clientX,o=t.clientY}catch(t){return!1}if(n>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;i&&Ce(t);var s=e.display,a=s.lineDiv.getBoundingClientRect();if(o>a.bottom||!ve(e,r))return we(t);o-=a.top-s.viewOffset;for(var l=0;l<e.display.gutterSpecs.length;++l){var c=s.gutters.childNodes[l];if(c&&c.getBoundingClientRect().right>=n){var h=$e(e.doc,o),u=e.display.gutterSpecs[l];return me(e,r,e,h,u.className,t),we(t)}}}function _s(e,t){return gs(e,t,"gutterClick",!0)}function vs(e,t){wr(e.display,t)||function(e,t){return!!ve(e,"gutterContextMenu")&&gs(e,t,"gutterContextMenu",!1)}(e,t)||ge(e,t,"contextmenu")||x||e.display.input.onContextMenu(t)}function ys(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Nr(e)}ds.prototype.compare=function(e,t,r){return this.time+400>e&&0==rt(t,this.pos)&&r==this.button};var Cs={toString:function(){return"CodeMirror.Init"}},bs={},ws={};function xs(e,t,r){var i=r&&r!=Cs;if(!t!=!i){var n=e.display.dragFunctions,o=t?fe:pe;o(e.display.scroller,"dragstart",n.start),o(e.display.scroller,"dragenter",n.enter),o(e.display.scroller,"dragover",n.over),o(e.display.scroller,"dragleave",n.leave),o(e.display.scroller,"drop",n.drop)}}function Ss(e){e.options.lineWrapping?(O(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(k(e.display.wrapper,"CodeMirror-wrap"),Vt(e)),si(e),ci(e),Nr(e),setTimeout(function(){return Wi(e)},100)}function Ls(e,t){var r=this;if(!(this instanceof Ls))return new Ls(e,t);this.options=t=t?F(t):{},F(bs,t,!1);var i=t.value;"string"==typeof i?i=new Eo(i,t.mode,null,t.lineSeparator,t.direction):t.mode&&(i.modeOption=t.mode),this.doc=i;var n=new Ls.inputStyles[t.inputStyle](this),o=this.display=new pn(e,i,n,t);for(var c in o.wrapper.CodeMirror=this,ys(this),t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),zi(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new W,keySeq:null,specialChars:null},t.autofocus&&!_&&o.input.focus(),s&&a<11&&setTimeout(function(){return r.display.input.reset(!0)},20),function(e){var t=e.display;fe(t.scroller,"mousedown",Ji(e,ps)),fe(t.scroller,"dblclick",s&&a<11?Ji(e,function(t){if(!ge(e,t)){var r=ai(e,t);if(r&&!_s(e,t)&&!wr(e.display,t)){Ce(t);var i=e.findWordAt(r);Vn(e.doc,i.anchor,i.head)}}}):function(t){return ge(e,t)||Ce(t)}),fe(t.scroller,"contextmenu",function(t){return vs(e,t)});var r,i={end:0};function n(){t.activeTouch&&(r=setTimeout(function(){return t.activeTouch=null},1e3),(i=t.activeTouch).end=+new Date)}function o(e,t){if(null==t.left)return!0;var r=t.left-e.left,i=t.top-e.top;return r*r+i*i>400}fe(t.scroller,"touchstart",function(n){if(!ge(e,n)&&!function(e){if(1!=e.touches.length)return!1;var t=e.touches[0];return t.radiusX<=1&&t.radiusY<=1}(n)&&!_s(e,n)){t.input.ensurePolled(),clearTimeout(r);var o=+new Date;t.activeTouch={start:o,moved:!1,prev:o-i.end<=300?i:null},1==n.touches.length&&(t.activeTouch.left=n.touches[0].pageX,t.activeTouch.top=n.touches[0].pageY)}}),fe(t.scroller,"touchmove",function(){t.activeTouch&&(t.activeTouch.moved=!0)}),fe(t.scroller,"touchend",function(r){var i=t.activeTouch;if(i&&!wr(t,r)&&null!=i.left&&!i.moved&&new Date-i.start<300){var s,a=e.coordsChar(t.activeTouch,"page");s=!i.prev||o(i,i.prev)?new bn(a,a):!i.prev.prev||o(i,i.prev.prev)?e.findWordAt(a):new bn(tt(a.line,0),lt(e.doc,tt(a.line+1,0))),e.setSelection(s.anchor,s.head),e.focus(),Ce(r)}n()}),fe(t.scroller,"touchcancel",n),fe(t.scroller,"scroll",function(){t.scroller.clientHeight&&(Oi(e,t.scroller.scrollTop),Pi(e,t.scroller.scrollLeft,!0),me(e,"scroll",e))}),fe(t.scroller,"mousewheel",function(t){return yn(e,t)}),fe(t.scroller,"DOMMouseScroll",function(t){return yn(e,t)}),fe(t.wrapper,"scroll",function(){return t.wrapper.scrollTop=t.wrapper.scrollLeft=0}),t.dragFunctions={enter:function(t){ge(e,t)||xe(t)},over:function(t){ge(e,t)||(function(e,t){var r=ai(e,t);if(r){var i=document.createDocumentFragment();gi(e,r,i),e.display.dragCursor||(e.display.dragCursor=E("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),A(e.display.dragCursor,i)}}(e,t),xe(t))},start:function(t){return function(e,t){if(s&&(!e.state.draggingText||+new Date-Mo<100))xe(t);else if(!ge(e,t)&&!wr(e.display,t)&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setDragImage&&!f)){var r=E("img",null,null,"position: fixed; left: 0; top: 0;");r.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",u&&(r.width=r.height=1,e.display.wrapper.appendChild(r),r._top=r.offsetTop),t.dataTransfer.setDragImage(r,0,0),u&&r.parentNode.removeChild(r)}}(e,t)},drop:Ji(e,Do),leave:function(t){ge(e,t)||Ro(e)}};var l=t.input.getField();fe(l,"keyup",function(t){return cs.call(e,t)}),fe(l,"keydown",Ji(e,ls)),fe(l,"keypress",Ji(e,hs)),fe(l,"focus",function(t){return wi(e,t)}),fe(l,"blur",function(t){return xi(e,t)})}(this),Po(),Ki(this),this.curOp.forceUpdate=!0,On(this,i),t.autofocus&&!_||this.hasFocus()?setTimeout(B(wi,this),20):xi(this),ws)ws.hasOwnProperty(c)&&ws[c](r,t[c],Cs);hn(this),t.finishInit&&t.finishInit(this);for(var h=0;h<ks.length;++h)ks[h](r);Gi(this),l&&t.lineWrapping&&"optimizelegibility"==getComputedStyle(o.lineDiv).textRendering&&(o.lineDiv.style.textRendering="auto")}Ls.defaults=bs,Ls.optionHandlers=ws;var ks=[];function Ts(e,t,r,i){var n,o=e.doc;null==r&&(r="add"),"smart"==r&&(o.mode.indent?n=pt(e,t).state:r="prev");var s=e.options.tabSize,a=Xe(o,t),l=I(a.text,null,s);a.stateAfter&&(a.stateAfter=null);var c,h=a.text.match(/^\s*/)[0];if(i||/\S/.test(a.text)){if("smart"==r&&((c=o.mode.indent(n,a.text.slice(h.length),a.text))==z||c>150)){if(!i)return;r="prev"}}else c=0,r="not";"prev"==r?c=t>o.first?I(Xe(o,t-1).text,null,s):0:"add"==r?c=l+e.options.indentUnit:"subtract"==r?c=l-e.options.indentUnit:"number"==typeof r&&(c=l+r),c=Math.max(0,c);var u="",f=0;if(e.options.indentWithTabs)for(var d=Math.floor(c/s);d;--d)f+=s,u+="\t";if(f<c&&(u+=Y(c-f)),u!=h)return fo(o,u,tt(t,0),tt(t,h.length),"+input"),a.stateAfter=null,!0;for(var p=0;p<o.sel.ranges.length;p++){var m=o.sel.ranges[p];if(m.head.line==t&&m.head.ch<h.length){var g=tt(t,h.length);Yn(o,p,new bn(g,g));break}}}Ls.defineInitHook=function(e){return ks.push(e)};var As=null;function Es(e){As=e}function Ms(e,t,r,i,n){var o=e.doc;e.display.shift=!1,i||(i=o.sel);var s=+new Date-200,a="paste"==n||e.state.pasteIncoming>s,l=Re(t),c=null;if(a&&i.ranges.length>1)if(As&&As.text.join("\n")==t){if(i.ranges.length%As.text.length==0){c=[];for(var h=0;h<As.text.length;h++)c.push(o.splitLines(As.text[h]))}}else l.length==i.ranges.length&&e.options.pasteLinesPerSelection&&(c=Z(l,function(e){return[e]}));for(var u=e.curOp.updateInput,f=i.ranges.length-1;f>=0;f--){var d=i.ranges[f],p=d.from(),m=d.to();d.empty()&&(r&&r>0?p=tt(p.line,p.ch-r):e.state.overwrite&&!a?m=tt(m.line,Math.min(Xe(o,m.line).text.length,m.ch+q(l).length)):a&&As&&As.lineWise&&As.text.join("\n")==t&&(p=m=tt(p.line,0)));var g={from:p,to:m,text:c?c[f%c.length]:l,origin:n||(a?"paste":e.state.cutIncoming>s?"cut":"+input")};ao(e.doc,g),lr(e,"inputRead",e,g)}t&&!a&&Rs(e,t),Ei(e),e.curOp.updateInput<2&&(e.curOp.updateInput=u),e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=-1}function Ds(e,t){var r=e.clipboardData&&e.clipboardData.getData("Text");if(r)return e.preventDefault(),t.isReadOnly()||t.options.disableInput||Zi(t,function(){return Ms(t,r,0,null,"paste")}),!0}function Rs(e,t){if(e.options.electricChars&&e.options.smartIndent)for(var r=e.doc.sel,i=r.ranges.length-1;i>=0;i--){var n=r.ranges[i];if(!(n.head.ch>100||i&&r.ranges[i-1].head.line==n.head.line)){var o=e.getModeAt(n.head),s=!1;if(o.electricChars){for(var a=0;a<o.electricChars.length;a++)if(t.indexOf(o.electricChars.charAt(a))>-1){s=Ts(e,n.head.line,"smart");break}}else o.electricInput&&o.electricInput.test(Xe(e.doc,n.head.line).text.slice(0,n.head.ch))&&(s=Ts(e,n.head.line,"smart"));s&&lr(e,"electricInput",e,n.head.line)}}}function Os(e){for(var t=[],r=[],i=0;i<e.doc.sel.ranges.length;i++){var n=e.doc.sel.ranges[i].head.line,o={anchor:tt(n,0),head:tt(n+1,0)};r.push(o),t.push(e.getRange(o.anchor,o.head))}return{text:t,ranges:r}}function Hs(e,t,r,i){e.setAttribute("autocorrect",r?"":"off"),e.setAttribute("autocapitalize",i?"":"off"),e.setAttribute("spellcheck",!!t)}function Ps(){var e=E("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),t=E("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return l?e.style.width="1000px":e.setAttribute("wrap","off"),m&&(e.style.border="1px solid black"),Hs(e),t}function Bs(e,t,r,i,n){var o=t,s=r,a=Xe(e,t.line);function l(i){var o,s;if(null==(o=n?function(e,t,r,i){var n=he(t,e.doc.direction);if(!n)return Jo(t,r,i);r.ch>=t.text.length?(r.ch=t.text.length,r.sticky="before"):r.ch<=0&&(r.ch=0,r.sticky="after");var o=le(n,r.ch,r.sticky),s=n[o];if("ltr"==e.doc.direction&&s.level%2==0&&(i>0?s.to>r.ch:s.from<r.ch))return Jo(t,r,i);var a,l=function(e,r){return Zo(t,e instanceof tt?e.ch:e,r)},c=function(r){return e.options.lineWrapping?(a=a||Rr(e,t),$r(e,t,a,r)):{begin:0,end:t.text.length}},h=c("before"==r.sticky?l(r,-1):r.ch);if("rtl"==e.doc.direction||1==s.level){var u=1==s.level==i<0,f=l(r,u?1:-1);if(null!=f&&(u?f<=s.to&&f<=h.end:f>=s.from&&f>=h.begin)){var d=u?"before":"after";return new tt(r.line,f,d)}}var p=function(e,t,i){for(var o=function(e,t){return t?new tt(r.line,l(e,1),"before"):new tt(r.line,e,"after")};e>=0&&e<n.length;e+=t){var s=n[e],a=t>0==(1!=s.level),c=a?i.begin:l(i.end,-1);if(s.from<=c&&c<s.to)return o(c,a);if(c=a?s.from:l(s.to,-1),i.begin<=c&&c<i.end)return o(c,a)}},m=p(o+i,i,h);if(m)return m;var g=i>0?h.end:l(h.begin,-1);return null==g||i>0&&g==t.text.length||!(m=p(i>0?0:n.length-1,i,c(g)))?null:m}(e.cm,a,t,r):Jo(a,t,r))){if(i||((s=t.line+r)<e.first||s>=e.first+e.size||(t=new tt(s,t.ch,t.sticky),!(a=Xe(e,s)))))return!1;t=$o(n,e.cm,a,t.line,r)}else t=o;return!0}if("char"==i)l();else if("column"==i)l(!0);else if("word"==i||"group"==i)for(var c=null,h="group"==i,u=e.cm&&e.cm.getHelper(t,"wordChars"),f=!0;!(r<0)||l(!f);f=!1){var d=a.text.charAt(t.ch)||"\n",p=te(d,u)?"w":h&&"\n"==d?"n":!h||/\s/.test(d)?null:"p";if(!h||f||p||(p="s"),c&&c!=p){r<0&&(r=1,l(),t.sticky="after");break}if(p&&(c=p),r>0&&!l(!f))break}var m=io(e,t,o,s,!0);return it(o,m)&&(m.hitSide=!0),m}function Fs(e,t,r,i){var n,o,s=e.doc,a=t.left;if("page"==i){var l=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),c=Math.max(l-.5*ti(e.display),3);n=(r>0?t.bottom:t.top)+r*c}else"line"==i&&(n=r>0?t.bottom+3:t.top-3);for(;(o=Zr(e,a,n)).outside;){if(r<0?n<=0:n>=s.height){o.hitSide=!0;break}n+=5*r}return o}var Is=function(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new W,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};function Ws(e,t){var r=Dr(e,t.line);if(!r||r.hidden)return null;var i=Xe(e.doc,t.line),n=Er(r,i,t.line),o=he(i,e.doc.direction),s="left";if(o){var a=le(o,t.ch);s=a%2?"right":"left"}var l=Br(n.map,t.ch,s);return l.offset="right"==l.collapse?l.end:l.start,l}function Ns(e,t){return t&&(e.bad=!0),e}function Us(e,t,r){var i;if(t==e.display.lineDiv){if(!(i=e.display.lineDiv.childNodes[r]))return Ns(e.clipPos(tt(e.display.viewTo-1)),!0);t=null,r=0}else for(i=t;;i=i.parentNode){if(!i||i==e.display.lineDiv)return null;if(i.parentNode&&i.parentNode==e.display.lineDiv)break}for(var n=0;n<e.display.view.length;n++){var o=e.display.view[n];if(o.node==i)return zs(o,t,r)}}function zs(e,t,r){var i=e.text.firstChild,n=!1;if(!t||!D(i,t))return Ns(tt(Je(e.line),0),!0);if(t==i&&(n=!0,t=i.childNodes[r],r=0,!t)){var o=e.rest?q(e.rest):e.line;return Ns(tt(Je(o),o.text.length),n)}var s=3==t.nodeType?t:null,a=t;for(s||1!=t.childNodes.length||3!=t.firstChild.nodeType||(s=t.firstChild,r&&(r=s.nodeValue.length));a.parentNode!=i;)a=a.parentNode;var l=e.measure,c=l.maps;function h(t,r,i){for(var n=-1;n<(c?c.length:0);n++)for(var o=n<0?l.map:c[n],s=0;s<o.length;s+=3){var a=o[s+2];if(a==t||a==r){var h=Je(n<0?e.line:e.rest[n]),u=o[s]+i;return(i<0||a!=t)&&(u=o[s+(i?1:0)]),tt(h,u)}}}var u=h(s,a,r);if(u)return Ns(u,n);for(var f=a.nextSibling,d=s?s.nodeValue.length-r:0;f;f=f.nextSibling){if(u=h(f,f.firstChild,0))return Ns(tt(u.line,u.ch-d),n);d+=f.textContent.length}for(var p=a.previousSibling,m=r;p;p=p.previousSibling){if(u=h(p,p.firstChild,-1))return Ns(tt(u.line,u.ch+m),n);m+=p.textContent.length}}Is.prototype.init=function(e){var t=this,r=this,i=r.cm,n=r.div=e.lineDiv;function o(e){if(!ge(i,e)){if(i.somethingSelected())Es({lineWise:!1,text:i.getSelections()}),"cut"==e.type&&i.replaceSelection("",null,"cut");else{if(!i.options.lineWiseCopyCut)return;var t=Os(i);Es({lineWise:!0,text:t.text}),"cut"==e.type&&i.operation(function(){i.setSelections(t.ranges,0,j),i.replaceSelection("",null,"cut")})}if(e.clipboardData){e.clipboardData.clearData();var o=As.text.join("\n");if(e.clipboardData.setData("Text",o),e.clipboardData.getData("Text")==o)return void e.preventDefault()}var s=Ps(),a=s.firstChild;i.display.lineSpace.insertBefore(s,i.display.lineSpace.firstChild),a.value=As.text.join("\n");var l=document.activeElement;P(a),setTimeout(function(){i.display.lineSpace.removeChild(s),l.focus(),l==n&&r.showPrimarySelection()},50)}}Hs(n,i.options.spellcheck,i.options.autocorrect,i.options.autocapitalize),fe(n,"paste",function(e){ge(i,e)||Ds(e,i)||a<=11&&setTimeout(Ji(i,function(){return t.updateFromDOM()}),20)}),fe(n,"compositionstart",function(e){t.composing={data:e.data,done:!1}}),fe(n,"compositionupdate",function(e){t.composing||(t.composing={data:e.data,done:!1})}),fe(n,"compositionend",function(e){t.composing&&(e.data!=t.composing.data&&t.readFromDOMSoon(),t.composing.done=!0)}),fe(n,"touchstart",function(){return r.forceCompositionEnd()}),fe(n,"input",function(){t.composing||t.readFromDOMSoon()}),fe(n,"copy",o),fe(n,"cut",o)},Is.prototype.prepareSelection=function(){var e=mi(this.cm,!1);return e.focus=this.cm.state.focused,e},Is.prototype.showSelection=function(e,t){e&&this.cm.display.view.length&&((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))},Is.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},Is.prototype.showPrimarySelection=function(){var e=this.getSelection(),t=this.cm,i=t.doc.sel.primary(),n=i.from(),o=i.to();if(t.display.viewTo==t.display.viewFrom||n.line>=t.display.viewTo||o.line<t.display.viewFrom)e.removeAllRanges();else{var s=Us(t,e.anchorNode,e.anchorOffset),a=Us(t,e.focusNode,e.focusOffset);if(!s||s.bad||!a||a.bad||0!=rt(st(s,a),n)||0!=rt(ot(s,a),o)){var l=t.display.view,c=n.line>=t.display.viewFrom&&Ws(t,n)||{node:l[0].measure.map[2],offset:0},h=o.line<t.display.viewTo&&Ws(t,o);if(!h){var u=l[l.length-1].measure,f=u.maps?u.maps[u.maps.length-1]:u.map;h={node:f[f.length-1],offset:f[f.length-2]-f[f.length-3]}}if(c&&h){var d,p=e.rangeCount&&e.getRangeAt(0);try{d=L(c.node,c.offset,h.offset,h.node)}catch(e){}d&&(!r&&t.state.focused?(e.collapse(c.node,c.offset),d.collapsed||(e.removeAllRanges(),e.addRange(d))):(e.removeAllRanges(),e.addRange(d)),p&&null==e.anchorNode?e.addRange(p):r&&this.startGracePeriod()),this.rememberSelection()}else e.removeAllRanges()}}},Is.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){return e.cm.curOp.selectionChanged=!0})},20)},Is.prototype.showMultipleSelections=function(e){A(this.cm.display.cursorDiv,e.cursors),A(this.cm.display.selectionDiv,e.selection)},Is.prototype.rememberSelection=function(){var e=this.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},Is.prototype.selectionInEditor=function(){var e=this.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return D(this.div,t)},Is.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()||this.showSelection(this.prepareSelection(),!0),this.div.focus())},Is.prototype.blur=function(){this.div.blur()},Is.prototype.getField=function(){return this.div},Is.prototype.supportsTouch=function(){return!0},Is.prototype.receivedFocus=function(){var e=this;this.selectionInEditor()?this.pollSelection():Zi(this.cm,function(){return e.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,function t(){e.cm.state.focused&&(e.pollSelection(),e.polling.set(e.cm.options.pollInterval,t))})},Is.prototype.selectionChanged=function(){var e=this.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},Is.prototype.pollSelection=function(){if(null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){var e=this.getSelection(),t=this.cm;if(g&&h&&this.cm.display.gutterSpecs.length&&function(e){for(var t=e;t;t=t.parentNode)if(/CodeMirror-gutter-wrapper/.test(t.className))return!0;return!1}(e.anchorNode))return this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),void this.focus();if(!this.composing){this.rememberSelection();var r=Us(t,e.anchorNode,e.anchorOffset),i=Us(t,e.focusNode,e.focusOffset);r&&i&&Zi(t,function(){Jn(t.doc,xn(r,i),j),(r.bad||i.bad)&&(t.curOp.selectionChanged=!0)})}}},Is.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e,t,r,i=this.cm,n=i.display,o=i.doc.sel.primary(),s=o.from(),a=o.to();if(0==s.ch&&s.line>i.firstLine()&&(s=tt(s.line-1,Xe(i.doc,s.line-1).length)),a.ch==Xe(i.doc,a.line).text.length&&a.line<i.lastLine()&&(a=tt(a.line+1,0)),s.line<n.viewFrom||a.line>n.viewTo-1)return!1;s.line==n.viewFrom||0==(e=li(i,s.line))?(t=Je(n.view[0].line),r=n.view[0].node):(t=Je(n.view[e].line),r=n.view[e-1].node.nextSibling);var l,c,h=li(i,a.line);if(h==n.view.length-1?(l=n.viewTo-1,c=n.lineDiv.lastChild):(l=Je(n.view[h+1].line)-1,c=n.view[h+1].node.previousSibling),!r)return!1;for(var u=i.doc.splitLines(function(e,t,r,i,n){var o="",s=!1,a=e.doc.lineSeparator(),l=!1;function c(){s&&(o+=a,l&&(o+=a),s=l=!1)}function h(e){e&&(c(),o+=e)}function u(t){if(1==t.nodeType){var r=t.getAttribute("cm-text");if(r)return void h(r);var o,f=t.getAttribute("cm-marker");if(f){var d=e.findMarks(tt(i,0),tt(n+1,0),(g=+f,function(e){return e.id==g}));return void(d.length&&(o=d[0].find(0))&&h(Ye(e.doc,o.from,o.to).join(a)))}if("false"==t.getAttribute("contenteditable"))return;var p=/^(pre|div|p|li|table|br)$/i.test(t.nodeName);if(!/^br$/i.test(t.nodeName)&&0==t.textContent.length)return;p&&c();for(var m=0;m<t.childNodes.length;m++)u(t.childNodes[m]);/^(pre|p)$/i.test(t.nodeName)&&(l=!0),p&&(s=!0)}else 3==t.nodeType&&h(t.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "));var g}for(;u(t),t!=r;)t=t.nextSibling,l=!1;return o}(i,r,c,t,l)),f=Ye(i.doc,tt(t,0),tt(l,Xe(i.doc,l).text.length));u.length>1&&f.length>1;)if(q(u)==q(f))u.pop(),f.pop(),l--;else{if(u[0]!=f[0])break;u.shift(),f.shift(),t++}for(var d=0,p=0,m=u[0],g=f[0],_=Math.min(m.length,g.length);d<_&&m.charCodeAt(d)==g.charCodeAt(d);)++d;for(var v=q(u),y=q(f),C=Math.min(v.length-(1==u.length?d:0),y.length-(1==f.length?d:0));p<C&&v.charCodeAt(v.length-p-1)==y.charCodeAt(y.length-p-1);)++p;if(1==u.length&&1==f.length&&t==s.line)for(;d&&d>s.ch&&v.charCodeAt(v.length-p-1)==y.charCodeAt(y.length-p-1);)d--,p++;u[u.length-1]=v.slice(0,v.length-p).replace(/^\u200b+/,""),u[0]=u[0].slice(d).replace(/\u200b+$/,"");var b=tt(t,d),w=tt(l,f.length?q(f).length-p:0);return u.length>1||u[0]||rt(b,w)?(fo(i.doc,u,b,w,"+input"),!0):void 0},Is.prototype.ensurePolled=function(){this.forceCompositionEnd()},Is.prototype.reset=function(){this.forceCompositionEnd()},Is.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},Is.prototype.readFromDOMSoon=function(){var e=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(function(){if(e.readDOMTimeout=null,e.composing){if(!e.composing.done)return;e.composing=null}e.updateFromDOM()},80))},Is.prototype.updateFromDOM=function(){var e=this;!this.cm.isReadOnly()&&this.pollContent()||Zi(this.cm,function(){return ci(e.cm)})},Is.prototype.setUneditable=function(e){e.contentEditable="false"},Is.prototype.onKeyPress=function(e){0==e.charCode||this.composing||(e.preventDefault(),this.cm.isReadOnly()||Ji(this.cm,Ms)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0))},Is.prototype.readOnlyChanged=function(e){this.div.contentEditable=String("nocursor"!=e)},Is.prototype.onContextMenu=function(){},Is.prototype.resetPosition=function(){},Is.prototype.needsContentAttribute=!0;var js=function(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new W,this.hasSelection=!1,this.composing=null};js.prototype.init=function(e){var t=this,r=this,i=this.cm;this.createField(e);var n=this.textarea;function o(e){if(!ge(i,e)){if(i.somethingSelected())Es({lineWise:!1,text:i.getSelections()});else{if(!i.options.lineWiseCopyCut)return;var t=Os(i);Es({lineWise:!0,text:t.text}),"cut"==e.type?i.setSelections(t.ranges,null,j):(r.prevInput="",n.value=t.text.join("\n"),P(n))}"cut"==e.type&&(i.state.cutIncoming=+new Date)}}e.wrapper.insertBefore(this.wrapper,e.wrapper.firstChild),m&&(n.style.width="0px"),fe(n,"input",function(){s&&a>=9&&t.hasSelection&&(t.hasSelection=null),r.poll()}),fe(n,"paste",function(e){ge(i,e)||Ds(e,i)||(i.state.pasteIncoming=+new Date,r.fastPoll())}),fe(n,"cut",o),fe(n,"copy",o),fe(e.scroller,"paste",function(t){if(!wr(e,t)&&!ge(i,t)){if(!n.dispatchEvent)return i.state.pasteIncoming=+new Date,void r.focus();var o=new Event("paste");o.clipboardData=t.clipboardData,n.dispatchEvent(o)}}),fe(e.lineSpace,"selectstart",function(t){wr(e,t)||Ce(t)}),fe(n,"compositionstart",function(){var e=i.getCursor("from");r.composing&&r.composing.range.clear(),r.composing={start:e,range:i.markText(e,i.getCursor("to"),{className:"CodeMirror-composing"})}}),fe(n,"compositionend",function(){r.composing&&(r.poll(),r.composing.range.clear(),r.composing=null)})},js.prototype.createField=function(e){this.wrapper=Ps(),this.textarea=this.wrapper.firstChild},js.prototype.prepareSelection=function(){var e=this.cm,t=e.display,r=e.doc,i=mi(e);if(e.options.moveInputWithCursor){var n=Xr(e,r.sel.primary().head,"div"),o=t.wrapper.getBoundingClientRect(),s=t.lineDiv.getBoundingClientRect();i.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,n.top+s.top-o.top)),i.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,n.left+s.left-o.left))}return i},js.prototype.showSelection=function(e){var t=this.cm,r=t.display;A(r.cursorDiv,e.cursors),A(r.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},js.prototype.reset=function(e){if(!this.contextMenuPending&&!this.composing){var t=this.cm;if(t.somethingSelected()){this.prevInput="";var r=t.getSelection();this.textarea.value=r,t.state.focused&&P(this.textarea),s&&a>=9&&(this.hasSelection=r)}else e||(this.prevInput=this.textarea.value="",s&&a>=9&&(this.hasSelection=null))}},js.prototype.getField=function(){return this.textarea},js.prototype.supportsTouch=function(){return!1},js.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!_||R()!=this.textarea))try{this.textarea.focus()}catch(e){}},js.prototype.blur=function(){this.textarea.blur()},js.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},js.prototype.receivedFocus=function(){this.slowPoll()},js.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},js.prototype.fastPoll=function(){var e=!1,t=this;t.pollingFast=!0,t.polling.set(20,function r(){var i=t.poll();i||e?(t.pollingFast=!1,t.slowPoll()):(e=!0,t.polling.set(60,r))})},js.prototype.poll=function(){var e=this,t=this.cm,r=this.textarea,i=this.prevInput;if(this.contextMenuPending||!t.state.focused||Oe(r)&&!i&&!this.composing||t.isReadOnly()||t.options.disableInput||t.state.keySeq)return!1;var n=r.value;if(n==i&&!t.somethingSelected())return!1;if(s&&a>=9&&this.hasSelection===n||v&&/[\uf700-\uf7ff]/.test(n))return t.display.input.reset(),!1;if(t.doc.sel==t.display.selForContextMenu){var o=n.charCodeAt(0);if(8203!=o||i||(i="​"),8666==o)return this.reset(),this.cm.execCommand("undo")}for(var l=0,c=Math.min(i.length,n.length);l<c&&i.charCodeAt(l)==n.charCodeAt(l);)++l;return Zi(t,function(){Ms(t,n.slice(l),i.length-l,null,e.composing?"*compose":null),n.length>1e3||n.indexOf("\n")>-1?r.value=e.prevInput="":e.prevInput=n,e.composing&&(e.composing.range.clear(),e.composing.range=t.markText(e.composing.start,t.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},js.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},js.prototype.onKeyPress=function(){s&&a>=9&&(this.hasSelection=null),this.fastPoll()},js.prototype.onContextMenu=function(e){var t=this,r=t.cm,i=r.display,n=t.textarea;t.contextMenuPending&&t.contextMenuPending();var o=ai(r,e),c=i.scroller.scrollTop;if(o&&!u){var h=r.options.resetSelectionOnContextMenu;h&&-1==r.doc.sel.contains(o)&&Ji(r,Jn)(r.doc,xn(o),j);var f,d=n.style.cssText,p=t.wrapper.style.cssText,m=t.wrapper.offsetParent.getBoundingClientRect();if(t.wrapper.style.cssText="position: static",n.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(e.clientY-m.top-5)+"px; left: "+(e.clientX-m.left-5)+"px;\n      z-index: 1000; background: "+(s?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",l&&(f=window.scrollY),i.input.focus(),l&&window.scrollTo(null,f),i.input.reset(),r.somethingSelected()||(n.value=t.prevInput=" "),t.contextMenuPending=v,i.selForContextMenu=r.doc.sel,clearTimeout(i.detectingSelectAll),s&&a>=9&&_(),x){xe(e);var g=function(){pe(window,"mouseup",g),setTimeout(v,20)};fe(window,"mouseup",g)}else setTimeout(v,50)}function _(){if(null!=n.selectionStart){var e=r.somethingSelected(),o="​"+(e?n.value:"");n.value="⇚",n.value=o,t.prevInput=e?"":"​",n.selectionStart=1,n.selectionEnd=o.length,i.selForContextMenu=r.doc.sel}}function v(){if(t.contextMenuPending==v&&(t.contextMenuPending=!1,t.wrapper.style.cssText=p,n.style.cssText=d,s&&a<9&&i.scrollbars.setScrollTop(i.scroller.scrollTop=c),null!=n.selectionStart)){(!s||s&&a<9)&&_();var e=0,o=function(){i.selForContextMenu==r.doc.sel&&0==n.selectionStart&&n.selectionEnd>0&&"​"==t.prevInput?Ji(r,oo)(r):e++<10?i.detectingSelectAll=setTimeout(o,500):(i.selForContextMenu=null,i.input.reset())};i.detectingSelectAll=setTimeout(o,200)}}},js.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled="nocursor"==e},js.prototype.setUneditable=function(){},js.prototype.needsContentAttribute=!1,function(e){var t=e.optionHandlers;function r(r,i,n,o){e.defaults[r]=i,n&&(t[r]=o?function(e,t,r){r!=Cs&&n(e,t,r)}:n)}e.defineOption=r,e.Init=Cs,r("value","",function(e,t){return e.setValue(t)},!0),r("mode",null,function(e,t){e.doc.modeOption=t,An(e)},!0),r("indentUnit",2,An,!0),r("indentWithTabs",!1),r("smartIndent",!0),r("tabSize",4,function(e){En(e),Nr(e),ci(e)},!0),r("lineSeparator",null,function(e,t){if(e.doc.lineSep=t,t){var r=[],i=e.doc.first;e.doc.iter(function(e){for(var n=0;;){var o=e.text.indexOf(t,n);if(-1==o)break;n=o+t.length,r.push(tt(i,o))}i++});for(var n=r.length-1;n>=0;n--)fo(e.doc,t,r[n],tt(r[n].line,r[n].ch+t.length))}}),r("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/g,function(e,t,r){e.state.specialChars=new RegExp(t.source+(t.test("\t")?"":"|\t"),"g"),r!=Cs&&e.refresh()}),r("specialCharPlaceholder",Qt,function(e){return e.refresh()},!0),r("electricChars",!0),r("inputStyle",_?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),r("spellcheck",!1,function(e,t){return e.getInputField().spellcheck=t},!0),r("autocorrect",!1,function(e,t){return e.getInputField().autocorrect=t},!0),r("autocapitalize",!1,function(e,t){return e.getInputField().autocapitalize=t},!0),r("rtlMoveVisually",!C),r("wholeLineUpdateBefore",!0),r("theme","default",function(e){ys(e),dn(e)},!0),r("keyMap","default",function(e,t,r){var i=Yo(t),n=r!=Cs&&Yo(r);n&&n.detach&&n.detach(e,i),i.attach&&i.attach(e,n||null)}),r("extraKeys",null),r("configureMouse",null),r("lineWrapping",!1,Ss,!0),r("gutters",[],function(e,t){e.display.gutterSpecs=un(t,e.options.lineNumbers),dn(e)},!0),r("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?ni(e.display)+"px":"0",e.refresh()},!0),r("coverGutterNextToScrollbar",!1,function(e){return Wi(e)},!0),r("scrollbarStyle","native",function(e){zi(e),Wi(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),r("lineNumbers",!1,function(e,t){e.display.gutterSpecs=un(e.options.gutters,t),dn(e)},!0),r("firstLineNumber",1,dn,!0),r("lineNumberFormatter",function(e){return e},dn,!0),r("showCursorWhenSelecting",!1,pi,!0),r("resetSelectionOnContextMenu",!0),r("lineWiseCopyCut",!0),r("pasteLinesPerSelection",!0),r("selectionsMayTouch",!1),r("readOnly",!1,function(e,t){"nocursor"==t&&(xi(e),e.display.input.blur()),e.display.input.readOnlyChanged(t)}),r("disableInput",!1,function(e,t){t||e.display.input.reset()},!0),r("dragDrop",!0,xs),r("allowDropFileTypes",null),r("cursorBlinkRate",530),r("cursorScrollMargin",0),r("cursorHeight",1,pi,!0),r("singleCursorHeightPerLine",!0,pi,!0),r("workTime",100),r("workDelay",100),r("flattenSpans",!0,En,!0),r("addModeClass",!1,En,!0),r("pollInterval",100),r("undoDepth",200,function(e,t){return e.doc.history.undoDepth=t}),r("historyEventDelay",1250),r("viewportMargin",10,function(e){return e.refresh()},!0),r("maxHighlightLength",1e4,En,!0),r("moveInputWithCursor",!0,function(e,t){t||e.display.input.resetPosition()}),r("tabindex",null,function(e,t){return e.display.input.getField().tabIndex=t||""}),r("autofocus",null),r("direction","ltr",function(e,t){return e.doc.setDirection(t)},!0),r("phrases",null)}(Ls),function(e){var t=e.optionHandlers,r=e.helpers={};e.prototype={constructor:e,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,r){var i=this.options,n=i[e];i[e]==r&&"mode"!=e||(i[e]=r,t.hasOwnProperty(e)&&Ji(this,t[e])(this,r,n),me(this,"optionChange",this,e))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](Yo(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,r=0;r<t.length;++r)if(t[r]==e||t[r].name==e)return t.splice(r,1),!0},addOverlay:$i(function(t,r){var i=t.token?t:e.getMode(this.options,t);if(i.startState)throw new Error("Overlays may not be stateful.");!function(e,t,r){for(var i=0,n=r(t);i<e.length&&r(e[i])<=n;)i++;e.splice(i,0,t)}(this.state.overlays,{mode:i,modeSpec:t,opaque:r&&r.opaque,priority:r&&r.priority||0},function(e){return e.priority}),this.state.modeGen++,ci(this)}),removeOverlay:$i(function(e){for(var t=this.state.overlays,r=0;r<t.length;++r){var i=t[r].modeSpec;if(i==e||"string"==typeof e&&i.name==e)return t.splice(r,1),this.state.modeGen++,void ci(this)}}),indentLine:$i(function(e,t,r){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),Qe(this.doc,e)&&Ts(this,e,t,r)}),indentSelection:$i(function(e){for(var t=this.doc.sel.ranges,r=-1,i=0;i<t.length;i++){var n=t[i];if(n.empty())n.head.line>r&&(Ts(this,n.head.line,e,!0),r=n.head.line,i==this.doc.sel.primIndex&&Ei(this));else{var o=n.from(),s=n.to(),a=Math.max(r,o.line);r=Math.min(this.lastLine(),s.line-(s.ch?0:1))+1;for(var l=a;l<r;++l)Ts(this,l,e);var c=this.doc.sel.ranges;0==o.ch&&t.length==c.length&&c[i].from().ch>0&&Yn(this.doc,i,new bn(o,c[i].to()),j)}}}),getTokenAt:function(e,t){return yt(this,e,t)},getLineTokens:function(e,t){return yt(this,tt(e),t,!0)},getTokenTypeAt:function(e){e=lt(this.doc,e);var t,r=dt(this,Xe(this.doc,e.line)),i=0,n=(r.length-1)/2,o=e.ch;if(0==o)t=r[2];else for(;;){var s=i+n>>1;if((s?r[2*s-1]:0)>=o)n=s;else{if(!(r[2*s+1]<o)){t=r[2*s+2];break}i=s+1}}var a=t?t.indexOf("overlay "):-1;return a<0?t:0==a?null:t.slice(0,a-1)},getModeAt:function(t){var r=this.doc.mode;return r.innerMode?e.innerMode(r,this.getTokenAt(t).state).mode:r},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var i=[];if(!r.hasOwnProperty(t))return i;var n=r[t],o=this.getModeAt(e);if("string"==typeof o[t])n[o[t]]&&i.push(n[o[t]]);else if(o[t])for(var s=0;s<o[t].length;s++){var a=n[o[t][s]];a&&i.push(a)}else o.helperType&&n[o.helperType]?i.push(n[o.helperType]):n[o.name]&&i.push(n[o.name]);for(var l=0;l<n._global.length;l++){var c=n._global[l];c.pred(o,this)&&-1==N(i,c.val)&&i.push(c.val)}return i},getStateAfter:function(e,t){var r=this.doc;return pt(this,(e=at(r,null==e?r.first+r.size-1:e))+1,t).state},cursorCoords:function(e,t){var r=this.doc.sel.primary();return Xr(this,null==e?r.head:"object"==typeof e?lt(this.doc,e):e?r.from():r.to(),t||"page")},charCoords:function(e,t){return Vr(this,lt(this.doc,e),t||"page")},coordsChar:function(e,t){return Zr(this,(e=Gr(this,e,t||"page")).left,e.top)},lineAtHeight:function(e,t){return e=Gr(this,{top:e,left:0},t||"page").top,$e(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t,r){var i,n=!1;if("number"==typeof e){var o=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>o&&(e=o,n=!0),i=Xe(this.doc,e)}else i=e;return Kr(this,i,{top:0,left:0},t||"page",r||n).top+(n?this.doc.height-Kt(i):0)},defaultTextHeight:function(){return ti(this.display)},defaultCharWidth:function(){return ri(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,r,i,n){var o,s,a,l=this.display,c=(e=Xr(this,lt(this.doc,e))).bottom,h=e.left;if(t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),l.sizer.appendChild(t),"over"==i)c=e.top;else if("above"==i||"near"==i){var u=Math.max(l.wrapper.clientHeight,this.doc.height),f=Math.max(l.sizer.clientWidth,l.lineSpace.clientWidth);("above"==i||e.bottom+t.offsetHeight>u)&&e.top>t.offsetHeight?c=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=u&&(c=e.bottom),h+t.offsetWidth>f&&(h=f-t.offsetWidth)}t.style.top=c+"px",t.style.left=t.style.right="","right"==n?(h=l.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==n?h=0:"middle"==n&&(h=(l.sizer.clientWidth-t.offsetWidth)/2),t.style.left=h+"px"),r&&(o=this,s={left:h,top:c,right:h+t.offsetWidth,bottom:c+t.offsetHeight},null!=(a=Ti(o,s)).scrollTop&&Oi(o,a.scrollTop),null!=a.scrollLeft&&Pi(o,a.scrollLeft))},triggerOnKeyDown:$i(ls),triggerOnKeyPress:$i(hs),triggerOnKeyUp:cs,triggerOnMouseDown:$i(ps),execCommand:function(e){if(Qo.hasOwnProperty(e))return Qo[e].call(null,this)},triggerElectric:$i(function(e){Rs(this,e)}),findPosH:function(e,t,r,i){var n=1;t<0&&(n=-1,t=-t);for(var o=lt(this.doc,e),s=0;s<t&&!(o=Bs(this.doc,o,n,r,i)).hitSide;++s);return o},moveH:$i(function(e,t){var r=this;this.extendSelectionsBy(function(i){return r.display.shift||r.doc.extend||i.empty()?Bs(r.doc,i.head,e,t,r.options.rtlMoveVisually):e<0?i.from():i.to()},G)}),deleteH:$i(function(e,t){var r=this.doc.sel,i=this.doc;r.somethingSelected()?i.replaceSelection("",null,"+delete"):qo(this,function(r){var n=Bs(i,r.head,e,t,!1);return e<0?{from:n,to:r.head}:{from:r.head,to:n}})}),findPosV:function(e,t,r,i){var n=1,o=i;t<0&&(n=-1,t=-t);for(var s=lt(this.doc,e),a=0;a<t;++a){var l=Xr(this,s,"div");if(null==o?o=l.left:l.left=o,(s=Fs(this,l,n,r)).hitSide)break}return s},moveV:$i(function(e,t){var r=this,i=this.doc,n=[],o=!this.display.shift&&!i.extend&&i.sel.somethingSelected();if(i.extendSelectionsBy(function(s){if(o)return e<0?s.from():s.to();var a=Xr(r,s.head,"div");null!=s.goalColumn&&(a.left=s.goalColumn),n.push(a.left);var l=Fs(r,a,e,t);return"page"==t&&s==i.sel.primary()&&Ai(r,Vr(r,l,"div").top-a.top),l},G),n.length)for(var s=0;s<i.sel.ranges.length;s++)i.sel.ranges[s].goalColumn=n[s]}),findWordAt:function(e){var t=this.doc,r=Xe(t,e.line).text,i=e.ch,n=e.ch;if(r){var o=this.getHelper(e,"wordChars");"before"!=e.sticky&&n!=r.length||!i?++n:--i;for(var s=r.charAt(i),a=te(s,o)?function(e){return te(e,o)}:/\s/.test(s)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!te(e)};i>0&&a(r.charAt(i-1));)--i;for(;n<r.length&&a(r.charAt(n));)++n}return new bn(tt(e.line,i),tt(e.line,n))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?O(this.display.cursorDiv,"CodeMirror-overwrite"):k(this.display.cursorDiv,"CodeMirror-overwrite"),me(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==R()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:$i(function(e,t){Mi(this,e,t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-kr(this)-this.display.barHeight,width:e.scrollWidth-kr(this)-this.display.barWidth,clientHeight:Ar(this),clientWidth:Tr(this)}},scrollIntoView:$i(function(e,t){null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:tt(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line?function(e,t){Di(e),e.curOp.scrollToPos=t}(this,e):Ri(this,e.from,e.to,e.margin)}),setSize:$i(function(e,t){var r=this,i=function(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e};null!=e&&(this.display.wrapper.style.width=i(e)),null!=t&&(this.display.wrapper.style.height=i(t)),this.options.lineWrapping&&Wr(this);var n=this.display.viewFrom;this.doc.iter(n,this.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){hi(r,n,"widget");break}++n}),this.curOp.forceUpdate=!0,me(this,"refresh",this)}),operation:function(e){return Zi(this,e)},startOperation:function(){return Ki(this)},endOperation:function(){return Gi(this)},refresh:$i(function(){var e=this.display.cachedTextHeight;ci(this),this.curOp.forceUpdate=!0,Nr(this),Mi(this,this.doc.scrollLeft,this.doc.scrollTop),an(this.display),(null==e||Math.abs(e-ti(this.display))>.5)&&si(this),me(this,"refresh",this)}),swapDoc:$i(function(e){var t=this.doc;return t.cm=null,this.state.selectingText&&this.state.selectingText(),On(this,e),Nr(this),this.display.input.reset(),Mi(this,e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,lr(this,"swapDoc",this,t),t}),phrase:function(e){var t=this.options.phrases;return t&&Object.prototype.hasOwnProperty.call(t,e)?t[e]:e},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},ye(e),e.registerHelper=function(t,i,n){r.hasOwnProperty(t)||(r[t]=e[t]={_global:[]}),r[t][i]=n},e.registerGlobalHelper=function(t,i,n,o){e.registerHelper(t,i,o),r[t]._global.push({pred:n,val:o})}}(Ls);var Ks="iter insert remove copy getEditor constructor".split(" ");for(var Gs in Eo.prototype)Eo.prototype.hasOwnProperty(Gs)&&N(Ks,Gs)<0&&(Ls.prototype[Gs]=function(e){return function(){return e.apply(this.doc,arguments)}}(Eo.prototype[Gs]));return ye(Eo),Ls.inputStyles={textarea:js,contenteditable:Is},Ls.defineMode=function(e){Ls.defaults.mode||"null"==e||(Ls.defaults.mode=e),Ie.apply(this,arguments)},Ls.defineMIME=function(e,t){Fe[e]=t},Ls.defineMode("null",function(){return{token:function(e){return e.skipToEnd()}}}),Ls.defineMIME("text/plain","null"),Ls.defineExtension=function(e,t){Ls.prototype[e]=t},Ls.defineDocExtension=function(e,t){Eo.prototype[e]=t},Ls.fromTextArea=function(e,t){if((t=t?F(t):{}).value=e.value,!t.tabindex&&e.tabIndex&&(t.tabindex=e.tabIndex),!t.placeholder&&e.placeholder&&(t.placeholder=e.placeholder),null==t.autofocus){var r=R();t.autofocus=r==e||null!=e.getAttribute("autofocus")&&r==document.body}function i(){e.value=a.getValue()}var n;if(e.form&&(fe(e.form,"submit",i),!t.leaveSubmitMethodAlone)){var o=e.form;n=o.submit;try{var s=o.submit=function(){i(),o.submit=n,o.submit(),o.submit=s}}catch(e){}}t.finishInit=function(t){t.save=i,t.getTextArea=function(){return e},t.toTextArea=function(){t.toTextArea=isNaN,i(),e.parentNode.removeChild(t.getWrapperElement()),e.style.display="",e.form&&(pe(e.form,"submit",i),"function"==typeof e.form.submit&&(e.form.submit=n))}},e.style.display="none";var a=Ls(function(t){return e.parentNode.insertBefore(t,e.nextSibling)},t);return a},function(e){e.off=pe,e.on=fe,e.wheelEventPixels=vn,e.Doc=Eo,e.splitLines=Re,e.countColumn=I,e.findColumn=V,e.isWordChar=ee,e.Pass=z,e.signal=me,e.Line=Xt,e.changeEnd=Sn,e.scrollbarModel=Ui,e.Pos=tt,e.cmpPos=rt,e.modes=Be,e.mimeModes=Fe,e.resolveMode=We,e.getMode=Ne,e.modeExtensions=Ue,e.extendMode=ze,e.copyState=je,e.startState=Ge,e.innerMode=Ke,e.commands=Qo,e.keyMap=Uo,e.keyName=Xo,e.isModifierKey=Go,e.lookupKey=Ko,e.normalizeKeyMap=jo,e.StringStream=Ve,e.SharedTextMarker=Lo,e.TextMarker=xo,e.LineWidget=Co,e.e_preventDefault=Ce,e.e_stopPropagation=be,e.e_stop=xe,e.addClass=O,e.contains=D,e.rmClass=k,e.keyNames=Fo}(Ls),Ls.version="5.48.2",Ls}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringFromCodePoint=function(e){return e>65535?(e-=65536,String.fromCharCode(55296+(e>>10))+String.fromCharCode(e%1024+56320)):String.fromCharCode(e)},t.utf32ToString=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=e.length);for(var i="",n=t;n<r;++n){var o=e[n];o>65535?(o-=65536,i+=String.fromCharCode(55296+(o>>10))+String.fromCharCode(o%1024+56320)):i+=String.fromCharCode(o)}return i};var i=function(){function e(){this._interim=0}return e.prototype.clear=function(){this._interim=0},e.prototype.decode=function(e,t){var r=e.length;if(!r)return 0;var i=0,n=0;this._interim&&(56320<=(a=e.charCodeAt(n++))&&a<=57343?t[i++]=1024*(this._interim-55296)+a-56320+65536:(t[i++]=this._interim,t[i++]=a),this._interim=0);for(var o=n;o<r;++o){var s=e.charCodeAt(o);if(55296<=s&&s<=56319){if(++o>=r)return this._interim=s,i;var a;56320<=(a=e.charCodeAt(o))&&a<=57343?t[i++]=1024*(s-55296)+a-56320+65536:(t[i++]=s,t[i++]=a)}else t[i++]=s}return i},e}();t.StringToUtf32=i;var n=function(){function e(){this.interim=new Uint8Array(3)}return e.prototype.clear=function(){this.interim.fill(0)},e.prototype.decode=function(e,t){var r=e.length;if(!r)return 0;var i,n,o,s,a=0,l=0,c=0;if(this.interim[0]){var h=!1,u=this.interim[0];u&=192==(224&u)?31:224==(240&u)?15:7;for(var f=0,d=void 0;(d=63&this.interim[++f])&&f<4;)u<<=6,u|=d;for(var p=192==(224&this.interim[0])?2:224==(240&this.interim[0])?3:4,m=p-f;c<m;){if(c>=r)return 0;if(128!=(192&(d=e[c++]))){c--,h=!0;break}this.interim[f++]=d,u<<=6,u|=63&d}h||(2===p?u<128?c--:t[a++]=u:3===p?u<2048||u>=55296&&u<=57343||(t[a++]=u):l<65536||l>1114111||(t[a++]=u)),this.interim.fill(0)}for(var g=r-4,_=c;_<r;){for(;!(!(_<g)||128&(i=e[_])||128&(n=e[_+1])||128&(o=e[_+2])||128&(s=e[_+3]));)t[a++]=i,t[a++]=n,t[a++]=o,t[a++]=s,_+=4;if((i=e[_++])<128)t[a++]=i;else if(192==(224&i)){if(_>=r)return this.interim[0]=i,a;if(128!=(192&(n=e[_++]))){_--;continue}if((l=(31&i)<<6|63&n)<128){_--;continue}t[a++]=l}else if(224==(240&i)){if(_>=r)return this.interim[0]=i,a;if(128!=(192&(n=e[_++]))){_--;continue}if(_>=r)return this.interim[0]=i,this.interim[1]=n,a;if(128!=(192&(o=e[_++]))){_--;continue}if((l=(15&i)<<12|(63&n)<<6|63&o)<2048||l>=55296&&l<=57343)continue;t[a++]=l}else if(240==(248&i)){if(_>=r)return this.interim[0]=i,a;if(128!=(192&(n=e[_++]))){_--;continue}if(_>=r)return this.interim[0]=i,this.interim[1]=n,a;if(128!=(192&(o=e[_++]))){_--;continue}if(_>=r)return this.interim[0]=i,this.interim[1]=n,this.interim[2]=o,a;if(128!=(192&(s=e[_++]))){_--;continue}if((l=(7&i)<<18|(63&n)<<12|(63&o)<<6|63&s)<65536||l>1114111)continue;t[a++]=l}}return a},e}();t.Utf8ToUtf32=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(12);t.generateConfig=function(e,t,r,i){var n={foreground:i.foreground,background:i.background,cursor:null,cursorAccent:null,selection:null,ansi:i.ansi.slice(0,16)};return{type:r.options.experimentalCharAtlas,devicePixelRatio:window.devicePixelRatio,scaledCharWidth:e,scaledCharHeight:t,fontFamily:r.options.fontFamily,fontSize:r.options.fontSize,fontWeight:r.options.fontWeight,fontWeightBold:r.options.fontWeightBold,allowTransparency:r.options.allowTransparency,colors:n}},t.configEquals=function(e,t){for(var r=0;r<e.colors.ansi.length;r++)if(e.colors.ansi[r].rgba!==t.colors.ansi[r].rgba)return!1;return e.type===t.type&&e.devicePixelRatio===t.devicePixelRatio&&e.fontFamily===t.fontFamily&&e.fontSize===t.fontSize&&e.fontWeight===t.fontWeight&&e.fontWeightBold===t.fontWeightBold&&e.allowTransparency===t.allowTransparency&&e.scaledCharWidth===t.scaledCharWidth&&e.scaledCharHeight===t.scaledCharHeight&&e.colors.foreground===t.colors.foreground&&e.colors.background===t.colors.background},t.is256Color=function(e){return e<i.DEFAULT_COLOR}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._didWarmUp=!1}return e.prototype.dispose=function(){},e.prototype.warmUp=function(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)},e.prototype._doWarmUp=function(){},e.prototype.beginFrame=function(){},e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.blankLine="Blank line",t.promptLabel="Terminal input",t.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(36),n=r(7),o=r(37),s=r(38);t.MAX_BUFFER_SIZE=4294967295;var a=function(){function e(e,t){this._terminal=e,this._hasScrollback=t,this.savedCurAttrData=n.DEFAULT_ATTR_DATA.clone(),this.markers=[],this._nullCell=n.CellData.fromCharData([0,n.NULL_CELL_CHAR,n.NULL_CELL_WIDTH,n.NULL_CELL_CODE]),this._whitespaceCell=n.CellData.fromCharData([0,n.WHITESPACE_CELL_CHAR,n.WHITESPACE_CELL_WIDTH,n.WHITESPACE_CELL_CODE]),this._cols=this._terminal.cols,this._rows=this._terminal.rows,this.clear()}return e.prototype.getNullCell=function(e){return e?(this._nullCell.fg=e.fg,this._nullCell.bg=e.bg):(this._nullCell.fg=0,this._nullCell.bg=0),this._nullCell},e.prototype.getWhitespaceCell=function(e){return e?(this._whitespaceCell.fg=e.fg,this._whitespaceCell.bg=e.bg):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0),this._whitespaceCell},e.prototype.getBlankLine=function(e,t){return new n.BufferLine(this._terminal.cols,this.getNullCell(e),t)},Object.defineProperty(e.prototype,"hasScrollback",{get:function(){return this._hasScrollback&&this.lines.maxLength>this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCursorInViewport",{get:function(){var e=this.ybase+this.y-this.ydisp;return e>=0&&e<this._rows},enumerable:!0,configurable:!0}),e.prototype._getCorrectBufferLength=function(e){if(!this._hasScrollback)return e;var r=e+this._terminal.options.scrollback;return r>t.MAX_BUFFER_SIZE?t.MAX_BUFFER_SIZE:r},e.prototype.fillViewportRows=function(e){if(0===this.lines.length){void 0===e&&(e=n.DEFAULT_ATTR_DATA);for(var t=this._rows;t--;)this.lines.push(this.getBlankLine(e))}},e.prototype.clear=function(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new i.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()},e.prototype.resize=function(e,t){var r=this.getNullCell(n.DEFAULT_ATTR_DATA),i=this._getCorrectBufferLength(t);if(i>this.lines.maxLength&&(this.lines.maxLength=i),this.lines.length>0){if(this._cols<e)for(var o=0;o<this.lines.length;o++)this.lines.get(o).resize(e,r);var s=0;if(this._rows<t)for(var a=this._rows;a<t;a++)this.lines.length<t+this.ybase&&(this.ybase>0&&this.lines.length<=this.ybase+this.y+s+1?(this.ybase--,s++,this.ydisp>0&&this.ydisp--):this.lines.push(new n.BufferLine(e,r)));else for(a=this._rows;a>t;a--)this.lines.length>t+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(i<this.lines.maxLength){var l=this.lines.length-i;l>0&&(this.lines.trimStart(l),this.ybase=Math.max(this.ybase-l,0),this.ydisp=Math.max(this.ydisp-l,0)),this.lines.maxLength=i}this.x=Math.min(this.x,e-1),this.y=Math.min(this.y,t-1),s&&(this.y+=s),this.savedY=Math.min(this.savedY,t-1),this.savedX=Math.min(this.savedX,e-1),this.scrollTop=0}if(this.scrollBottom=t-1,this._isReflowEnabled&&(this._reflow(e,t),this._cols>e))for(o=0;o<this.lines.length;o++)this.lines.get(o).resize(e,r);this._cols=e,this._rows=t},Object.defineProperty(e.prototype,"_isReflowEnabled",{get:function(){return this._hasScrollback&&!this._terminal.options.windowsMode},enumerable:!0,configurable:!0}),e.prototype._reflow=function(e,t){this._cols!==e&&(e>this._cols?this._reflowLarger(e,t):this._reflowSmaller(e,t))},e.prototype._reflowLarger=function(e,t){var r=o.reflowLargerGetLinesToRemove(this.lines,this._cols,e,this.ybase+this.y,this.getNullCell(n.DEFAULT_ATTR_DATA));if(r.length>0){var i=o.reflowLargerCreateNewLayout(this.lines,r);o.reflowLargerApplyNewLayout(this.lines,i.layout),this._reflowLargerAdjustViewport(e,t,i.countRemoved)}},e.prototype._reflowLargerAdjustViewport=function(e,t,r){for(var i=this.getNullCell(n.DEFAULT_ATTR_DATA),o=r;o-- >0;)0===this.ybase?(this.y>0&&this.y--,this.lines.length<t&&this.lines.push(new n.BufferLine(e,i))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--)},e.prototype._reflowSmaller=function(e,t){for(var r=this.getNullCell(n.DEFAULT_ATTR_DATA),i=[],s=0,a=this.lines.length-1;a>=0;a--){var l=this.lines.get(a);if(!(!l||!l.isWrapped&&l.getTrimmedLength()<=e)){for(var c=[l];l.isWrapped&&a>0;)l=this.lines.get(--a),c.unshift(l);var h=this.ybase+this.y;if(!(h>=a&&h<a+c.length)){var u=c[c.length-1].getTrimmedLength(),f=o.reflowSmallerGetNewLineLengths(c,this._cols,e),d=f.length-c.length,p=void 0;p=0===this.ybase&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+d):Math.max(0,this.lines.length-this.lines.maxLength+d);for(var m=[],g=0;g<d;g++){var _=this.getBlankLine(n.DEFAULT_ATTR_DATA,!0);m.push(_)}m.length>0&&(i.push({start:a+c.length+s,newLines:m}),s+=m.length),c.push.apply(c,m);var v=f.length-1,y=f[v];0===y&&(y=f[--v]);for(var C=c.length-d-1,b=u;C>=0;){var w=Math.min(b,y);if(c[v].copyCellsFrom(c[C],b-w,y-w,w,!0),0===(y-=w)&&(y=f[--v]),0===(b-=w)){C--;var x=Math.max(C,0);b=o.getWrappedLineTrimmedLength(c,x,this._cols)}}for(g=0;g<c.length;g++)f[g]<e&&c[g].setCell(f[g],r);for(var S=d-p;S-- >0;)0===this.ybase?this.y<t-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+s)-t&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++)}}}if(i.length>0){var L=[],k=[];for(g=0;g<this.lines.length;g++)k.push(this.lines.get(g));var T=this.lines.length,A=T-1,E=0,M=i[E];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+s);var D=0;for(g=Math.min(this.lines.maxLength-1,T+s-1);g>=0;g--)if(M&&M.start>A+D){for(var R=M.newLines.length-1;R>=0;R--)this.lines.set(g--,M.newLines[R]);g++,L.push({index:A+1,amount:M.newLines.length}),D+=M.newLines.length,M=i[++E]}else this.lines.set(g,k[A--]);var O=0;for(g=L.length-1;g>=0;g--)L[g].index+=O,this.lines.onInsertEmitter.fire(L[g]),O+=L[g].amount;var H=Math.max(0,T+s-this.lines.maxLength);H>0&&this.lines.onTrimEmitter.fire(H)}},e.prototype.stringIndexToBufferIndex=function(e,t,r){for(void 0===r&&(r=!1);t;){var i=this.lines.get(e);if(!i)return[-1,-1];for(var o=r?i.getTrimmedLength():i.length,s=0;s<o;++s)if(i.get(s)[n.CHAR_DATA_WIDTH_INDEX]&&(t-=i.get(s)[n.CHAR_DATA_CHAR_INDEX].length||1),t<0)return[e,s];e++}return[e,0]},e.prototype.translateBufferLineToString=function(e,t,r,i){void 0===r&&(r=0);var n=this.lines.get(e);return n?n.translateToString(t,r,i):""},e.prototype.getWrappedRangeForLine=function(e){for(var t=e,r=e;t>0&&this.lines.get(t).isWrapped;)t--;for(;r+1<this.lines.length&&this.lines.get(r+1).isWrapped;)r++;return{first:t,last:r}},e.prototype.setupTabStops=function(e){for(null!=e?this.tabs[e]||(e=this.prevStop(e)):(this.tabs={},e=0);e<this._cols;e+=this._terminal.options.tabStopWidth)this.tabs[e]=!0},e.prototype.prevStop=function(e){for(null==e&&(e=this.x);!this.tabs[--e]&&e>0;);return e>=this._cols?this._cols-1:e<0?0:e},e.prototype.nextStop=function(e){for(null==e&&(e=this.x);!this.tabs[++e]&&e<this._cols;);return e>=this._cols?this._cols-1:e<0?0:e},e.prototype.addMarker=function(e){var t=this,r=new s.Marker(e);return this.markers.push(r),r.register(this.lines.onTrim(function(e){r.line-=e,r.line<0&&r.dispose()})),r.register(this.lines.onInsert(function(e){r.line>=e.index&&(r.line+=e.amount)})),r.register(this.lines.onDelete(function(e){r.line>=e.index&&r.line<e.index+e.amount&&r.dispose(),r.line>e.index&&(r.line-=e.amount)})),r.register(r.onDispose(function(){return t._removeMarker(r)})),r},e.prototype._removeMarker=function(e){this.markers.splice(this.markers.indexOf(e),1)},e.prototype.iterator=function(e,t,r,i,n){return new l(this,e,t,r,i,n)},e}();t.Buffer=a;var l=function(){function e(e,t,r,i,n,o){void 0===r&&(r=0),void 0===i&&(i=e.lines.length),void 0===n&&(n=0),void 0===o&&(o=0),this._buffer=e,this._trimRight=t,this._startIndex=r,this._endIndex=i,this._startOverscan=n,this._endOverscan=o,this._startIndex<0&&(this._startIndex=0),this._endIndex>this._buffer.lines.length&&(this._endIndex=this._buffer.lines.length),this._current=this._startIndex}return e.prototype.hasNext=function(){return this._current<this._endIndex},e.prototype.next=function(){var e=this._buffer.getWrappedRangeForLine(this._current);e.first<this._startIndex-this._startOverscan&&(e.first=this._startIndex-this._startOverscan),e.last>this._endIndex+this._endOverscan&&(e.last=this._endIndex+this._endOverscan),e.first=Math.max(e.first,0),e.last=Math.min(e.last,this._buffer.lines.length);for(var t="",r=e.first;r<=e.last;++r)t+=this._buffer.translateBufferLineToString(r,this._trimRight);return this._current=e.last+1,{range:e,content:t}},e}();t.BufferStringIterator=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(22);t.wcwidth=function(e){var t=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],r=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];var n=0|e.control,o=new Uint8Array(65536);i.fill(o,1),o[0]=e.nul,i.fill(o,e.control,1,32),i.fill(o,e.control,127,160),i.fill(o,2,4352,4448),o[9001]=2,o[9002]=2,i.fill(o,2,11904,42192),o[12351]=1,i.fill(o,2,44032,55204),i.fill(o,2,63744,64256),i.fill(o,2,65040,65050),i.fill(o,2,65072,65136),i.fill(o,2,65280,65377),i.fill(o,2,65504,65511);for(var s=0;s<t.length;++s)i.fill(o,0,t[s][0],t[s][1]+1);return function(e){return e<32?0|n:e<127?1:e<65536?o[e]:function(e,t){var r,i=0,n=t.length-1;if(e<t[0][0]||e>t[n][1])return!1;for(;n>=i;)if(e>t[r=i+n>>1][1])i=r+1;else{if(!(e<t[r][0]))return!0;n=r-1}return!1}(t=e,r)?0:t>=131072&&t<=196605||t>=196608&&t<=262141?2:1;var t}}({nul:0,control:0}),t.getStringCellWidth=function(e){for(var r=0,i=e.length,n=0;n<i;++n){var o=e.charCodeAt(n);if(55296<=o&&o<=56319){if(++n>=i)return r+t.wcwidth(o);var s=e.charCodeAt(n);56320<=s&&s<=57343?o=1024*(o-55296)+s-56320+65536:r+=t.wcwidth(s)}r+=t.wcwidth(o)}return r}},function(e,t,r){"use strict";function i(e,t,r,i){if(void 0===r&&(r=0),void 0===i&&(i=e.length),r>=e.length)return e;r=(e.length+r)%e.length,i=i>=e.length?e.length:(e.length+i)%e.length;for(var n=r;n<i;++n)e[n]=t;return e}Object.defineProperty(t,"__esModule",{value:!0}),t.fill=function(e,t,r,n){return e.fill?e.fill(t,r,n):i(e,t,r,n)},t.fillFallback=i,t.concat=function(e,t){var r=new e.constructor(e.length+t.length);return r.set(e),r.set(t,e.length),r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(17),n=r(49),o=r(51),s=r(52),a={none:o.default,static:s.default,dynamic:n.default},l=[];t.acquireCharAtlas=function(e,t,r,n){for(var o=i.generateConfig(r,n,e,t),s=0;s<l.length;s++){var c=(h=l[s]).ownedBy.indexOf(e);if(c>=0){if(i.configEquals(h.config,o))return h.atlas;1===h.ownedBy.length?(h.atlas.dispose(),l.splice(s,1)):h.ownedBy.splice(c,1);break}}for(s=0;s<l.length;s++){var h=l[s];if(i.configEquals(h.config,o))return h.ownedBy.push(e),h.atlas}var u={atlas:new a[e.options.experimentalCharAtlas](document,o),config:o,ownedBy:[e]};return l.push(u),u.atlas},t.removeTerminalFromCache=function(e){for(var t=0;t<l.length;t++){var r=l[t].ownedBy.indexOf(e);if(-1!==r){1===l[t].ownedBy.length?(l[t].atlas.dispose(),l.splice(t,1)):l[t].ownedBy.splice(r,1);break}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l("#ffffff"),n=l("#000000"),o=l("#ffffff"),s=l("#000000"),a={css:"rgba(255, 255, 255, 0.3)",rgba:4294967159};function l(e){return{css:e,rgba:parseInt(e.slice(1),16)<<8|255}}function c(e){var t=e.toString(16);return t.length<2?"0"+t:t}t.DEFAULT_ANSI_COLORS=function(){for(var e=[l("#2e3436"),l("#cc0000"),l("#4e9a06"),l("#c4a000"),l("#3465a4"),l("#75507b"),l("#06989a"),l("#d3d7cf"),l("#555753"),l("#ef2929"),l("#8ae234"),l("#fce94f"),l("#729fcf"),l("#ad7fa8"),l("#34e2e2"),l("#eeeeec")],t=[0,95,135,175,215,255],r=0;r<216;r++){var i=t[r/36%6|0],n=t[r/6%6|0],o=t[r%6];e.push({css:"#"+c(i)+c(n)+c(o),rgba:(i<<24|n<<16|o<<8|255)>>>0})}for(r=0;r<24;r++){var s=8+10*r,a=c(s);e.push({css:"#"+a+a+a,rgba:(s<<24|s<<16|s<<8|255)>>>0})}return e}();var h=function(){function e(e,r){this.allowTransparency=r;var l=e.createElement("canvas");l.width=1,l.height=1;var c=l.getContext("2d");if(!c)throw new Error("Could not get rendering context");this._ctx=c,this._ctx.globalCompositeOperation="copy",this._litmusColor=this._ctx.createLinearGradient(0,0,1,1),this.colors={foreground:i,background:n,cursor:o,cursorAccent:s,selection:a,ansi:t.DEFAULT_ANSI_COLORS.slice()}}return e.prototype.setTheme=function(e){void 0===e&&(e={}),this.colors.foreground=this._parseColor(e.foreground,i),this.colors.background=this._parseColor(e.background,n),this.colors.cursor=this._parseColor(e.cursor,o,!0),this.colors.cursorAccent=this._parseColor(e.cursorAccent,s,!0),this.colors.selection=this._parseColor(e.selection,a,!0),this.colors.ansi[0]=this._parseColor(e.black,t.DEFAULT_ANSI_COLORS[0]),this.colors.ansi[1]=this._parseColor(e.red,t.DEFAULT_ANSI_COLORS[1]),this.colors.ansi[2]=this._parseColor(e.green,t.DEFAULT_ANSI_COLORS[2]),this.colors.ansi[3]=this._parseColor(e.yellow,t.DEFAULT_ANSI_COLORS[3]),this.colors.ansi[4]=this._parseColor(e.blue,t.DEFAULT_ANSI_COLORS[4]),this.colors.ansi[5]=this._parseColor(e.magenta,t.DEFAULT_ANSI_COLORS[5]),this.colors.ansi[6]=this._parseColor(e.cyan,t.DEFAULT_ANSI_COLORS[6]),this.colors.ansi[7]=this._parseColor(e.white,t.DEFAULT_ANSI_COLORS[7]),this.colors.ansi[8]=this._parseColor(e.brightBlack,t.DEFAULT_ANSI_COLORS[8]),this.colors.ansi[9]=this._parseColor(e.brightRed,t.DEFAULT_ANSI_COLORS[9]),this.colors.ansi[10]=this._parseColor(e.brightGreen,t.DEFAULT_ANSI_COLORS[10]),this.colors.ansi[11]=this._parseColor(e.brightYellow,t.DEFAULT_ANSI_COLORS[11]),this.colors.ansi[12]=this._parseColor(e.brightBlue,t.DEFAULT_ANSI_COLORS[12]),this.colors.ansi[13]=this._parseColor(e.brightMagenta,t.DEFAULT_ANSI_COLORS[13]),this.colors.ansi[14]=this._parseColor(e.brightCyan,t.DEFAULT_ANSI_COLORS[14]),this.colors.ansi[15]=this._parseColor(e.brightWhite,t.DEFAULT_ANSI_COLORS[15])},e.prototype._parseColor=function(e,t,r){if(void 0===r&&(r=this.allowTransparency),void 0===e)return t;if(this._ctx.fillStyle=this._litmusColor,this._ctx.fillStyle=e,"string"!=typeof this._ctx.fillStyle)return console.warn("Color: "+e+" is invalid using fallback "+t.css),t;this._ctx.fillRect(0,0,1,1);var i=this._ctx.getImageData(0,0,1,1).data;return r||255===i[3]?{css:e,rgba:(i[0]<<24|i[1]<<16|i[2]<<8|i[3])>>>0}:(console.warn("Color: "+e+" is using transparency, but allowTransparency is false. Using fallback "+t.css+"."),t)},e}();t.ColorManager=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(11),n=r(9);function o(e,t){for(var r=!0,i=t.rgba>>>24,n=t.rgba>>>16&255,o=t.rgba>>>8&255,s=0;s<e.data.length;s+=4)e.data[s]===i&&e.data[s+1]===n&&e.data[s+2]===o?e.data[s+3]=0:r=!1;return r}function s(e,t){return e+" "+t.fontSize*t.devicePixelRatio+"px "+t.fontFamily}t.generateStaticCharAtlasTexture=function(e,t,r){var a=r.scaledCharWidth+n.CHAR_ATLAS_CELL_SPACING,l=r.scaledCharHeight+n.CHAR_ATLAS_CELL_SPACING,c=t(255*a,34*l),h=c.getContext("2d",{alpha:r.allowTransparency});h.fillStyle=r.colors.background.css,h.fillRect(0,0,c.width,c.height),h.save(),h.fillStyle=r.colors.foreground.css,h.font=s(r.fontWeight,r),h.textBaseline="middle";for(var u=0;u<256;u++)h.save(),h.beginPath(),h.rect(u*a,0,a,l),h.clip(),h.fillText(String.fromCharCode(u),u*a,l/2),h.restore();for(h.save(),h.font=s(r.fontWeightBold,r),u=0;u<256;u++)h.save(),h.beginPath(),h.rect(u*a,l,a,l),h.clip(),h.fillText(String.fromCharCode(u),u*a,1.5*l),h.restore();h.restore(),h.font=s(r.fontWeight,r);for(var f=0;f<16;f++){var d=(f+2)*l;for(u=0;u<256;u++)h.save(),h.beginPath(),h.rect(u*a,d,a,l),h.clip(),h.fillStyle=r.colors.ansi[f].css,h.fillText(String.fromCharCode(u),u*a,d+l/2),h.restore()}for(h.font=s(r.fontWeightBold,r),f=0;f<16;f++)for(d=(f+2+16)*l,u=0;u<256;u++)h.save(),h.beginPath(),h.rect(u*a,d,a,l),h.clip(),h.fillStyle=r.colors.ansi[f].css,h.fillText(String.fromCharCode(u),u*a,d+l/2),h.restore();if(h.restore(),!("createImageBitmap"in e)||i.isFirefox||i.isSafari)return c;var p=h.getImageData(0,0,c.width,c.height);return o(p,r.colors.background),e.createImageBitmap(p)},t.clearColor=o},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(7),s=function(e){function t(t,r,i){var n=e.call(this)||this;return n.content=0,n.combinedData="",n.fg=t.fg,n.bg=t.bg,n.combinedData=r,n._width=i,n}return n(t,e),t.prototype.isCombined=function(){return 2097152},t.prototype.getWidth=function(){return this._width},t.prototype.getChars=function(){return this.combinedData},t.prototype.getCode=function(){return 2097151},t.prototype.setFromCharData=function(e){throw new Error("not implemented")},t.prototype.getAsCharData=function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]},t}(o.AttributeData);t.JoinedCellData=s;var a=function(){function e(e){this._terminal=e,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new o.CellData}return e.prototype.registerCharacterJoiner=function(e){var t={id:this._nextCharacterJoinerId++,handler:e};return this._characterJoiners.push(t),t.id},e.prototype.deregisterCharacterJoiner=function(e){for(var t=0;t<this._characterJoiners.length;t++)if(this._characterJoiners[t].id===e)return this._characterJoiners.splice(t,1),!0;return!1},e.prototype.getJoinedCharacters=function(e){if(0===this._characterJoiners.length)return[];var t=this._terminal.buffer.lines.get(e);if(0===t.length)return[];for(var r=[],i=t.translateToString(!0),n=0,s=0,a=0,l=t.getFg(0),c=t.getBg(0),h=0;h<t.getTrimmedLength();h++)if(t.loadCell(h,this._workCell),0!==this._workCell.getWidth()){if(this._workCell.fg!==l||this._workCell.bg!==c){if(h-n>1)for(var u=this._getJoinedRanges(i,a,s,t,n),f=0;f<u.length;f++)r.push(u[f]);n=h,a=s,l=this._workCell.fg,c=this._workCell.bg}s+=this._workCell.getChars().length||o.WHITESPACE_CELL_CHAR.length}if(this._terminal.cols-n>1)for(u=this._getJoinedRanges(i,a,s,t,n),f=0;f<u.length;f++)r.push(u[f]);return r},e.prototype._getJoinedRanges=function(t,r,i,n,o){for(var s=t.substring(r,i),a=this._characterJoiners[0].handler(s),l=1;l<this._characterJoiners.length;l++)for(var c=this._characterJoiners[l].handler(s),h=0;h<c.length;h++)e._mergeRanges(a,c[h]);return this._stringRangesToCellRanges(a,n,o),a},e.prototype._stringRangesToCellRanges=function(e,t,r){var i=0,n=!1,s=0,a=e[i];if(a){for(var l=r;l<this._terminal.cols;l++){var c=t.getWidth(l),h=t.getString(l).length||o.WHITESPACE_CELL_CHAR.length;if(0!==c){if(!n&&a[0]<=s&&(a[0]=l,n=!0),a[1]<=s){if(a[1]=l,!(a=e[++i]))break;a[0]<=s?(a[0]=l,n=!0):n=!1}s+=h}}a&&(a[1]=this._terminal.cols)}},e._mergeRanges=function(e,t){for(var r=!1,i=0;i<e.length;i++){var n=e[i];if(r){if(t[1]<=n[0])return e[i-1][1]=t[1],e;if(t[1]<=n[1])return e[i-1][1]=Math.max(t[1],n[1]),e.splice(i,1),r=!1,e;e.splice(i,1),i--}else{if(t[1]<=n[0])return e.splice(i,0,t),e;if(t[1]<=n[1])return n[0]=Math.min(t[0],n[0]),e;t[0]<n[1]&&(n[0]=Math.min(t[0],n[0]),r=!0)}}return r?e[e.length-1][1]=t[1]:e.push(t),e},e}();t.CharacterJoinerRegistry=a},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),s=r(10),a=function(e){function t(t){var r=e.call(this)||this;return r._terminal=t,r._zones=[],r._areZonesActive=!1,r._tooltipTimeout=null,r._currentZone=null,r._lastHoverCoords=[null,null],r.register(s.addDisposableDomListener(r._terminal.element,"mousedown",function(e){return r._onMouseDown(e)})),r._mouseMoveListener=function(e){return r._onMouseMove(e)},r._mouseLeaveListener=function(e){return r._onMouseLeave(e)},r._clickListener=function(e){return r._onClick(e)},r}return n(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._deactivate()},t.prototype.add=function(e){this._zones.push(e),1===this._zones.length&&this._activate()},t.prototype.clearAll=function(e,t){if(0!==this._zones.length){t||(e=0,t=this._terminal.rows-1);for(var r=0;r<this._zones.length;r++){var i=this._zones[r];(i.y1>e&&i.y1<=t+1||i.y2>e&&i.y2<=t+1||i.y1<e&&i.y2>t+1)&&(this._currentZone&&this._currentZone===i&&(this._currentZone.leaveCallback(),this._currentZone=null),this._zones.splice(r--,1))}0===this._zones.length&&this._deactivate()}},t.prototype._activate=function(){this._areZonesActive||(this._areZonesActive=!0,this._terminal.element.addEventListener("mousemove",this._mouseMoveListener),this._terminal.element.addEventListener("mouseleave",this._mouseLeaveListener),this._terminal.element.addEventListener("click",this._clickListener))},t.prototype._deactivate=function(){this._areZonesActive&&(this._areZonesActive=!1,this._terminal.element.removeEventListener("mousemove",this._mouseMoveListener),this._terminal.element.removeEventListener("mouseleave",this._mouseLeaveListener),this._terminal.element.removeEventListener("click",this._clickListener))},t.prototype._onMouseMove=function(e){this._lastHoverCoords[0]===e.pageX&&this._lastHoverCoords[1]===e.pageY||(this._onHover(e),this._lastHoverCoords=[e.pageX,e.pageY])},t.prototype._onHover=function(e){var t=this,r=this._findZoneEventAt(e);r!==this._currentZone&&(this._currentZone&&(this._currentZone.leaveCallback(),this._currentZone=null,this._tooltipTimeout&&clearTimeout(this._tooltipTimeout)),r&&(this._currentZone=r,r.hoverCallback&&r.hoverCallback(e),this._tooltipTimeout=setTimeout(function(){return t._onTooltip(e)},500)))},t.prototype._onTooltip=function(e){this._tooltipTimeout=null;var t=this._findZoneEventAt(e);t&&t.tooltipCallback&&t.tooltipCallback(e)},t.prototype._onMouseDown=function(e){if(this._initialSelectionLength=this._terminal.getSelection().length,this._areZonesActive){var t=this._findZoneEventAt(e);t&&t.willLinkActivate(e)&&(e.preventDefault(),e.stopImmediatePropagation())}},t.prototype._onMouseLeave=function(e){this._currentZone&&(this._currentZone.leaveCallback(),this._currentZone=null,this._tooltipTimeout&&clearTimeout(this._tooltipTimeout))},t.prototype._onClick=function(e){var t=this._findZoneEventAt(e),r=this._terminal.getSelection().length;t&&r===this._initialSelectionLength&&(t.clickCallback(e),e.preventDefault(),e.stopImmediatePropagation())},t.prototype._findZoneEventAt=function(e){var t=this._terminal.mouseHelper.getCoords(e,this._terminal.screenElement,this._terminal.charMeasure,this._terminal.cols,this._terminal.rows);if(!t)return null;for(var r=t[0],i=t[1],n=0;n<this._zones.length;n++){var o=this._zones[n];if(o.y1===o.y2){if(i===o.y1&&r>=o.x1&&r<o.x2)return o}else if(i===o.y1&&r>=o.x1||i===o.y2&&r<o.x2||i>o.y1&&i<o.y2)return o}return null},t}(o.Disposable);t.MouseZoneManager=a;var l=function(e,t,r,i,n,o,s,a,l){this.x1=e,this.y1=t,this.x2=r,this.y2=i,this.clickCallback=n,this.hoverCallback=o,this.tooltipCallback=s,this.leaveCallback=a,this.willLinkActivate=l};t.MouseZone=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._renderCoordinator=e}return e.getCoordsRelativeToElement=function(e,t){var r=t.getBoundingClientRect();return[e.clientX-r.left,e.clientY-r.top]},e.prototype.getCoords=function(t,r,i,n,o,s){if(!i.width||!i.height)return null;var a=e.getCoordsRelativeToElement(t,r);return a?(a[0]=Math.ceil((a[0]+(s?this._renderCoordinator.dimensions.actualCellWidth/2:0))/this._renderCoordinator.dimensions.actualCellWidth),a[1]=Math.ceil(a[1]/this._renderCoordinator.dimensions.actualCellHeight),a[0]=Math.min(Math.max(a[0],1),n+(s?1:0)),a[1]=Math.min(Math.max(a[1],1),o),a):null},e.prototype.getRawByteCoords=function(e,t,r,i,n){var o=this.getCoords(e,t,r,i,n),s=o[0],a=o[1];return{x:s+=32,y:a+=32}},e}();t.MouseHelper=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._renderCallback=e}return e.prototype.dispose=function(){this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},e.prototype.refresh=function(e,t,r){var i=this;this._rowCount=r,e=void 0!==e?e:0,t=void 0!==t?t:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,e):e,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,t):t,this._animationFrame||(this._animationFrame=window.requestAnimationFrame(function(){return i._innerRefresh()}))},e.prototype._innerRefresh=function(){void 0!==this._rowStart&&void 0!==this._rowEnd&&void 0!==this._rowCount&&(this._rowStart=Math.max(this._rowStart,0),this._rowEnd=Math.min(this._rowEnd,this._rowCount-1),this._renderCallback(this._rowStart,this._rowEnd),this._rowStart=void 0,this._rowEnd=void 0,this._animationFrame=void 0)},e}();t.RenderDebouncer=i},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._currentDevicePixelRatio=window.devicePixelRatio,t}return n(t,e),t.prototype.setListener=function(e){var t=this;this._listener&&this.clearListener(),this._listener=e,this._outerListener=function(){t._listener&&(t._listener(window.devicePixelRatio,t._currentDevicePixelRatio),t._updateDpr())},this._updateDpr()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.clearListener()},t.prototype._updateDpr=function(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._currentDevicePixelRatio=window.devicePixelRatio,this._resolutionMediaMatchList=window.matchMedia("screen and (resolution: "+window.devicePixelRatio+"dppx)"),this._resolutionMediaMatchList.addListener(this._outerListener))},t.prototype.clearListener=function(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)},t}(r(6).Disposable);t.ScreenDprMonitor=o},function(e,t,r){!function(e){"use strict";function t(e){return new RegExp("^(("+e.join(")|(")+"))\\b")}var r,i=t(["and","or","not","is"]),n=["as","assert","break","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","lambda","pass","raise","return","try","while","with","yield","in"],o=["abs","all","any","bin","bool","bytearray","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip","__import__","NotImplemented","Ellipsis","__debug__"];function s(e){return e.scopes[e.scopes.length-1]}e.registerHelper("hintWords","python",n.concat(o)),e.defineMode("python",function(r,a){for(var l="error",c=a.delimiters||a.singleDelimiters||/^[\(\)\[\]\{\}@,:`=;\.\\]/,h=[a.singleOperators,a.doubleOperators,a.doubleDelimiters,a.tripleDelimiters,a.operators||/^([-+*\/%\/&|^]=?|[<>=]+|\/\/=?|\*\*=?|!=|[~!@]|\.\.\.)/],u=0;u<h.length;u++)h[u]||h.splice(u--,1);var f=a.hangingIndent||r.indentUnit,d=n,p=o;null!=a.extra_keywords&&(d=d.concat(a.extra_keywords)),null!=a.extra_builtins&&(p=p.concat(a.extra_builtins));var m=!(a.version&&Number(a.version)<3);if(m){var g=a.identifiers||/^[_A-Za-z\u00A1-\uFFFF][_A-Za-z0-9\u00A1-\uFFFF]*/;d=d.concat(["nonlocal","False","True","None","async","await"]),p=p.concat(["ascii","bytes","exec","print"]);var _=new RegExp("^(([rbuf]|(br)|(fr))?('{3}|\"{3}|['\"]))","i")}else{var g=a.identifiers||/^[_A-Za-z][_A-Za-z0-9]*/;d=d.concat(["exec","print"]),p=p.concat(["apply","basestring","buffer","cmp","coerce","execfile","file","intern","long","raw_input","reduce","reload","unichr","unicode","xrange","False","True","None"]);var _=new RegExp("^(([rubf]|(ur)|(br))?('{3}|\"{3}|['\"]))","i")}var v=t(d),y=t(p);function C(e,t){var r=e.sol()&&"\\"!=t.lastToken;if(r&&(t.indent=e.indentation()),r&&"py"==s(t).type){var i=s(t).offset;if(e.eatSpace()){var n=e.indentation();return n>i?w(t):n<i&&x(e,t)&&"#"!=e.peek()&&(t.errorToken=!0),null}var o=b(e,t);return i>0&&x(e,t)&&(o+=" "+l),o}return b(e,t)}function b(e,t){if(e.eatSpace())return null;if(e.match(/^#.*/))return"comment";if(e.match(/^[0-9\.]/,!1)){var r=!1;if(e.match(/^[\d_]*\.\d+(e[\+\-]?\d+)?/i)&&(r=!0),e.match(/^[\d_]+\.\d*/)&&(r=!0),e.match(/^\.\d+/)&&(r=!0),r)return e.eat(/J/i),"number";var n=!1;if(e.match(/^0x[0-9a-f_]+/i)&&(n=!0),e.match(/^0b[01_]+/i)&&(n=!0),e.match(/^0o[0-7_]+/i)&&(n=!0),e.match(/^[1-9][\d_]*(e[\+\-]?[\d_]+)?/)&&(e.eat(/J/i),n=!0),e.match(/^0(?![\dx])/i)&&(n=!0),n)return e.eat(/L/i),"number"}if(e.match(_)){var o=-1!==e.current().toLowerCase().indexOf("f");return o?(t.tokenize=function(e,t){for(;"rubf".indexOf(e.charAt(0).toLowerCase())>=0;)e=e.substr(1);var r=1==e.length,i="string";function n(e){return function(t,r){var i=b(t,r);return"punctuation"==i&&("{"==t.current()?r.tokenize=n(e+1):"}"==t.current()&&(r.tokenize=e>1?n(e-1):o)),i}}function o(o,s){for(;!o.eol();)if(o.eatWhile(/[^'"\{\}\\]/),o.eat("\\")){if(o.next(),r&&o.eol())return i}else{if(o.match(e))return s.tokenize=t,i;if(o.match("{{"))return i;if(o.match("{",!1))return s.tokenize=n(0),o.current()?i:s.tokenize(o,s);if(o.match("}}"))return i;if(o.match("}"))return l;o.eat(/['"]/)}if(r){if(a.singleLineStringErrors)return l;s.tokenize=t}return i}return o.isString=!0,o}(e.current(),t.tokenize),t.tokenize(e,t)):(t.tokenize=function(e,t){for(;"rubf".indexOf(e.charAt(0).toLowerCase())>=0;)e=e.substr(1);var r=1==e.length,i="string";function n(n,o){for(;!n.eol();)if(n.eatWhile(/[^'"\\]/),n.eat("\\")){if(n.next(),r&&n.eol())return i}else{if(n.match(e))return o.tokenize=t,i;n.eat(/['"]/)}if(r){if(a.singleLineStringErrors)return l;o.tokenize=t}return i}return n.isString=!0,n}(e.current(),t.tokenize),t.tokenize(e,t))}for(var s=0;s<h.length;s++)if(e.match(h[s]))return"operator";return e.match(c)?"punctuation":"."==t.lastToken&&e.match(g)?"property":e.match(v)||e.match(i)?"keyword":e.match(y)?"builtin":e.match(/^(self|cls)\b/)?"variable-2":e.match(g)?"def"==t.lastToken||"class"==t.lastToken?"def":"variable":(e.next(),l)}function w(e){for(;"py"!=s(e).type;)e.scopes.pop();e.scopes.push({offset:s(e).offset+r.indentUnit,type:"py",align:null})}function x(e,t){for(var r=e.indentation();t.scopes.length>1&&s(t).offset>r;){if("py"!=s(t).type)return!0;t.scopes.pop()}return s(t).offset!=r}function S(e,t){e.sol()&&(t.beginningOfLine=!0);var r=t.tokenize(e,t),i=e.current();if(t.beginningOfLine&&"@"==i)return e.match(g,!1)?"meta":m?"operator":l;if(/\S/.test(i)&&(t.beginningOfLine=!1),"variable"!=r&&"builtin"!=r||"meta"!=t.lastToken||(r="meta"),"pass"!=i&&"return"!=i||(t.dedent+=1),"lambda"==i&&(t.lambda=!0),":"!=i||t.lambda||"py"!=s(t).type||w(t),1==i.length&&!/string|comment/.test(r)){var n="[({".indexOf(i);if(-1!=n&&function(e,t,r){var i=e.match(/^([\s\[\{\(]|#.*)*$/,!1)?null:e.column()+1;t.scopes.push({offset:t.indent+f,type:r,align:i})}(e,t,"])}".slice(n,n+1)),-1!=(n="])}".indexOf(i))){if(s(t).type!=i)return l;t.indent=t.scopes.pop().offset-f}}return t.dedent>0&&e.eol()&&"py"==s(t).type&&(t.scopes.length>1&&t.scopes.pop(),t.dedent-=1),r}var L={startState:function(e){return{tokenize:C,scopes:[{offset:e||0,type:"py",align:null}],indent:e||0,lastToken:null,lambda:!1,dedent:0}},token:function(e,t){var r=t.errorToken;r&&(t.errorToken=!1);var i=S(e,t);return i&&"comment"!=i&&(t.lastToken="keyword"==i||"punctuation"==i?e.current():i),"punctuation"==i&&(i=null),e.eol()&&t.lambda&&(t.lambda=!1),r?i+" "+l:i},indent:function(t,r){if(t.tokenize!=C)return t.tokenize.isString?e.Pass:0;var i=s(t),n=i.type==r.charAt(0);return null!=i.align?i.align-(n?1:0):i.offset-(n?f:0)},electricInput:/^\s*[\}\]\)]$/,closeBrackets:{triples:"'\""},lineComment:"#",fold:"indent"};return L}),e.defineMIME("text/x-python","python"),e.defineMIME("text/x-cython",{name:"python",extra_keywords:(r="by cdef cimport cpdef ctypedef enum except extern gil include nogil property public readonly struct union DEF IF ELIF ELSE",r.split(" "))})}(r(15))},function(e,t,r){!function(e){"use strict";var t={},r=/[^\s\u00a0]/,i=e.Pos;function n(e){var t=e.search(r);return-1==t?0:t}function o(e,t){var r=e.getMode();return!1!==r.useInnerComments&&r.innerMode?e.getModeAt(t):r}e.commands.toggleComment=function(e){e.toggleComment()},e.defineExtension("toggleComment",function(e){e||(e=t);for(var r=1/0,n=this.listSelections(),o=null,s=n.length-1;s>=0;s--){var a=n[s].from(),l=n[s].to();a.line>=r||(l.line>=r&&(l=i(r,0)),r=a.line,null==o?this.uncomment(a,l,e)?o="un":(this.lineComment(a,l,e),o="line"):"un"==o?this.uncomment(a,l,e):this.lineComment(a,l,e))}}),e.defineExtension("lineComment",function(e,s,a){a||(a=t);var l=this,c=o(l,e),h=l.getLine(e.line);if(null!=h&&(u=e,f=h,!/\bstring\b/.test(l.getTokenTypeAt(i(u.line,0)))||/^[\'\"\`]/.test(f))){var u,f,d=a.lineComment||c.lineComment;if(d){var p=Math.min(0!=s.ch||s.line==e.line?s.line+1:s.line,l.lastLine()+1),m=null==a.padding?" ":a.padding,g=a.commentBlankLines||e.line==s.line;l.operation(function(){if(a.indent){for(var t=null,o=e.line;o<p;++o){var s=l.getLine(o),c=s.slice(0,n(s));(null==t||t.length>c.length)&&(t=c)}for(var o=e.line;o<p;++o){var s=l.getLine(o),h=t.length;(g||r.test(s))&&(s.slice(0,h)!=t&&(h=n(s)),l.replaceRange(t+d+m,i(o,0),i(o,h)))}}else for(var o=e.line;o<p;++o)(g||r.test(l.getLine(o)))&&l.replaceRange(d+m,i(o,0))})}else(a.blockCommentStart||c.blockCommentStart)&&(a.fullLines=!0,l.blockComment(e,s,a))}}),e.defineExtension("blockComment",function(e,n,s){s||(s=t);var a=this,l=o(a,e),c=s.blockCommentStart||l.blockCommentStart,h=s.blockCommentEnd||l.blockCommentEnd;if(c&&h){if(!/\bcomment\b/.test(a.getTokenTypeAt(i(e.line,0)))){var u=Math.min(n.line,a.lastLine());u!=e.line&&0==n.ch&&r.test(a.getLine(u))&&--u;var f=null==s.padding?" ":s.padding;e.line>u||a.operation(function(){if(0!=s.fullLines){var t=r.test(a.getLine(u));a.replaceRange(f+h,i(u)),a.replaceRange(c+f,i(e.line,0));var o=s.blockCommentLead||l.blockCommentLead;if(null!=o)for(var d=e.line+1;d<=u;++d)(d!=u||t)&&a.replaceRange(o+f,i(d,0))}else a.replaceRange(h,n),a.replaceRange(c,e)})}}else(s.lineComment||l.lineComment)&&0!=s.fullLines&&a.lineComment(e,n,s)}),e.defineExtension("uncomment",function(e,n,s){s||(s=t);var a,l=this,c=o(l,e),h=Math.min(0!=n.ch||n.line==e.line?n.line:n.line-1,l.lastLine()),u=Math.min(e.line,h),f=s.lineComment||c.lineComment,d=[],p=null==s.padding?" ":s.padding;e:if(f){for(var m=u;m<=h;++m){var g=l.getLine(m),_=g.indexOf(f);if(_>-1&&!/comment/.test(l.getTokenTypeAt(i(m,_+1)))&&(_=-1),-1==_&&r.test(g))break e;if(_>-1&&r.test(g.slice(0,_)))break e;d.push(g)}if(l.operation(function(){for(var e=u;e<=h;++e){var t=d[e-u],r=t.indexOf(f),n=r+f.length;r<0||(t.slice(n,n+p.length)==p&&(n+=p.length),a=!0,l.replaceRange("",i(e,r),i(e,n)))}}),a)return!0}var v=s.blockCommentStart||c.blockCommentStart,y=s.blockCommentEnd||c.blockCommentEnd;if(!v||!y)return!1;var C=s.blockCommentLead||c.blockCommentLead,b=l.getLine(u),w=b.indexOf(v);if(-1==w)return!1;var x=h==u?b:l.getLine(h),S=x.indexOf(y,h==u?w+v.length:0),L=i(u,w+1),k=i(h,S+1);if(-1==S||!/comment/.test(l.getTokenTypeAt(L))||!/comment/.test(l.getTokenTypeAt(k))||l.getRange(L,k,"\n").indexOf(y)>-1)return!1;var T=b.lastIndexOf(v,e.ch),A=-1==T?-1:b.slice(0,e.ch).indexOf(y,T+v.length);if(-1!=T&&-1!=A&&A+y.length!=e.ch)return!1;A=x.indexOf(y,n.ch);var E=x.slice(n.ch).lastIndexOf(v,A-n.ch);return T=-1==A||-1==E?-1:n.ch+E,(-1==A||-1==T||T==n.ch)&&(l.operation(function(){l.replaceRange("",i(h,S-(p&&x.slice(S-p.length,S)==p?p.length:0)),i(h,S+y.length));var e=w+v.length;if(p&&b.slice(e,e+p.length)==p&&(e+=p.length),l.replaceRange("",i(u,w),i(u,e)),C)for(var t=u+1;t<=h;++t){var n=l.getLine(t),o=n.indexOf(C);if(-1!=o&&!r.test(n.slice(0,o))){var s=o+C.length;p&&n.slice(s,s+p.length)==p&&(s+=p.length),l.replaceRange("",i(t,o),i(t,s))}}}),!0)})}(r(15))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(34),n=r(19),o=r(69),s=function(){function e(e){this._core=new i.Terminal(e),this._addonManager=new o.AddonManager}return Object.defineProperty(e.prototype,"onCursorMove",{get:function(){return this._core.onCursorMove},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onLineFeed",{get:function(){return this._core.onLineFeed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onSelectionChange",{get:function(){return this._core.onSelectionChange},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onData",{get:function(){return this._core.onData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onTitleChange",{get:function(){return this._core.onTitleChange},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onScroll",{get:function(){return this._core.onScroll},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onKey",{get:function(){return this._core.onKey},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onRender",{get:function(){return this._core.onRender},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onResize",{get:function(){return this._core.onResize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this._core.element},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textarea",{get:function(){return this._core.textarea},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rows",{get:function(){return this._core.rows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cols",{get:function(){return this._core.cols},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buffer",{get:function(){return new a(this._core.buffer)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"markers",{get:function(){return this._core.markers},enumerable:!0,configurable:!0}),e.prototype.blur=function(){this._core.blur()},e.prototype.focus=function(){this._core.focus()},e.prototype.on=function(e,t){this._core.on(e,t)},e.prototype.off=function(e,t){this._core.off(e,t)},e.prototype.emit=function(e,t){this._core.emit(e,t)},e.prototype.addDisposableListener=function(e,t){return this._core.addDisposableListener(e,t)},e.prototype.resize=function(e,t){this._core.resize(e,t)},e.prototype.writeln=function(e){this._core.writeln(e)},e.prototype.open=function(e){this._core.open(e)},e.prototype.attachCustomKeyEventHandler=function(e){this._core.attachCustomKeyEventHandler(e)},e.prototype.addCsiHandler=function(e,t){return this._core.addCsiHandler(e,t)},e.prototype.addOscHandler=function(e,t){return this._core.addOscHandler(e,t)},e.prototype.registerLinkMatcher=function(e,t,r){return this._core.registerLinkMatcher(e,t,r)},e.prototype.deregisterLinkMatcher=function(e){this._core.deregisterLinkMatcher(e)},e.prototype.registerCharacterJoiner=function(e){return this._core.registerCharacterJoiner(e)},e.prototype.deregisterCharacterJoiner=function(e){this._core.deregisterCharacterJoiner(e)},e.prototype.addMarker=function(e){return this._core.addMarker(e)},e.prototype.hasSelection=function(){return this._core.hasSelection()},e.prototype.select=function(e,t,r){this._core.select(e,t,r)},e.prototype.getSelection=function(){return this._core.getSelection()},e.prototype.getSelectionPosition=function(){return this._core.getSelectionPosition()},e.prototype.clearSelection=function(){this._core.clearSelection()},e.prototype.selectAll=function(){this._core.selectAll()},e.prototype.selectLines=function(e,t){this._core.selectLines(e,t)},e.prototype.dispose=function(){this._addonManager.dispose(),this._core.dispose()},e.prototype.destroy=function(){this._core.destroy()},e.prototype.scrollLines=function(e){this._core.scrollLines(e)},e.prototype.scrollPages=function(e){this._core.scrollPages(e)},e.prototype.scrollToTop=function(){this._core.scrollToTop()},e.prototype.scrollToBottom=function(){this._core.scrollToBottom()},e.prototype.scrollToLine=function(e){this._core.scrollToLine(e)},e.prototype.clear=function(){this._core.clear()},e.prototype.write=function(e){this._core.write(e)},e.prototype.writeUtf8=function(e){this._core.writeUtf8(e)},e.prototype.getOption=function(e){return this._core.getOption(e)},e.prototype.setOption=function(e,t){this._core.setOption(e,t)},e.prototype.refresh=function(e,t){this._core.refresh(e,t)},e.prototype.reset=function(){this._core.reset()},e.applyAddon=function(t){t.apply(e)},e.prototype.loadAddon=function(e){return this._addonManager.loadAddon(this,e)},Object.defineProperty(e,"strings",{get:function(){return n},enumerable:!0,configurable:!0}),e}();t.Terminal=s;var a=function(){function e(e){this._buffer=e}return Object.defineProperty(e.prototype,"cursorY",{get:function(){return this._buffer.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cursorX",{get:function(){return this._buffer.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewportY",{get:function(){return this._buffer.ydisp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseY",{get:function(){return this._buffer.ybase},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._buffer.lines.length},enumerable:!0,configurable:!0}),e.prototype.getLine=function(e){var t=this._buffer.lines.get(e);if(t)return new l(t)},e}(),l=function(){function e(e){this._line=e}return Object.defineProperty(e.prototype,"isWrapped",{get:function(){return this._line.isWrapped},enumerable:!0,configurable:!0}),e.prototype.getCell=function(e){if(!(e<0||e>=this._line.length))return new c(this._line,e)},e.prototype.translateToString=function(e,t,r){return this._line.translateToString(e,t,r)},e}(),c=function(){function e(e,t){this._line=e,this._x=t}return Object.defineProperty(e.prototype,"char",{get:function(){return this._line.getString(this._x)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._line.getWidth(this._x)},enumerable:!0,configurable:!0}),e}()},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(35),s=r(20),a=r(39),l=r(40),c=r(41),h=r(42),u=r(13),f=r(43),d=r(46),p=r(56),m=r(57),g=r(60),_=r(11),v=r(10),y=r(19),C=r(28),b=r(61),w=r(27),x=r(62),S=r(23),L=r(63),k=r(65),T=r(66),A=r(8),E=r(7),M=r(67),D=r(24),R=r(68),O="undefined"!=typeof window?window.document:null,H=["cols","rows"],P={cols:80,rows:24,convertEol:!1,termName:"xterm",cursorBlink:!1,cursorStyle:"block",bellSound:b.DEFAULT_BELL_SOUND,bellStyle:"none",drawBoldTextInBrightColors:!0,enableBold:!0,experimentalCharAtlas:"static",fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,letterSpacing:0,scrollback:1e3,screenKeys:!1,screenReaderMode:!1,debug:!1,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,cancelEvents:!1,disableStdin:!1,useFlowControl:!1,allowTransparency:!1,tabStopWidth:8,theme:void 0,rightClickSelectsWord:_.isMac,rendererType:"canvas",windowsMode:!1},B=function(e){function t(t){void 0===t&&(t={});var r=e.call(this)||this;return r.browser=_,r._blankLine=null,r._onCursorMove=new A.EventEmitter2,r._onData=new A.EventEmitter2,r._onKey=new A.EventEmitter2,r._onLineFeed=new A.EventEmitter2,r._onRender=new A.EventEmitter2,r._onResize=new A.EventEmitter2,r._onScroll=new A.EventEmitter2,r._onSelectionChange=new A.EventEmitter2,r._onTitleChange=new A.EventEmitter2,r.options=T.clone(t),r._setup(),r.onCursorMove(function(){return r.emit("cursormove")}),r.onData(function(e){return r.emit("data",e)}),r.onKey(function(e){return r.emit("key",e.key,e.domEvent)}),r.onLineFeed(function(){return r.emit("linefeed")}),r.onRender(function(e){return r.emit("refresh",e)}),r.onResize(function(e){return r.emit("resize",e)}),r.onSelectionChange(function(){return r.emit("selection")}),r.onScroll(function(e){return r.emit("scroll",e)}),r.onTitleChange(function(e){return r.emit("title",e)}),r}return n(t,e),Object.defineProperty(t.prototype,"onCursorMove",{get:function(){return this._onCursorMove.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onData",{get:function(){return this._onData.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onKey",{get:function(){return this._onKey.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onLineFeed",{get:function(){return this._onLineFeed.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onRender",{get:function(){return this._onRender.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onResize",{get:function(){return this._onResize.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onScroll",{get:function(){return this._onScroll.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onSelectionChange",{get:function(){return this._onSelectionChange.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onTitleChange",{get:function(){return this._onTitleChange.event},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._windowsMode&&(this._windowsMode.dispose(),this._windowsMode=void 0),this._customKeyEventHandler=null,S.removeTerminalFromCache(this),this.handler=function(){},this.write=function(){},this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)},t.prototype.destroy=function(){this.dispose()},t.prototype._setup=function(){var e=this;Object.keys(P).forEach(function(t){null!==e.options[t]&&void 0!==e.options[t]||(e.options[t]=P[t])}),this._parent=O?O.body:null,this.cols=Math.max(this.options.cols,2),this.rows=Math.max(this.options.rows,1),this.options.handler&&this.onData(this.options.handler),this.cursorState=0,this.cursorHidden=!1,this._customKeyEventHandler=null,this.applicationKeypad=!1,this.applicationCursor=!1,this.originMode=!1,this.insertMode=!1,this.wraparoundMode=!0,this.bracketedPasteMode=!1,this.charset=null,this.gcharset=null,this.glevel=0,this.charsets=[null],this.curAttrData=E.DEFAULT_ATTR_DATA.clone(),this._eraseAttrData=E.DEFAULT_ATTR_DATA.clone(),this.params=[],this.currentParam=0,this.writeBuffer=[],this.writeBufferUtf8=[],this._writeInProgress=!1,this._xoffSentToCatchUp=!1,this._userScrolling=!1,this._inputHandler=new f.InputHandler(this),this._inputHandler.onCursorMove(function(){return e._onCursorMove.fire()}),this._inputHandler.onLineFeed(function(){return e._onLineFeed.fire()}),this._inputHandler.onData(function(t){return e._onData.fire(t)}),this.register(this._inputHandler),this.selectionManager=this.selectionManager||null,this.linkifier=this.linkifier||new p.Linkifier(this),this._mouseZoneManager=this._mouseZoneManager||null,this.soundManager=this.soundManager||new b.SoundManager(this),this.buffers=new o.BufferSet(this),this.selectionManager&&(this.selectionManager.clearSelection(),this.selectionManager.initBuffersListeners()),this.options.windowsMode&&(this._windowsMode=M.applyWindowsMode(this))},Object.defineProperty(t.prototype,"buffer",{get:function(){return this.buffers.active},enumerable:!0,configurable:!0}),t.prototype.eraseAttrData=function(){return this._eraseAttrData.bg&=-67108864,this._eraseAttrData.bg|=67108863&this.curAttrData.bg,this._eraseAttrData},t.prototype.focus=function(){this.textarea&&this.textarea.focus({preventScroll:!0})},Object.defineProperty(t.prototype,"isFocused",{get:function(){return O.activeElement===this.textarea&&O.hasFocus()},enumerable:!0,configurable:!0}),t.prototype.getOption=function(e){if(!(e in P))throw new Error('No option with key "'+e+'"');return this.options[e]},t.prototype.setOption=function(e,t){if(!(e in P))throw new Error('No option with key "'+e+'"');if(-1!==H.indexOf(e)&&console.error('Option "'+e+'" can only be set in the constructor'),this.options[e]!==t){switch(e){case"bellStyle":t||(t="none");break;case"cursorStyle":t||(t="block");break;case"fontWeight":t||(t="normal");break;case"fontWeightBold":t||(t="bold");break;case"lineHeight":if(t<1)return void console.warn(e+" cannot be less than 1, value: "+t);case"rendererType":t||(t="canvas");break;case"tabStopWidth":if(t<1)return void console.warn(e+" cannot be less than 1, value: "+t);break;case"theme":this._setTheme(t);break;case"scrollback":if((t=Math.min(t,s.MAX_BUFFER_SIZE))<0)return void console.warn(e+" cannot be less than 0, value: "+t);if(this.options[e]!==t){var r=this.rows+t;if(this.buffer.lines.length>r){var i=this.buffer.lines.length-r,n=this.buffer.ydisp-i<0;this.buffer.lines.trimStart(i),this.buffer.ybase=Math.max(this.buffer.ybase-i,0),this.buffer.ydisp=Math.max(this.buffer.ydisp-i,0),n&&this.refresh(0,this.rows-1)}}}switch(this.options[e]=t,e){case"fontFamily":case"fontSize":this._renderCoordinator&&(this._renderCoordinator.clear(),this.charMeasure.measure(this.options));break;case"drawBoldTextInBrightColors":case"experimentalCharAtlas":case"enableBold":case"letterSpacing":case"lineHeight":case"fontWeight":case"fontWeightBold":this._renderCoordinator&&(this._renderCoordinator.clear(),this._renderCoordinator.onResize(this.cols,this.rows),this.refresh(0,this.rows-1));break;case"rendererType":this._renderCoordinator&&this._renderCoordinator.setRenderer(this._createRenderer());break;case"scrollback":this.buffers.resize(this.cols,this.rows),this.viewport&&this.viewport.syncScrollArea();break;case"screenReaderMode":t?!this._accessibilityManager&&this._renderCoordinator&&(this._accessibilityManager=new x.AccessibilityManager(this,this._renderCoordinator.dimensions)):this._accessibilityManager&&(this._accessibilityManager.dispose(),this._accessibilityManager=null);break;case"tabStopWidth":this.buffers.setupTabStops();break;case"windowsMode":t?this._windowsMode||(this._windowsMode=M.applyWindowsMode(this)):this._windowsMode&&(this._windowsMode.dispose(),this._windowsMode=void 0)}this._renderCoordinator&&this._renderCoordinator.onOptionsChanged()}},t.prototype._onTextAreaFocus=function(e){this.sendFocus&&this.handler(u.C0.ESC+"[I"),this.updateCursorStyle(e),this.element.classList.add("focus"),this.showCursor(),this.emit("focus")},t.prototype.blur=function(){return this.textarea.blur()},t.prototype._onTextAreaBlur=function(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.sendFocus&&this.handler(u.C0.ESC+"[O"),this.element.classList.remove("focus"),this.emit("blur")},t.prototype._initGlobal=function(){var e=this;this._bindKeys(),this.register(v.addDisposableDomListener(this.element,"copy",function(t){e.hasSelection()&&h.copyHandler(t,e,e.selectionManager)}));var t=function(t){return h.pasteHandler(t,e)};this.register(v.addDisposableDomListener(this.textarea,"paste",t)),this.register(v.addDisposableDomListener(this.element,"paste",t)),_.isFirefox?this.register(v.addDisposableDomListener(this.element,"mousedown",function(t){2===t.button&&h.rightClickHandler(t,e,e.selectionManager,e.options.rightClickSelectsWord)})):this.register(v.addDisposableDomListener(this.element,"contextmenu",function(t){h.rightClickHandler(t,e,e.selectionManager,e.options.rightClickSelectsWord)})),_.isLinux&&this.register(v.addDisposableDomListener(this.element,"auxclick",function(t){1===t.button&&h.moveTextAreaUnderMouseCursor(t,e)}))},t.prototype._bindKeys=function(){var e=this,t=this;this.register(v.addDisposableDomListener(this.element,"keydown",function(e){O.activeElement===this&&t._keyDown(e)},!0)),this.register(v.addDisposableDomListener(this.element,"keypress",function(e){O.activeElement===this&&t._keyPress(e)},!0)),this.register(v.addDisposableDomListener(this.element,"keyup",function(r){(function(e){return 16===e.keyCode||17===e.keyCode||18===e.keyCode})(r)||e.focus(),t._keyUp(r)},!0)),this.register(v.addDisposableDomListener(this.textarea,"keydown",function(t){return e._keyDown(t)},!0)),this.register(v.addDisposableDomListener(this.textarea,"keypress",function(t){return e._keyPress(t)},!0)),this.register(v.addDisposableDomListener(this.textarea,"compositionstart",function(){return e._compositionHelper.compositionstart()})),this.register(v.addDisposableDomListener(this.textarea,"compositionupdate",function(t){return e._compositionHelper.compositionupdate(t)})),this.register(v.addDisposableDomListener(this.textarea,"compositionend",function(){return e._compositionHelper.compositionend()})),this.register(this.onRender(function(){return e._compositionHelper.updateCompositionElements()})),this.register(this.onRender(function(t){return e._queueLinkification(t.start,t.end)}))},t.prototype.open=function(e){var t=this;if(this._parent=e||this._parent,!this._parent)throw new Error("Terminal requires a parent element.");this._context=this._parent.ownerDocument.defaultView,this._document=this._parent.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),this.element.setAttribute("tabindex","0"),this._parent.appendChild(this.element);var r=O.createDocumentFragment();this._viewportElement=O.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),r.appendChild(this._viewportElement),this._viewportScrollArea=O.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=O.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=O.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),r.appendChild(this.screenElement),this._mouseZoneManager=new w.MouseZoneManager(this),this.register(this._mouseZoneManager),this.register(this.onScroll(function(){return t._mouseZoneManager.clearAll()})),this.linkifier.attachToDom(this._mouseZoneManager),this.textarea=O.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",y.promptLabel),this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this.register(v.addDisposableDomListener(this.textarea,"focus",function(e){return t._onTextAreaFocus(e)})),this.register(v.addDisposableDomListener(this.textarea,"blur",function(){return t._onTextAreaBlur()})),this._helperContainer.appendChild(this.textarea),this._compositionView=O.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=new a.CompositionHelper(this.textarea,this._compositionView,this),this._helperContainer.appendChild(this._compositionView),this.charMeasure=new g.CharMeasure(O,this._helperContainer),this.element.appendChild(r),this._theme=this.options.theme,this._colorManager=new D.ColorManager(O,this.options.allowTransparency),this._colorManager.setTheme(this._theme);var i=this._createRenderer();this._renderCoordinator=new R.RenderCoordinator(i,this.rows,this.screenElement),this._renderCoordinator.onRender(function(e){return t._onRender.fire(e)}),this.onResize(function(e){return t._renderCoordinator.resize(e.cols,e.rows)}),this.viewport=new c.Viewport(this,this._viewportElement,this._viewportScrollArea,this.charMeasure,this._renderCoordinator.dimensions),this.viewport.onThemeChange(this._colorManager.colors),this.register(this.viewport),this.register(this.onCursorMove(function(){return t._renderCoordinator.onCursorMove()})),this.register(this.onResize(function(){return t._renderCoordinator.onResize(t.cols,t.rows)})),this.register(this.addDisposableListener("blur",function(){return t._renderCoordinator.onBlur()})),this.register(this.addDisposableListener("focus",function(){return t._renderCoordinator.onFocus()})),this.register(this.charMeasure.onCharSizeChanged(function(){return t._renderCoordinator.onCharSizeChanged()})),this.register(this._renderCoordinator.onDimensionsChange(function(){return t.viewport.syncScrollArea()})),this.selectionManager=new m.SelectionManager(this,this.charMeasure),this.register(this.selectionManager.onSelectionChange(function(){return t._onSelectionChange.fire()})),this.register(v.addDisposableDomListener(this.element,"mousedown",function(e){return t.selectionManager.onMouseDown(e)})),this.register(this.selectionManager.onRedrawRequest(function(e){return t._renderCoordinator.onSelectionChanged(e.start,e.end,e.columnSelectMode)})),this.register(this.selectionManager.onLinuxMouseSelection(function(e){t.textarea.value=e,t.textarea.focus(),t.textarea.select()})),this.register(this.onScroll(function(){t.viewport.syncScrollArea(),t.selectionManager.refresh()})),this.register(v.addDisposableDomListener(this._viewportElement,"scroll",function(){return t.selectionManager.refresh()})),this.mouseHelper=new C.MouseHelper(this._renderCoordinator),this.element.classList.toggle("enable-mouse-events",this.mouseEvents),this.mouseEvents?this.selectionManager.disable():this.selectionManager.enable(),this.options.screenReaderMode&&(this._accessibilityManager=new x.AccessibilityManager(this,this._renderCoordinator.dimensions),this._accessibilityManager.register(this._renderCoordinator.onDimensionsChange(function(e){return t._accessibilityManager.setDimensions(e)}))),this.charMeasure.measure(this.options),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()},t.prototype._createRenderer=function(){switch(this.options.rendererType){case"canvas":return new d.Renderer(this,this._colorManager.colors);case"dom":return new L.DomRenderer(this,this._colorManager.colors);default:throw new Error('Unrecognized rendererType "'+this.options.rendererType+'"')}},t.prototype._setTheme=function(e){this._theme=e,this._colorManager&&this._colorManager.setTheme(e),this._renderCoordinator&&this._renderCoordinator.setColors(this._colorManager.colors),this.viewport&&this.viewport.onThemeChange(this._colorManager.colors)},t.prototype.bindMouse=function(){var e=this,t=this.element,r=this,i=32;function n(e){var t,n;if(t=function(e){var t,i,n,o,s;switch(e.overrideType||e.type){case"mousedown":t=null!==e.button&&void 0!==e.button?+e.button:null!==e.which&&void 0!==e.which?e.which-1:null,_.isMSIE&&(t=1===t?0:4===t?1:t);break;case"mouseup":t=3;break;case"DOMMouseScroll":t=e.detail<0?64:65;break;case"wheel":t=e.deltaY<0?64:65}i=e.shiftKey?4:0,n=e.metaKey?8:0,o=e.ctrlKey?16:0,s=i|n|o,r.vt200Mouse?s&=o:r.normalMouse||(s=0);return t=32+(s<<2)+t}(e),n=r.mouseHelper.getRawByteCoords(e,r.screenElement,r.charMeasure,r.cols,r.rows))switch(s(t,n),e.overrideType||e.type){case"mousedown":i=t;break;case"mouseup":i=32}}function o(e,t){if(r.utfMouse){if(t>2047)return void e.push(2047);e.push(t)}else{if(255===t)return void e.push(0);t>127&&(t=127),e.push(t)}}function s(e,t){if(r._vt300Mouse){e&=3,t.x-=32,t.y-=32;var i=u.C0.ESC+"[24";if(0===e)i+="1";else if(1===e)i+="3";else if(2===e)i+="5";else{if(3===e)return;i+="0"}return i+="~["+t.x+","+t.y+"]\r",void r.handler(i)}if(r._decLocator)return e&=3,t.x-=32,t.y-=32,0===e?e=2:1===e?e=4:2===e?e=6:3===e&&(e=3),void r.handler(u.C0.ESC+"["+e+";"+(3===e?4:0)+";"+t.y+";"+t.x+";"+t.page||"0&w");if(r.urxvtMouse)return t.x-=32,t.y-=32,t.x++,t.y++,void r.handler(u.C0.ESC+"["+e+";"+t.x+";"+t.y+"M");if(r.sgrMouse)return t.x-=32,t.y-=32,void r.handler(u.C0.ESC+"[<"+((3==(3&e)?-4&e:e)-32)+";"+t.x+";"+t.y+(3==(3&e)?"m":"M"));var n=[];o(n,e),o(n,t.x),o(n,t.y),r.handler(u.C0.ESC+"[M"+String.fromCharCode.apply(String,n))}this.register(v.addDisposableDomListener(t,"mousedown",function(t){if(t.preventDefault(),e.focus(),e.mouseEvents&&!e.selectionManager.shouldForceSelection(t)){if(n(t),e.vt200Mouse)return t.overrideType="mouseup",n(t),e.cancel(t);var o;e.normalMouse&&(o=function(t){e.normalMouse&&function(e){var t=i,n=r.mouseHelper.getRawByteCoords(e,r.screenElement,r.charMeasure,r.cols,r.rows);n&&s(t+=32,n)}(t)},e._document.addEventListener("mousemove",o));var a=function(t){return e.normalMouse&&!e.x10Mouse&&n(t),o&&(e._document.removeEventListener("mousemove",o),o=null),e._document.removeEventListener("mouseup",a),e.cancel(t)};return e._document.addEventListener("mouseup",a),e.cancel(t)}})),this.register(v.addDisposableDomListener(t,"wheel",function(t){if(e.mouseEvents)e.x10Mouse||e._vt300Mouse||e._decLocator||(n(t),t.preventDefault());else if(!e.buffer.hasScrollback){var r=e.viewport.getLinesScrolled(t);if(0===r)return;for(var i=u.C0.ESC+(e.applicationCursor?"O":"[")+(t.deltaY<0?"A":"B"),o="",s=0;s<Math.abs(r);s++)o+=i;e.handler(o)}})),this.register(v.addDisposableDomListener(t,"wheel",function(t){if(!e.mouseEvents)return e.viewport.onWheel(t),e.cancel(t)})),this.register(v.addDisposableDomListener(t,"touchstart",function(t){if(!e.mouseEvents)return e.viewport.onTouchStart(t),e.cancel(t)})),this.register(v.addDisposableDomListener(t,"touchmove",function(t){if(!e.mouseEvents)return e.viewport.onTouchMove(t),e.cancel(t)}))},t.prototype.refresh=function(e,t){this._renderCoordinator&&this._renderCoordinator.refreshRows(e,t)},t.prototype._queueLinkification=function(e,t){this.linkifier&&this.linkifier.linkifyRows(e,t)},t.prototype.updateCursorStyle=function(e){this.selectionManager&&this.selectionManager.shouldColumnSelect(e)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")},t.prototype.showCursor=function(){this.cursorState||(this.cursorState=1,this.refresh(this.buffer.y,this.buffer.y))},t.prototype.scroll=function(e){var t;void 0===e&&(e=!1),t=this._blankLine;var r=this.eraseAttrData();t&&t.length===this.cols&&t.getFg(0)===r.fg&&t.getBg(0)===r.bg||(t=this.buffer.getBlankLine(r,e),this._blankLine=t),t.isWrapped=e;var i=this.buffer.ybase+this.buffer.scrollTop,n=this.buffer.ybase+this.buffer.scrollBottom;if(0===this.buffer.scrollTop){var o=this.buffer.lines.isFull;n===this.buffer.lines.length-1?o?this.buffer.lines.recycle().copyFrom(t):this.buffer.lines.push(t.clone()):this.buffer.lines.splice(n+1,0,t.clone()),o?this._userScrolling&&(this.buffer.ydisp=Math.max(this.buffer.ydisp-1,0)):(this.buffer.ybase++,this._userScrolling||this.buffer.ydisp++)}else{var s=n-i+1;this.buffer.lines.shiftElements(i+1,s-1,-1),this.buffer.lines.set(n,t.clone())}this._userScrolling||(this.buffer.ydisp=this.buffer.ybase),this.updateRange(this.buffer.scrollTop),this.updateRange(this.buffer.scrollBottom),this._onScroll.fire(this.buffer.ydisp)},t.prototype.scrollLines=function(e,t){if(e<0){if(0===this.buffer.ydisp)return;this._userScrolling=!0}else e+this.buffer.ydisp>=this.buffer.ybase&&(this._userScrolling=!1);var r=this.buffer.ydisp;this.buffer.ydisp=Math.max(Math.min(this.buffer.ydisp+e,this.buffer.ybase),0),r!==this.buffer.ydisp&&(t||this._onScroll.fire(this.buffer.ydisp),this.refresh(0,this.rows-1))},t.prototype.scrollPages=function(e){this.scrollLines(e*(this.rows-1))},t.prototype.scrollToTop=function(){this.scrollLines(-this.buffer.ydisp)},t.prototype.scrollToBottom=function(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)},t.prototype.scrollToLine=function(e){var t=e-this.buffer.ydisp;0!==t&&this.scrollLines(t)},t.prototype.writeUtf8=function(e){var t=this;this._isDisposed||e&&(this.writeBufferUtf8.push(e),this.options.useFlowControl&&!this._xoffSentToCatchUp&&this.writeBufferUtf8.length>=5&&(this.handler(u.C0.DC3),this._xoffSentToCatchUp=!0),!this._writeInProgress&&this.writeBufferUtf8.length>0&&(this._writeInProgress=!0,setTimeout(function(){t._innerWriteUtf8()})))},t.prototype._innerWriteUtf8=function(e){var t=this;void 0===e&&(e=0),this._isDisposed&&(this.writeBufferUtf8=[]);for(var r=Date.now();this.writeBufferUtf8.length>e;){var i=this.writeBufferUtf8[e];if(e++,this._xoffSentToCatchUp&&this.writeBufferUtf8.length===e&&(this.handler(u.C0.DC1),this._xoffSentToCatchUp=!1),this._refreshStart=this.buffer.y,this._refreshEnd=this.buffer.y,this._inputHandler.parseUtf8(i),this.updateRange(this.buffer.y),this.refresh(this._refreshStart,this._refreshEnd),Date.now()-r>=12)break}this.writeBufferUtf8.length>e?(e>50&&(this.writeBufferUtf8=this.writeBufferUtf8.slice(e),e=0),setTimeout(function(){return t._innerWriteUtf8(e)},0)):(this._writeInProgress=!1,this.writeBufferUtf8=[])},t.prototype.write=function(e){var t=this;this._isDisposed||e&&(this.writeBuffer.push(e),this.options.useFlowControl&&!this._xoffSentToCatchUp&&this.writeBuffer.length>=5&&(this.handler(u.C0.DC3),this._xoffSentToCatchUp=!0),!this._writeInProgress&&this.writeBuffer.length>0&&(this._writeInProgress=!0,setTimeout(function(){t._innerWrite()})))},t.prototype._innerWrite=function(e){var t=this;void 0===e&&(e=0),this._isDisposed&&(this.writeBuffer=[]);for(var r=Date.now();this.writeBuffer.length>e;){var i=this.writeBuffer[e];if(e++,this._xoffSentToCatchUp&&this.writeBuffer.length===e&&(this.handler(u.C0.DC1),this._xoffSentToCatchUp=!1),this._refreshStart=this.buffer.y,this._refreshEnd=this.buffer.y,this._inputHandler.parse(i),this.updateRange(this.buffer.y),this.refresh(this._refreshStart,this._refreshEnd),Date.now()-r>=12)break}this.writeBuffer.length>e?(e>50&&(this.writeBuffer=this.writeBuffer.slice(e),e=0),setTimeout(function(){return t._innerWrite(e)},0)):(this._writeInProgress=!1,this.writeBuffer=[])},t.prototype.writeln=function(e){this.write(e+"\r\n")},t.prototype.attachCustomKeyEventHandler=function(e){this._customKeyEventHandler=e},t.prototype.addCsiHandler=function(e,t){return this._inputHandler.addCsiHandler(e,t)},t.prototype.addOscHandler=function(e,t){return this._inputHandler.addOscHandler(e,t)},t.prototype.registerLinkMatcher=function(e,t,r){var i=this.linkifier.registerLinkMatcher(e,t,r);return this.refresh(0,this.rows-1),i},t.prototype.deregisterLinkMatcher=function(e){this.linkifier.deregisterLinkMatcher(e)&&this.refresh(0,this.rows-1)},t.prototype.registerCharacterJoiner=function(e){var t=this._renderCoordinator.registerCharacterJoiner(e);return this.refresh(0,this.rows-1),t},t.prototype.deregisterCharacterJoiner=function(e){this._renderCoordinator.deregisterCharacterJoiner(e)&&this.refresh(0,this.rows-1)},Object.defineProperty(t.prototype,"markers",{get:function(){return this.buffer.markers},enumerable:!0,configurable:!0}),t.prototype.addMarker=function(e){if(this.buffer===this.buffers.normal)return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+e)},t.prototype.hasSelection=function(){return!!this.selectionManager&&this.selectionManager.hasSelection},t.prototype.select=function(e,t,r){this.selectionManager.setSelection(e,t,r)},t.prototype.getSelection=function(){return this.selectionManager?this.selectionManager.selectionText:""},t.prototype.getSelectionPosition=function(){if(this.selectionManager.hasSelection)return{startColumn:this.selectionManager.selectionStart[0],startRow:this.selectionManager.selectionStart[1],endColumn:this.selectionManager.selectionEnd[0],endRow:this.selectionManager.selectionEnd[1]}},t.prototype.clearSelection=function(){this.selectionManager&&this.selectionManager.clearSelection()},t.prototype.selectAll=function(){this.selectionManager&&this.selectionManager.selectAll()},t.prototype.selectLines=function(e,t){this.selectionManager&&this.selectionManager.selectLines(e,t)},t.prototype._keyDown=function(e){if(this._customKeyEventHandler&&!1===this._customKeyEventHandler(e))return!1;if(!this._compositionHelper.keydown(e))return this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;var t=k.evaluateKeyboardEvent(e,this.applicationCursor,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(e),3===t.type||2===t.type){var r=this.rows-1;return this.scrollLines(2===t.type?-r:r),this.cancel(e,!0)}return 1===t.type&&this.selectAll(),!!this._isThirdLevelShift(this.browser,e)||(t.cancel&&this.cancel(e,!0),!t.key||(this.emit("keydown",e),this._onKey.fire({key:t.key,domEvent:e}),this.showCursor(),this.handler(t.key),this.cancel(e,!0)))},t.prototype._isThirdLevelShift=function(e,t){var r=e.isMac&&!this.options.macOptionIsMeta&&t.altKey&&!t.ctrlKey&&!t.metaKey||e.isMSWindows&&t.altKey&&t.ctrlKey&&!t.metaKey;return"keypress"===t.type?r:r&&(!t.keyCode||t.keyCode>47)},t.prototype.setgLevel=function(e){this.glevel=e,this.charset=this.charsets[e]},t.prototype.setgCharset=function(e,t){this.charsets[e]=t,this.glevel===e&&(this.charset=t)},t.prototype._keyUp=function(e){this.updateCursorStyle(e)},t.prototype._keyPress=function(e){var t;if(this._customKeyEventHandler&&!1===this._customKeyEventHandler(e))return!1;if(this.cancel(e),e.charCode)t=e.charCode;else if(null===e.which||void 0===e.which)t=e.keyCode;else{if(0===e.which||0===e.charCode)return!1;t=e.which}return!(!t||(e.altKey||e.ctrlKey||e.metaKey)&&!this._isThirdLevelShift(this.browser,e))&&(t=String.fromCharCode(t),this.emit("keypress",t,e),this._onKey.fire({key:t,domEvent:e}),this.showCursor(),this.handler(t),!0)},t.prototype.bell=function(){var e=this;this.emit("bell"),this._soundBell()&&this.soundManager.playBellSound(),this._visualBell()&&(this.element.classList.add("visual-bell-active"),clearTimeout(this._visualBellTimer),this._visualBellTimer=window.setTimeout(function(){e.element.classList.remove("visual-bell-active")},200))},t.prototype.log=function(e,t){this.options.debug&&this._context.console&&this._context.console.log&&this._context.console.log(e,t)},t.prototype.error=function(e,t){this.options.debug&&this._context.console&&this._context.console.error&&this._context.console.error(e,t)},t.prototype.resize=function(e,t){isNaN(e)||isNaN(t)||(e!==this.cols||t!==this.rows?(e<2&&(e=2),t<1&&(t=1),this.buffers.resize(e,t),this.cols=e,this.rows=t,this.buffers.setupTabStops(this.cols),this.charMeasure&&this.charMeasure.measure(this.options),this.refresh(0,this.rows-1),this._onResize.fire({cols:e,rows:t})):!this.charMeasure||this.charMeasure.width&&this.charMeasure.height||this.charMeasure.measure(this.options))},t.prototype.updateRange=function(e){e<this._refreshStart&&(this._refreshStart=e),e>this._refreshEnd&&(this._refreshEnd=e)},t.prototype.maxRange=function(){this._refreshStart=0,this._refreshEnd=this.rows-1},t.prototype.clear=function(){if(0!==this.buffer.ybase||0!==this.buffer.y){this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(var e=1;e<this.rows;e++)this.buffer.lines.push(this.buffer.getBlankLine(E.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire(this.buffer.ydisp)}},t.prototype.is=function(e){return 0===(this.options.termName+"").indexOf(e)},t.prototype.handler=function(e){this.options.disableStdin||(this.selectionManager&&this.selectionManager.hasSelection&&this.selectionManager.clearSelection(),this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),this._onData.fire(e))},t.prototype.handleTitle=function(e){this._onTitleChange.fire(e)},t.prototype.index=function(){this.buffer.y++,this.buffer.y>this.buffer.scrollBottom&&(this.buffer.y--,this.scroll()),this.buffer.x>=this.cols&&this.buffer.x--},t.prototype.reverseIndex=function(){if(this.buffer.y===this.buffer.scrollTop){var e=this.buffer.scrollBottom-this.buffer.scrollTop;this.buffer.lines.shiftElements(this.buffer.y+this.buffer.ybase,e,1),this.buffer.lines.set(this.buffer.y+this.buffer.ybase,this.buffer.getBlankLine(this.eraseAttrData())),this.updateRange(this.buffer.scrollTop),this.updateRange(this.buffer.scrollBottom)}else this.buffer.y--},t.prototype.reset=function(){this.options.rows=this.rows,this.options.cols=this.cols;var e=this._customKeyEventHandler,t=this._inputHandler,r=this.cursorState,i=this.writeBuffer,n=this.writeBufferUtf8,o=this._writeInProgress,s=this._xoffSentToCatchUp,a=this._userScrolling;this._setup(),this._customKeyEventHandler=e,this._inputHandler=t,this.cursorState=r,this.writeBuffer=i,this.writeBufferUtf8=n,this._writeInProgress=o,this._xoffSentToCatchUp=s,this._userScrolling=a,this.refresh(0,this.rows-1),this.viewport&&this.viewport.syncScrollArea()},t.prototype.tabSet=function(){this.buffer.tabs[this.buffer.x]=!0},t.prototype.cancel=function(e,t){if(this.options.cancelEvents||t)return e.preventDefault(),e.stopPropagation(),!1},t.prototype._visualBell=function(){return!1},t.prototype._soundBell=function(){return"sound"===this.options.bellStyle},t}(l.EventEmitter);t.Terminal=B},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(20),n=r(8),o=function(){function e(e){this._terminal=e,this._onBufferActivate=new n.EventEmitter2,this._normal=new i.Buffer(this._terminal,!0),this._normal.fillViewportRows(),this._alt=new i.Buffer(this._terminal,!1),this._activeBuffer=this._normal,this.setupTabStops()}return Object.defineProperty(e.prototype,"onBufferActivate",{get:function(){return this._onBufferActivate.event},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alt",{get:function(){return this._alt},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"active",{get:function(){return this._activeBuffer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"normal",{get:function(){return this._normal},enumerable:!0,configurable:!0}),e.prototype.activateNormalBuffer=function(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))},e.prototype.activateAltBuffer=function(e){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(e),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))},e.prototype.resize=function(e,t){this._normal.resize(e,t),this._alt.resize(e,t)},e.prototype.setupTabStops=function(e){this._normal.setupTabStops(e),this._alt.setupTabStops(e)},e}();t.BufferSet=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(8),n=function(){function e(e){this._maxLength=e,this.onDeleteEmitter=new i.EventEmitter2,this.onInsertEmitter=new i.EventEmitter2,this.onTrimEmitter=new i.EventEmitter2,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}return Object.defineProperty(e.prototype,"onDelete",{get:function(){return this.onDeleteEmitter.event},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onInsert",{get:function(){return this.onInsertEmitter.event},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onTrim",{get:function(){return this.onTrimEmitter.event},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxLength",{get:function(){return this._maxLength},set:function(e){if(this._maxLength!==e){for(var t=new Array(e),r=0;r<Math.min(e,this.length);r++)t[r]=this._array[this._getCyclicIndex(r)];this._array=t,this._maxLength=e,this._startIndex=0}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._length},set:function(e){if(e>this._length)for(var t=this._length;t<e;t++)this._array[t]=void 0;this._length=e},enumerable:!0,configurable:!0}),e.prototype.get=function(e){return this._array[this._getCyclicIndex(e)]},e.prototype.set=function(e,t){this._array[this._getCyclicIndex(e)]=t},e.prototype.push=function(e){this._array[this._getCyclicIndex(this._length)]=e,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++},e.prototype.recycle=function(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]},Object.defineProperty(e.prototype,"isFull",{get:function(){return this._length===this._maxLength},enumerable:!0,configurable:!0}),e.prototype.pop=function(){return this._array[this._getCyclicIndex(this._length---1)]},e.prototype.splice=function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t){for(var n=e;n<this._length-t;n++)this._array[this._getCyclicIndex(n)]=this._array[this._getCyclicIndex(n+t)];this._length-=t}for(n=this._length-1;n>=e;n--)this._array[this._getCyclicIndex(n+r.length)]=this._array[this._getCyclicIndex(n)];for(n=0;n<r.length;n++)this._array[this._getCyclicIndex(e+n)]=r[n];if(this._length+r.length>this._maxLength){var o=this._length+r.length-this._maxLength;this._startIndex+=o,this._length=this._maxLength,this.onTrimEmitter.fire(o)}else this._length+=r.length},e.prototype.trimStart=function(e){e>this._length&&(e=this._length),this._startIndex+=e,this._length-=e,this.onTrimEmitter.fire(e)},e.prototype.shiftElements=function(e,t,r){if(!(t<=0)){if(e<0||e>=this._length)throw new Error("start argument out of range");if(e+r<0)throw new Error("Cannot shift elements in list beyond index 0");if(r>0){for(var i=t-1;i>=0;i--)this.set(e+i+r,this.get(e+i));var n=e+t+r-this._length;if(n>0)for(this._length+=n;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(i=0;i<t;i++)this.set(e+i+r,this.get(e+i))}},e.prototype._getCyclicIndex=function(e){return(this._startIndex+e)%this._maxLength},e}();t.CircularList=n},function(e,t,r){"use strict";function i(e,t,r){if(t===e.length-1)return e[t].getTrimmedLength();var i=!e[t].hasContent(r-1)&&1===e[t].getWidth(r-1),n=2===e[t+1].getWidth(0);return i&&n?r-1:r}Object.defineProperty(t,"__esModule",{value:!0}),t.reflowLargerGetLinesToRemove=function(e,t,r,n,o){for(var s=[],a=0;a<e.length-1;a++){var l=a,c=e.get(++l);if(c.isWrapped){for(var h=[e.get(a)];l<e.length&&c.isWrapped;)h.push(c),c=e.get(++l);if(n>=a&&n<l)a+=h.length-1;else{for(var u=0,f=i(h,u,t),d=1,p=0;d<h.length;){var m=i(h,d,t),g=m-p,_=r-f,v=Math.min(g,_);h[u].copyCellsFrom(h[d],p,f,v,!1),(f+=v)===r&&(u++,f=0),(p+=v)===m&&(d++,p=0),0===f&&0!==u&&2===h[u-1].getWidth(r-1)&&(h[u].copyCellsFrom(h[u-1],r-1,f++,1,!1),h[u-1].setCell(r-1,o))}h[u].replaceCells(f,r,o);for(var y=0,C=h.length-1;C>0&&(C>u||0===h[C].getTrimmedLength());C--)y++;y>0&&(s.push(a+h.length-y),s.push(y)),a+=h.length-1}}}return s},t.reflowLargerCreateNewLayout=function(e,t){for(var r=[],i=0,n=t[i],o=0,s=0;s<e.length;s++)if(n===s){var a=t[++i];e.onDeleteEmitter.fire({index:s-o,amount:a}),s+=a-1,o+=a,n=t[++i]}else r.push(s);return{layout:r,countRemoved:o}},t.reflowLargerApplyNewLayout=function(e,t){for(var r=[],i=0;i<t.length;i++)r.push(e.get(t[i]));for(i=0;i<r.length;i++)e.set(i,r[i]);e.length=t.length},t.reflowSmallerGetNewLineLengths=function(e,t,r){for(var n=[],o=e.map(function(r,n){return i(e,n,t)}).reduce(function(e,t){return e+t}),s=0,a=0,l=0;l<o;){if(o-l<r){n.push(o-l);break}s+=r;var c=i(e,a,t);s>c&&(s-=c,a++);var h=2===e[a].getWidth(s-1);h&&s--;var u=h?r-1:r;n.push(u),l+=u}return n},t.getWrappedLineTrimmedLength=i},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(8),s=function(e){function t(r){var i=e.call(this)||this;return i.line=r,i._id=t._nextId++,i.isDisposed=!1,i._onDispose=new o.EventEmitter2,i}return n(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onDispose",{get:function(){return this._onDispose.event},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._onDispose.fire())},t._nextId=1,t}(r(6).Disposable);t.Marker=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,r){this._textarea=e,this._compositionView=t,this._terminal=r,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:null,end:null}}return e.prototype.compositionstart=function(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._compositionView.classList.add("active")},e.prototype.compositionupdate=function(e){var t=this;this._compositionView.textContent=e.data,this.updateCompositionElements(),setTimeout(function(){t._compositionPosition.end=t._textarea.value.length},0)},e.prototype.compositionend=function(){this._finalizeComposition(!0)},e.prototype.keydown=function(e){if(this._isComposing||this._isSendingComposition){if(229===e.keyCode)return!1;if(16===e.keyCode||17===e.keyCode||18===e.keyCode)return!1;this._finalizeComposition(!1)}return 229!==e.keyCode||(this._handleAnyTextareaChanges(),!1)},e.prototype._finalizeComposition=function(e){var t=this;if(this._compositionView.classList.remove("active"),this._isComposing=!1,this._clearTextareaPosition(),e){var r={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(function(){if(t._isSendingComposition){t._isSendingComposition=!1;var e=void 0;e=t._isComposing?t._textarea.value.substring(r.start,r.end):t._textarea.value.substring(r.start),t._terminal.handler(e)}},0)}else{this._isSendingComposition=!1;var i=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._terminal.handler(i)}},e.prototype._handleAnyTextareaChanges=function(){var e=this,t=this._textarea.value;setTimeout(function(){if(!e._isComposing){var r=e._textarea.value.replace(t,"");r.length>0&&e._terminal.handler(r)}},0)},e.prototype.updateCompositionElements=function(e){var t=this;if(this._isComposing){if(this._terminal.buffer.isCursorInViewport){var r=Math.ceil(this._terminal.charMeasure.height*this._terminal.options.lineHeight),i=this._terminal.buffer.y*r,n=this._terminal.buffer.x*this._terminal.charMeasure.width;this._compositionView.style.left=n+"px",this._compositionView.style.top=i+"px",this._compositionView.style.height=r+"px",this._compositionView.style.lineHeight=r+"px",this._compositionView.style.fontFamily=this._terminal.options.fontFamily,this._compositionView.style.fontSize=this._terminal.options.fontSize+"px";var o=this._compositionView.getBoundingClientRect();this._textarea.style.left=n+"px",this._textarea.style.top=i+"px",this._textarea.style.width=o.width+"px",this._textarea.style.height=o.height+"px",this._textarea.style.lineHeight=o.height+"px"}e||setTimeout(function(){return t.updateCompositionElements(!0)},0)}},e.prototype._clearTextareaPosition=function(){this._textarea.style.left="",this._textarea.style.top=""},e}();t.CompositionHelper=i},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){var t=e.call(this)||this;return t._events=t._events||{},t}return n(t,e),t.prototype.on=function(e,t){this._events[e]=this._events[e]||[],this._events[e].push(t)},t.prototype.addDisposableListener=function(e,t){var r=this;this.on(e,t);var i=!1;return{dispose:function(){i||(r.off(e,t),i=!0)}}},t.prototype.off=function(e,t){if(this._events[e])for(var r=this._events[e],i=r.length;i--;)if(r[i]===t)return void r.splice(i,1)},t.prototype.removeAllListeners=function(e){this._events[e]&&delete this._events[e]},t.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(this._events[e])for(var i=this._events[e],n=0;n<i.length;n++)i[n].apply(this,t)},t.prototype.emitMayRemoveListeners=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(this._events[e])for(var i=this._events[e],n=i.length,o=0;o<i.length;o++)i[o].apply(this,t),o-=n-i.length,n=i.length},t.prototype.listeners=function(e){return this._events[e]||[]},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._events={}},t}(r(6).Disposable);t.EventEmitter=o},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),s=r(10),a=15,l=function(e){function t(t,r,i,n,o){var l=e.call(this)||this;return l._terminal=t,l._viewportElement=r,l._scrollArea=i,l._charMeasure=n,l._dimensions=o,l.scrollBarWidth=0,l._currentRowHeight=0,l._lastRecordedBufferLength=0,l._lastRecordedViewportHeight=0,l._lastRecordedBufferHeight=0,l._lastScrollTop=0,l._wheelPartialScroll=0,l._refreshAnimationFrame=null,l._ignoreNextScrollEvent=!1,l.scrollBarWidth=l._viewportElement.offsetWidth-l._scrollArea.offsetWidth||a,l.register(s.addDisposableDomListener(l._viewportElement,"scroll",l._onScroll.bind(l))),setTimeout(function(){return l.syncScrollArea()},0),l}return n(t,e),t.prototype.onDimensionsChance=function(e){this._dimensions=e},t.prototype.onThemeChange=function(e){this._viewportElement.style.backgroundColor=e.background.css},t.prototype._refresh=function(){var e=this;null===this._refreshAnimationFrame&&(this._refreshAnimationFrame=requestAnimationFrame(function(){return e._innerRefresh()}))},t.prototype._innerRefresh=function(){if(this._charMeasure.height>0){this._currentRowHeight=this._dimensions.scaledCellHeight/window.devicePixelRatio,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;var e=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._dimensions.canvasHeight);this._lastRecordedBufferHeight!==e&&(this._lastRecordedBufferHeight=e,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}var t=this._terminal.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==t&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=t),this._refreshAnimationFrame=null},t.prototype.syncScrollArea=function(){if(this._lastRecordedBufferLength!==this._terminal.buffer.lines.length)return this._lastRecordedBufferLength=this._terminal.buffer.lines.length,void this._refresh();if(this._lastRecordedViewportHeight===this._dimensions.canvasHeight){var e=this._terminal.buffer.ydisp*this._currentRowHeight;this._lastScrollTop===e&&this._lastScrollTop===this._viewportElement.scrollTop&&this._dimensions.scaledCellHeight/window.devicePixelRatio===this._currentRowHeight||this._refresh()}else this._refresh()},t.prototype._onScroll=function(e){if(this._lastScrollTop=this._viewportElement.scrollTop,this._viewportElement.offsetParent)if(this._ignoreNextScrollEvent)this._ignoreNextScrollEvent=!1;else{var t=Math.round(this._lastScrollTop/this._currentRowHeight)-this._terminal.buffer.ydisp;this._terminal.scrollLines(t,!0)}},t.prototype.onWheel=function(e){var t=this._getPixelsScrolled(e);0!==t&&(this._viewportElement.scrollTop+=t,e.preventDefault())},t.prototype._getPixelsScrolled=function(e){if(0===e.deltaY)return 0;var t=e.deltaY;return e.deltaMode===WheelEvent.DOM_DELTA_LINE?t*=this._currentRowHeight:e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._currentRowHeight*this._terminal.rows),t},t.prototype.getLinesScrolled=function(e){if(0===e.deltaY)return 0;var t=e.deltaY;return e.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(t/=this._currentRowHeight+0,this._wheelPartialScroll+=t,t=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._terminal.rows),t},t.prototype.onTouchStart=function(e){this._lastTouchY=e.touches[0].pageY},t.prototype.onTouchMove=function(e){var t=this._lastTouchY-e.touches[0].pageY;this._lastTouchY=e.touches[0].pageY,0!==t&&(this._viewportElement.scrollTop+=t,e.preventDefault())},t}(o.Disposable);t.Viewport=l},function(e,t,r){"use strict";function i(e){return e.replace(/\r?\n/g,"\r")}function n(e,t){return t?"[200~"+e+"[201~":e}function o(e,t){var r=t.screenElement.getBoundingClientRect(),i=e.clientX-r.left-10,n=e.clientY-r.top-10;t.textarea.style.position="absolute",t.textarea.style.width="20px",t.textarea.style.height="20px",t.textarea.style.left=i+"px",t.textarea.style.top=n+"px",t.textarea.style.zIndex="1000",t.textarea.focus(),setTimeout(function(){t.textarea.style.position=null,t.textarea.style.width=null,t.textarea.style.height=null,t.textarea.style.left=null,t.textarea.style.top=null,t.textarea.style.zIndex=null},200)}Object.defineProperty(t,"__esModule",{value:!0}),t.prepareTextForTerminal=i,t.bracketTextForPaste=n,t.copyHandler=function(e,t,r){t.browser.isMSIE?window.clipboardData.setData("Text",r.selectionText):e.clipboardData.setData("text/plain",r.selectionText),e.preventDefault()},t.pasteHandler=function(e,t){e.stopPropagation();var r=function(r){r=n(r=i(r),t.bracketedPasteMode),t.handler(r),t.textarea.value="",t.emit("paste",r),t.cancel(e)};t.browser.isMSIE?window.clipboardData&&r(window.clipboardData.getData("Text")):e.clipboardData&&r(e.clipboardData.getData("text/plain"))},t.moveTextAreaUnderMouseCursor=o,t.rightClickHandler=function(e,t,r,i){o(e,t),i&&!r.isClickInSelection(e)&&r.selectWordAtCursor(e),t.textarea.value=r.selectionText,t.textarea.select()}},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(13),s=r(44),a=r(21),l=r(45),c=r(6),h=r(22),u=r(16),f=r(7),d=r(8),p={"(":0,")":1,"*":2,"+":3,"-":1,".":2},m=function(){function e(e){this._terminal=e,this._data=new Uint32Array(0)}return e.prototype.hook=function(e,t,r){this._data=new Uint32Array(0)},e.prototype.put=function(e,t,r){this._data=h.concat(this._data,e.subarray(t,r))},e.prototype.unhook=function(){var e=u.utf32ToString(this._data);switch(this._data=new Uint32Array(0),e){case'"q':return this._terminal.handler(o.C0.ESC+'P1$r0"q'+o.C0.ESC+"\\");case'"p':return this._terminal.handler(o.C0.ESC+'P1$r61"p'+o.C0.ESC+"\\");case"r":var t=this._terminal.buffer.scrollTop+1+";"+(this._terminal.buffer.scrollBottom+1)+"r";return this._terminal.handler(o.C0.ESC+"P1$r"+t+o.C0.ESC+"\\");case"m":return this._terminal.handler(o.C0.ESC+"P1$r0m"+o.C0.ESC+"\\");case" q":var r={block:2,underline:4,bar:6}[this._terminal.getOption("cursorStyle")];return r-=this._terminal.getOption("cursorBlink"),this._terminal.handler(o.C0.ESC+"P1$r"+r+" q"+o.C0.ESC+"\\");default:this._terminal.error("Unknown DCS $q %s",e),this._terminal.handler(o.C0.ESC+"P0$r"+o.C0.ESC+"\\")}},e}(),g=function(e){function t(t,r){void 0===r&&(r=new l.EscapeSequenceParser);var i=e.call(this)||this;i._terminal=t,i._parser=r,i._parseBuffer=new Uint32Array(4096),i._stringDecoder=new u.StringToUtf32,i._utf8Decoder=new u.Utf8ToUtf32,i._workCell=new f.CellData,i._onCursorMove=new d.EventEmitter2,i._onData=new d.EventEmitter2,i._onLineFeed=new d.EventEmitter2,i._onScroll=new d.EventEmitter2,i.register(i._parser),i._parser.setCsiHandlerFallback(function(e,t,r){i._terminal.error("Unknown CSI code: ",{collect:e,params:t,flag:String.fromCharCode(r)})}),i._parser.setEscHandlerFallback(function(e,t){i._terminal.error("Unknown ESC code: ",{collect:e,flag:String.fromCharCode(t)})}),i._parser.setExecuteHandlerFallback(function(e){i._terminal.error("Unknown EXECUTE code: ",{code:e})}),i._parser.setOscHandlerFallback(function(e,t){i._terminal.error("Unknown OSC code: ",{identifier:e,data:t})}),i._parser.setPrintHandler(function(e,t,r){return i.print(e,t,r)}),i._parser.setCsiHandler("@",function(e,t){return i.insertChars(e)}),i._parser.setCsiHandler("A",function(e,t){return i.cursorUp(e)}),i._parser.setCsiHandler("B",function(e,t){return i.cursorDown(e)}),i._parser.setCsiHandler("C",function(e,t){return i.cursorForward(e)}),i._parser.setCsiHandler("D",function(e,t){return i.cursorBackward(e)}),i._parser.setCsiHandler("E",function(e,t){return i.cursorNextLine(e)}),i._parser.setCsiHandler("F",function(e,t){return i.cursorPrecedingLine(e)}),i._parser.setCsiHandler("G",function(e,t){return i.cursorCharAbsolute(e)}),i._parser.setCsiHandler("H",function(e,t){return i.cursorPosition(e)}),i._parser.setCsiHandler("I",function(e,t){return i.cursorForwardTab(e)}),i._parser.setCsiHandler("J",function(e,t){return i.eraseInDisplay(e)}),i._parser.setCsiHandler("K",function(e,t){return i.eraseInLine(e)}),i._parser.setCsiHandler("L",function(e,t){return i.insertLines(e)}),i._parser.setCsiHandler("M",function(e,t){return i.deleteLines(e)}),i._parser.setCsiHandler("P",function(e,t){return i.deleteChars(e)}),i._parser.setCsiHandler("S",function(e,t){return i.scrollUp(e)}),i._parser.setCsiHandler("T",function(e,t){return i.scrollDown(e,t)}),i._parser.setCsiHandler("X",function(e,t){return i.eraseChars(e)}),i._parser.setCsiHandler("Z",function(e,t){return i.cursorBackwardTab(e)}),i._parser.setCsiHandler("`",function(e,t){return i.charPosAbsolute(e)}),i._parser.setCsiHandler("a",function(e,t){return i.hPositionRelative(e)}),i._parser.setCsiHandler("b",function(e,t){return i.repeatPrecedingCharacter(e)}),i._parser.setCsiHandler("c",function(e,t){return i.sendDeviceAttributes(e,t)}),i._parser.setCsiHandler("d",function(e,t){return i.linePosAbsolute(e)}),i._parser.setCsiHandler("e",function(e,t){return i.vPositionRelative(e)}),i._parser.setCsiHandler("f",function(e,t){return i.hVPosition(e)}),i._parser.setCsiHandler("g",function(e,t){return i.tabClear(e)}),i._parser.setCsiHandler("h",function(e,t){return i.setMode(e,t)}),i._parser.setCsiHandler("l",function(e,t){return i.resetMode(e,t)}),i._parser.setCsiHandler("m",function(e,t){return i.charAttributes(e)}),i._parser.setCsiHandler("n",function(e,t){return i.deviceStatus(e,t)}),i._parser.setCsiHandler("p",function(e,t){return i.softReset(e,t)}),i._parser.setCsiHandler("q",function(e,t){return i.setCursorStyle(e,t)}),i._parser.setCsiHandler("r",function(e,t){return i.setScrollRegion(e,t)}),i._parser.setCsiHandler("s",function(e,t){return i.saveCursor(e)}),i._parser.setCsiHandler("u",function(e,t){return i.restoreCursor(e)}),i._parser.setExecuteHandler(o.C0.BEL,function(){return i.bell()}),i._parser.setExecuteHandler(o.C0.LF,function(){return i.lineFeed()}),i._parser.setExecuteHandler(o.C0.VT,function(){return i.lineFeed()}),i._parser.setExecuteHandler(o.C0.FF,function(){return i.lineFeed()}),i._parser.setExecuteHandler(o.C0.CR,function(){return i.carriageReturn()}),i._parser.setExecuteHandler(o.C0.BS,function(){return i.backspace()}),i._parser.setExecuteHandler(o.C0.HT,function(){return i.tab()}),i._parser.setExecuteHandler(o.C0.SO,function(){return i.shiftOut()}),i._parser.setExecuteHandler(o.C0.SI,function(){return i.shiftIn()}),i._parser.setExecuteHandler(o.C1.IND,function(){return i.index()}),i._parser.setExecuteHandler(o.C1.NEL,function(){return i.nextLine()}),i._parser.setExecuteHandler(o.C1.HTS,function(){return i.tabSet()}),i._parser.setOscHandler(0,function(e){return i.setTitle(e)}),i._parser.setOscHandler(2,function(e){return i.setTitle(e)}),i._parser.setEscHandler("7",function(){return i.saveCursor([])}),i._parser.setEscHandler("8",function(){return i.restoreCursor([])}),i._parser.setEscHandler("D",function(){return i.index()}),i._parser.setEscHandler("E",function(){return i.nextLine()}),i._parser.setEscHandler("H",function(){return i.tabSet()}),i._parser.setEscHandler("M",function(){return i.reverseIndex()}),i._parser.setEscHandler("=",function(){return i.keypadApplicationMode()}),i._parser.setEscHandler(">",function(){return i.keypadNumericMode()}),i._parser.setEscHandler("c",function(){return i.reset()}),i._parser.setEscHandler("n",function(){return i.setgLevel(2)}),i._parser.setEscHandler("o",function(){return i.setgLevel(3)}),i._parser.setEscHandler("|",function(){return i.setgLevel(3)}),i._parser.setEscHandler("}",function(){return i.setgLevel(2)}),i._parser.setEscHandler("~",function(){return i.setgLevel(1)}),i._parser.setEscHandler("%@",function(){return i.selectDefaultCharset()}),i._parser.setEscHandler("%G",function(){return i.selectDefaultCharset()});var n=function(e){a._parser.setEscHandler("("+e,function(){return i.selectCharset("("+e)}),a._parser.setEscHandler(")"+e,function(){return i.selectCharset(")"+e)}),a._parser.setEscHandler("*"+e,function(){return i.selectCharset("*"+e)}),a._parser.setEscHandler("+"+e,function(){return i.selectCharset("+"+e)}),a._parser.setEscHandler("-"+e,function(){return i.selectCharset("-"+e)}),a._parser.setEscHandler("."+e,function(){return i.selectCharset("."+e)}),a._parser.setEscHandler("/"+e,function(){return i.selectCharset("/"+e)})},a=this;for(var c in s.CHARSETS)n(c);return i._parser.setErrorHandler(function(e){return i._terminal.error("Parsing error: ",e),e}),i._parser.setDcsHandler("$q",new m(i._terminal)),i}return n(t,e),Object.defineProperty(t.prototype,"onCursorMove",{get:function(){return this._onCursorMove.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onData",{get:function(){return this._onData.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onLineFeed",{get:function(){return this._onLineFeed.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onScroll",{get:function(){return this._onScroll.event},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._terminal=null},t.prototype.parse=function(e){if(this._terminal){var t=this._terminal.buffer,r=t.x,i=t.y;this._terminal.debug&&this._terminal.log("data: "+e),this._parseBuffer.length<e.length&&(this._parseBuffer=new Uint32Array(e.length)),this._parser.parse(this._parseBuffer,this._stringDecoder.decode(e,this._parseBuffer)),(t=this._terminal.buffer).x===r&&t.y===i||this._onCursorMove.fire()}},t.prototype.parseUtf8=function(e){if(this._terminal){var t=this._terminal.buffer,r=t.x,i=t.y;this._terminal.debug&&this._terminal.log("data: "+e),this._parseBuffer.length<e.length&&(this._parseBuffer=new Uint32Array(e.length)),this._parser.parse(this._parseBuffer,this._utf8Decoder.decode(e,this._parseBuffer)),(t=this._terminal.buffer).x===r&&t.y===i||this._terminal.emit("cursormove")}},t.prototype.print=function(e,t,r){var i,n,o=this._terminal.buffer,s=this._terminal.charset,l=this._terminal.options.screenReaderMode,c=this._terminal.cols,h=this._terminal.wraparoundMode,d=this._terminal.insertMode,p=this._terminal.curAttrData,m=o.lines.get(o.y+o.ybase);this._terminal.updateRange(o.y);for(var g=t;g<r;++g){if(i=e[g],n=a.wcwidth(i),i<127&&s){var _=s[String.fromCharCode(i)];_&&(i=_.charCodeAt(0))}if(l&&this._terminal.emit("a11y.char",u.stringFromCodePoint(i)),n||!o.x){if(o.x+n-1>=c)if(h)o.x=0,o.y++,o.y>o.scrollBottom?(o.y--,this._terminal.scroll(!0)):o.lines.get(o.y).isWrapped=!0,m=o.lines.get(o.y+o.ybase);else if(2===n)continue;if(d&&(m.insertCells(o.x,n,o.getNullCell(p)),2===m.getWidth(c-1)&&m.setCellFromCodePoint(c-1,f.NULL_CELL_CODE,f.NULL_CELL_WIDTH,p.fg,p.bg)),m.setCellFromCodePoint(o.x++,i,n,p.fg,p.bg),n>0)for(;--n;)m.setCellFromCodePoint(o.x++,0,0,p.fg,p.bg)}else m.getWidth(o.x-1)?m.addCodepointToCell(o.x-1,i):m.addCodepointToCell(o.x-2,i)}this._terminal.updateRange(o.y)},t.prototype.addCsiHandler=function(e,t){return this._parser.addCsiHandler(e,t)},t.prototype.addOscHandler=function(e,t){return this._parser.addOscHandler(e,t)},t.prototype.bell=function(){this._terminal.bell()},t.prototype.lineFeed=function(){var e=this._terminal.buffer;this._terminal.options.convertEol&&(e.x=0),e.y++,e.y>e.scrollBottom&&(e.y--,this._terminal.scroll()),e.x>=this._terminal.cols&&e.x--,this._onLineFeed.fire()},t.prototype.carriageReturn=function(){this._terminal.buffer.x=0},t.prototype.backspace=function(){this._terminal.buffer.x>0&&this._terminal.buffer.x--},t.prototype.tab=function(){var e=this._terminal.buffer.x;this._terminal.buffer.x=this._terminal.buffer.nextStop(),this._terminal.options.screenReaderMode&&this._terminal.emit("a11y.tab",this._terminal.buffer.x-e)},t.prototype.shiftOut=function(){this._terminal.setgLevel(1)},t.prototype.shiftIn=function(){this._terminal.setgLevel(0)},t.prototype.insertChars=function(e){this._terminal.buffer.lines.get(this._terminal.buffer.y+this._terminal.buffer.ybase).insertCells(this._terminal.buffer.x,e[0]||1,this._terminal.buffer.getNullCell(this._terminal.eraseAttrData())),this._terminal.updateRange(this._terminal.buffer.y)},t.prototype.cursorUp=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.y-=t,this._terminal.buffer.y<0&&(this._terminal.buffer.y=0)},t.prototype.cursorDown=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.y+=t,this._terminal.buffer.y>=this._terminal.rows&&(this._terminal.buffer.y=this._terminal.rows-1),this._terminal.buffer.x>=this._terminal.cols&&this._terminal.buffer.x--},t.prototype.cursorForward=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.x+=t,this._terminal.buffer.x>=this._terminal.cols&&(this._terminal.buffer.x=this._terminal.cols-1)},t.prototype.cursorBackward=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.x>=this._terminal.cols&&this._terminal.buffer.x--,this._terminal.buffer.x-=t,this._terminal.buffer.x<0&&(this._terminal.buffer.x=0)},t.prototype.cursorNextLine=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.y+=t,this._terminal.buffer.y>=this._terminal.rows&&(this._terminal.buffer.y=this._terminal.rows-1),this._terminal.buffer.x=0},t.prototype.cursorPrecedingLine=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.y-=t,this._terminal.buffer.y<0&&(this._terminal.buffer.y=0),this._terminal.buffer.x=0},t.prototype.cursorCharAbsolute=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.x=t-1},t.prototype.cursorPosition=function(e){var t,r=e[0]-1;t=e.length>=2?e[1]-1:0,r<0?r=0:r>=this._terminal.rows&&(r=this._terminal.rows-1),t<0?t=0:t>=this._terminal.cols&&(t=this._terminal.cols-1),this._terminal.buffer.x=t,this._terminal.buffer.y=r},t.prototype.cursorForwardTab=function(e){for(var t=e[0]||1;t--;)this._terminal.buffer.x=this._terminal.buffer.nextStop()},t.prototype._eraseInBufferLine=function(e,t,r,i){void 0===i&&(i=!1);var n=this._terminal.buffer.lines.get(this._terminal.buffer.ybase+e);n.replaceCells(t,r,this._terminal.buffer.getNullCell(this._terminal.eraseAttrData())),i&&(n.isWrapped=!1)},t.prototype._resetBufferLine=function(e){this._eraseInBufferLine(e,0,this._terminal.cols,!0)},t.prototype.eraseInDisplay=function(e){var t;switch(e[0]){case 0:for(t=this._terminal.buffer.y,this._terminal.updateRange(t),this._eraseInBufferLine(t++,this._terminal.buffer.x,this._terminal.cols,0===this._terminal.buffer.x);t<this._terminal.rows;t++)this._resetBufferLine(t);this._terminal.updateRange(t);break;case 1:for(t=this._terminal.buffer.y,this._terminal.updateRange(t),this._eraseInBufferLine(t,0,this._terminal.buffer.x+1,!0),this._terminal.buffer.x+1>=this._terminal.cols&&(this._terminal.buffer.lines.get(t+1).isWrapped=!1);t--;)this._resetBufferLine(t);this._terminal.updateRange(0);break;case 2:for(t=this._terminal.rows,this._terminal.updateRange(t-1);t--;)this._resetBufferLine(t);this._terminal.updateRange(0);break;case 3:var r=this._terminal.buffer.lines.length-this._terminal.rows;r>0&&(this._terminal.buffer.lines.trimStart(r),this._terminal.buffer.ybase=Math.max(this._terminal.buffer.ybase-r,0),this._terminal.buffer.ydisp=Math.max(this._terminal.buffer.ydisp-r,0),this._onScroll.fire(0))}},t.prototype.eraseInLine=function(e){switch(e[0]){case 0:this._eraseInBufferLine(this._terminal.buffer.y,this._terminal.buffer.x,this._terminal.cols);break;case 1:this._eraseInBufferLine(this._terminal.buffer.y,0,this._terminal.buffer.x+1);break;case 2:this._eraseInBufferLine(this._terminal.buffer.y,0,this._terminal.cols)}this._terminal.updateRange(this._terminal.buffer.y)},t.prototype.insertLines=function(e){var t=e[0];t<1&&(t=1);for(var r=this._terminal.buffer,i=r.y+r.ybase,n=this._terminal.rows-1-r.scrollBottom,o=this._terminal.rows-1+r.ybase-n+1;t--;)r.lines.splice(o-1,1),r.lines.splice(i,0,r.getBlankLine(this._terminal.eraseAttrData()));this._terminal.updateRange(r.y),this._terminal.updateRange(r.scrollBottom)},t.prototype.deleteLines=function(e){var t=e[0];t<1&&(t=1);var r,i=this._terminal.buffer,n=i.y+i.ybase;for(r=this._terminal.rows-1-i.scrollBottom,r=this._terminal.rows-1+i.ybase-r;t--;)i.lines.splice(n,1),i.lines.splice(r,0,i.getBlankLine(this._terminal.eraseAttrData()));this._terminal.updateRange(i.y),this._terminal.updateRange(i.scrollBottom)},t.prototype.deleteChars=function(e){this._terminal.buffer.lines.get(this._terminal.buffer.y+this._terminal.buffer.ybase).deleteCells(this._terminal.buffer.x,e[0]||1,this._terminal.buffer.getNullCell(this._terminal.eraseAttrData())),this._terminal.updateRange(this._terminal.buffer.y)},t.prototype.scrollUp=function(e){for(var t=e[0]||1,r=this._terminal.buffer;t--;)r.lines.splice(r.ybase+r.scrollTop,1),r.lines.splice(r.ybase+r.scrollBottom,0,r.getBlankLine(f.DEFAULT_ATTR_DATA));this._terminal.updateRange(r.scrollTop),this._terminal.updateRange(r.scrollBottom)},t.prototype.scrollDown=function(e,t){if(e.length<2&&!t){for(var r=e[0]||1,i=this._terminal.buffer;r--;)i.lines.splice(i.ybase+i.scrollBottom,1),i.lines.splice(i.ybase+i.scrollTop,0,i.getBlankLine(f.DEFAULT_ATTR_DATA));this._terminal.updateRange(i.scrollTop),this._terminal.updateRange(i.scrollBottom)}},t.prototype.eraseChars=function(e){this._terminal.buffer.lines.get(this._terminal.buffer.y+this._terminal.buffer.ybase).replaceCells(this._terminal.buffer.x,this._terminal.buffer.x+(e[0]||1),this._terminal.buffer.getNullCell(this._terminal.eraseAttrData()))},t.prototype.cursorBackwardTab=function(e){for(var t=e[0]||1,r=this._terminal.buffer;t--;)r.x=r.prevStop()},t.prototype.charPosAbsolute=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.x=t-1,this._terminal.buffer.x>=this._terminal.cols&&(this._terminal.buffer.x=this._terminal.cols-1)},t.prototype.hPositionRelative=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.x+=t,this._terminal.buffer.x>=this._terminal.cols&&(this._terminal.buffer.x=this._terminal.cols-1)},t.prototype.repeatPrecedingCharacter=function(e){var t=this._terminal.buffer,r=t.lines.get(t.ybase+t.y);r.loadCell(t.x-1,this._workCell),r.replaceCells(t.x,t.x+(e[0]||1),void 0!==this._workCell.content?this._workCell:t.getNullCell(f.DEFAULT_ATTR_DATA))},t.prototype.sendDeviceAttributes=function(e,t){e[0]>0||(t?">"===t&&(this._terminal.is("xterm")?this._terminal.handler(o.C0.ESC+"[>0;276;0c"):this._terminal.is("rxvt-unicode")?this._terminal.handler(o.C0.ESC+"[>85;95;0c"):this._terminal.is("linux")?this._terminal.handler(e[0]+"c"):this._terminal.is("screen")&&this._terminal.handler(o.C0.ESC+"[>83;40003;0c")):this._terminal.is("xterm")||this._terminal.is("rxvt-unicode")||this._terminal.is("screen")?this._terminal.handler(o.C0.ESC+"[?1;2c"):this._terminal.is("linux")&&this._terminal.handler(o.C0.ESC+"[?6c"))},t.prototype.linePosAbsolute=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.y=t-1,this._terminal.buffer.y>=this._terminal.rows&&(this._terminal.buffer.y=this._terminal.rows-1)},t.prototype.vPositionRelative=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.y+=t,this._terminal.buffer.y>=this._terminal.rows&&(this._terminal.buffer.y=this._terminal.rows-1),this._terminal.buffer.x>=this._terminal.cols&&this._terminal.buffer.x--},t.prototype.hVPosition=function(e){e[0]<1&&(e[0]=1),e[1]<1&&(e[1]=1),this._terminal.buffer.y=e[0]-1,this._terminal.buffer.y>=this._terminal.rows&&(this._terminal.buffer.y=this._terminal.rows-1),this._terminal.buffer.x=e[1]-1,this._terminal.buffer.x>=this._terminal.cols&&(this._terminal.buffer.x=this._terminal.cols-1)},t.prototype.tabClear=function(e){var t=e[0];t<=0?delete this._terminal.buffer.tabs[this._terminal.buffer.x]:3===t&&(this._terminal.buffer.tabs={})},t.prototype.setMode=function(e,t){if(e.length>1)for(var r=0;r<e.length;r++)this.setMode([e[r]]);else if(t){if("?"===t)switch(e[0]){case 1:this._terminal.applicationCursor=!0;break;case 2:this._terminal.setgCharset(0,s.DEFAULT_CHARSET),this._terminal.setgCharset(1,s.DEFAULT_CHARSET),this._terminal.setgCharset(2,s.DEFAULT_CHARSET),this._terminal.setgCharset(3,s.DEFAULT_CHARSET);break;case 3:this._terminal.savedCols=this._terminal.cols,this._terminal.resize(132,this._terminal.rows);break;case 6:this._terminal.originMode=!0;break;case 7:this._terminal.wraparoundMode=!0;break;case 12:break;case 66:this._terminal.log("Serial port requested application keypad."),this._terminal.applicationKeypad=!0,this._terminal.viewport&&this._terminal.viewport.syncScrollArea();break;case 9:case 1e3:case 1002:case 1003:this._terminal.x10Mouse=9===e[0],this._terminal.vt200Mouse=1e3===e[0],this._terminal.normalMouse=e[0]>1e3,this._terminal.mouseEvents=!0,this._terminal.element&&this._terminal.element.classList.add("enable-mouse-events"),this._terminal.selectionManager&&this._terminal.selectionManager.disable(),this._terminal.log("Binding to mouse events.");break;case 1004:this._terminal.sendFocus=!0;break;case 1005:this._terminal.utfMouse=!0;break;case 1006:this._terminal.sgrMouse=!0;break;case 1015:this._terminal.urxvtMouse=!0;break;case 25:this._terminal.cursorHidden=!1;break;case 1048:this.saveCursor(e);break;case 1049:this.saveCursor(e);case 47:case 1047:this._terminal.buffers.activateAltBuffer(this._terminal.eraseAttrData()),this._terminal.refresh(0,this._terminal.rows-1),this._terminal.viewport&&this._terminal.viewport.syncScrollArea(),this._terminal.showCursor();break;case 2004:this._terminal.bracketedPasteMode=!0}}else switch(e[0]){case 4:this._terminal.insertMode=!0}},t.prototype.resetMode=function(e,t){if(e.length>1)for(var r=0;r<e.length;r++)this.resetMode([e[r]]);else if(t){if("?"===t)switch(e[0]){case 1:this._terminal.applicationCursor=!1;break;case 3:132===this._terminal.cols&&this._terminal.savedCols&&this._terminal.resize(this._terminal.savedCols,this._terminal.rows),delete this._terminal.savedCols;break;case 6:this._terminal.originMode=!1;break;case 7:this._terminal.wraparoundMode=!1;break;case 12:break;case 66:this._terminal.log("Switching back to normal keypad."),this._terminal.applicationKeypad=!1,this._terminal.viewport&&this._terminal.viewport.syncScrollArea();break;case 9:case 1e3:case 1002:case 1003:this._terminal.x10Mouse=!1,this._terminal.vt200Mouse=!1,this._terminal.normalMouse=!1,this._terminal.mouseEvents=!1,this._terminal.element&&this._terminal.element.classList.remove("enable-mouse-events"),this._terminal.selectionManager&&this._terminal.selectionManager.enable();break;case 1004:this._terminal.sendFocus=!1;break;case 1005:this._terminal.utfMouse=!1;break;case 1006:this._terminal.sgrMouse=!1;break;case 1015:this._terminal.urxvtMouse=!1;break;case 25:this._terminal.cursorHidden=!0;break;case 1048:this.restoreCursor(e);break;case 1049:case 47:case 1047:this._terminal.buffers.activateNormalBuffer(),1049===e[0]&&this.restoreCursor(e),this._terminal.refresh(0,this._terminal.rows-1),this._terminal.viewport&&this._terminal.viewport.syncScrollArea(),this._terminal.showCursor();break;case 2004:this._terminal.bracketedPasteMode=!1}}else switch(e[0]){case 4:this._terminal.insertMode=!1}},t.prototype.charAttributes=function(e){if(1===e.length&&0===e[0])return this._terminal.curAttrData.fg=f.DEFAULT_ATTR_DATA.fg,void(this._terminal.curAttrData.bg=f.DEFAULT_ATTR_DATA.bg);for(var t,r=e.length,i=this._terminal.curAttrData,n=0;n<r;n++)(t=e[n])>=30&&t<=37?(i.fg&=-50331904,i.fg|=16777216|t-30):t>=40&&t<=47?(i.bg&=-50331904,i.bg|=16777216|t-40):t>=90&&t<=97?(i.fg&=-50331904,i.fg|=16777224|t-90):t>=100&&t<=107?(i.bg&=-50331904,i.bg|=16777224|t-100):0===t?(i.fg=f.DEFAULT_ATTR_DATA.fg,i.bg=f.DEFAULT_ATTR_DATA.bg):1===t?i.fg|=134217728:3===t?i.bg|=67108864:4===t?i.fg|=268435456:5===t?i.fg|=536870912:7===t?i.fg|=67108864:8===t?i.fg|=1073741824:2===t?i.bg|=134217728:22===t?(i.fg&=-134217729,i.bg&=-134217729):23===t?i.bg&=-67108865:24===t?i.fg&=-268435457:25===t?i.fg&=-536870913:27===t?i.fg&=-67108865:28===t?i.fg&=-1073741825:39===t?(i.fg&=-67108864,i.fg|=16777215&f.DEFAULT_ATTR_DATA.fg):49===t?(i.bg&=-67108864,i.bg|=16777215&f.DEFAULT_ATTR_DATA.bg):38===t?2===e[n+1]?(n+=2,i.fg|=50331648,i.fg&=-16777216,i.fg|=f.AttributeData.fromColorRGB([e[n],e[n+1],e[n+2]]),n+=2):5===e[n+1]&&(t=255&e[n+=2],i.fg&=-50331904,i.fg|=33554432|t):48===t?2===e[n+1]?(n+=2,i.bg|=50331648,i.bg&=-16777216,i.bg|=f.AttributeData.fromColorRGB([e[n],e[n+1],e[n+2]]),n+=2):5===e[n+1]&&(t=255&e[n+=2],i.bg&=-50331904,i.bg|=33554432|t):100===t?(i.fg&=-67108864,i.fg|=16777215&f.DEFAULT_ATTR_DATA.fg,i.bg&=-67108864,i.bg|=16777215&f.DEFAULT_ATTR_DATA.bg):this._terminal.error("Unknown SGR attribute: %d.",t)},t.prototype.deviceStatus=function(e,t){if(t){if("?"===t)switch(e[0]){case 6:r=this._terminal.buffer.y+1,i=this._terminal.buffer.x+1;this._onData.fire(o.C0.ESC+"[?"+r+";"+i+"R")}}else switch(e[0]){case 5:this._onData.fire(o.C0.ESC+"[0n");break;case 6:var r=this._terminal.buffer.y+1,i=this._terminal.buffer.x+1;this._onData.fire(o.C0.ESC+"["+r+";"+i+"R")}},t.prototype.softReset=function(e,t){"!"===t&&(this._terminal.cursorHidden=!1,this._terminal.insertMode=!1,this._terminal.originMode=!1,this._terminal.wraparoundMode=!0,this._terminal.applicationKeypad=!1,this._terminal.viewport&&this._terminal.viewport.syncScrollArea(),this._terminal.applicationCursor=!1,this._terminal.buffer.scrollTop=0,this._terminal.buffer.scrollBottom=this._terminal.rows-1,this._terminal.curAttrData=f.DEFAULT_ATTR_DATA.clone(),this._terminal.buffer.x=this._terminal.buffer.y=0,this._terminal.charset=null,this._terminal.glevel=0,this._terminal.charsets=[null])},t.prototype.setCursorStyle=function(e,t){if(" "===t){var r=e[0]<1?1:e[0];switch(r){case 1:case 2:this._terminal.setOption("cursorStyle","block");break;case 3:case 4:this._terminal.setOption("cursorStyle","underline");break;case 5:case 6:this._terminal.setOption("cursorStyle","bar")}var i=r%2==1;this._terminal.setOption("cursorBlink",i)}},t.prototype.setScrollRegion=function(e,t){t||(this._terminal.buffer.scrollTop=(e[0]||1)-1,this._terminal.buffer.scrollBottom=(e[1]&&e[1]<=this._terminal.rows?e[1]:this._terminal.rows)-1,this._terminal.buffer.x=0,this._terminal.buffer.y=0)},t.prototype.saveCursor=function(e){this._terminal.buffer.savedX=this._terminal.buffer.x,this._terminal.buffer.savedY=this._terminal.buffer.y,this._terminal.buffer.savedCurAttrData.fg=this._terminal.curAttrData.fg,this._terminal.buffer.savedCurAttrData.bg=this._terminal.curAttrData.bg},t.prototype.restoreCursor=function(e){this._terminal.buffer.x=this._terminal.buffer.savedX||0,this._terminal.buffer.y=this._terminal.buffer.savedY||0,this._terminal.curAttrData.fg=this._terminal.buffer.savedCurAttrData.fg,this._terminal.curAttrData.bg=this._terminal.buffer.savedCurAttrData.bg},t.prototype.setTitle=function(e){this._terminal.handleTitle(e)},t.prototype.nextLine=function(){this._terminal.buffer.x=0,this.index()},t.prototype.keypadApplicationMode=function(){this._terminal.log("Serial port requested application keypad."),this._terminal.applicationKeypad=!0,this._terminal.viewport&&this._terminal.viewport.syncScrollArea()},t.prototype.keypadNumericMode=function(){this._terminal.log("Switching back to normal keypad."),this._terminal.applicationKeypad=!1,this._terminal.viewport&&this._terminal.viewport.syncScrollArea()},t.prototype.selectDefaultCharset=function(){this._terminal.setgLevel(0),this._terminal.setgCharset(0,s.DEFAULT_CHARSET)},t.prototype.selectCharset=function(e){2===e.length?"/"!==e[0]&&this._terminal.setgCharset(p[e[0]],s.CHARSETS[e[1]]||s.DEFAULT_CHARSET):this.selectDefaultCharset()},t.prototype.index=function(){this._terminal.index()},t.prototype.tabSet=function(){this._terminal.tabSet()},t.prototype.reverseIndex=function(){this._terminal.reverseIndex()},t.prototype.reset=function(){this._parser.reset(),this._terminal.reset()},t.prototype.setgLevel=function(e){this._terminal.setgLevel(e)},t}(c.Disposable);t.InputHandler=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CHARSETS={},t.DEFAULT_CHARSET=t.CHARSETS.B,t.CHARSETS[0]={"`":"◆",a:"▒",b:"\t",c:"\f",d:"\r",e:"\n",f:"°",g:"±",h:"␤",i:"\v",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},t.CHARSETS.A={"#":"£"},t.CHARSETS.B=null,t.CHARSETS[4]={"#":"£","@":"¾","[":"ij","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"},t.CHARSETS.C=t.CHARSETS[5]={"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},t.CHARSETS.R={"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"},t.CHARSETS.Q={"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"},t.CHARSETS.K={"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"},t.CHARSETS.Y={"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"},t.CHARSETS.E=t.CHARSETS[6]={"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"},t.CHARSETS.Z={"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"},t.CHARSETS.H=t.CHARSETS[7]={"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},t.CHARSETS["="]={"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"}},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),s=r(16);function a(e,t){for(var r=t-e,i=new Array(r);r--;)i[r]=--t;return i}var l=function(){function e(e){this.table="undefined"==typeof Uint8Array?new Array(e):new Uint8Array(e)}return e.prototype.add=function(e,t,r,i){this.table[t<<8|e]=(0|r)<<4|(void 0===i?t:i)},e.prototype.addMany=function(e,t,r,i){for(var n=0;n<e.length;n++)this.add(e[n],t,r,i)},e}();t.TransitionTable=l;var c=a(32,127),h=a(0,24);h.push(25),h.push.apply(h,a(28,32));t.VT500_TRANSITION_TABLE=function(){var e,t=new l(4095),r=a(0,14);for(e in r)for(var i=0;i<=160;++i)t.add(i,e,1,0);for(e in t.addMany(c,0,2,0),r)t.addMany([24,26,153,154],e,3,0),t.addMany(a(128,144),e,3,0),t.addMany(a(144,152),e,3,0),t.add(156,e,0,0),t.add(27,e,11,1),t.add(157,e,4,8),t.addMany([152,158,159],e,0,7),t.add(155,e,11,3),t.add(144,e,11,9);return t.addMany(h,0,3,0),t.addMany(h,1,3,1),t.add(127,1,0,1),t.addMany(h,8,0,8),t.addMany(h,3,3,3),t.add(127,3,0,3),t.addMany(h,4,3,4),t.add(127,4,0,4),t.addMany(h,6,3,6),t.addMany(h,5,3,5),t.add(127,5,0,5),t.addMany(h,2,3,2),t.add(127,2,0,2),t.add(93,1,4,8),t.addMany(c,8,5,8),t.add(127,8,5,8),t.addMany([156,27,24,26,7],8,6,0),t.addMany(a(28,32),8,0,8),t.addMany([88,94,95],1,0,7),t.addMany(c,7,0,7),t.addMany(h,7,0,7),t.add(156,7,0,0),t.add(127,7,0,7),t.add(91,1,11,3),t.addMany(a(64,127),3,7,0),t.addMany(a(48,58),3,8,4),t.add(59,3,8,4),t.addMany([60,61,62,63],3,9,4),t.addMany(a(48,58),4,8,4),t.add(59,4,8,4),t.addMany(a(64,127),4,7,0),t.addMany([58,60,61,62,63],4,0,6),t.addMany(a(32,64),6,0,6),t.add(127,6,0,6),t.addMany(a(64,127),6,0,0),t.add(58,3,0,6),t.addMany(a(32,48),3,9,5),t.addMany(a(32,48),5,9,5),t.addMany(a(48,64),5,0,6),t.addMany(a(64,127),5,7,0),t.addMany(a(32,48),4,9,5),t.addMany(a(32,48),1,9,2),t.addMany(a(32,48),2,9,2),t.addMany(a(48,127),2,10,0),t.addMany(a(48,80),1,10,0),t.addMany(a(81,88),1,10,0),t.addMany([89,90,92],1,10,0),t.addMany(a(96,127),1,10,0),t.add(80,1,11,9),t.addMany(h,9,0,9),t.add(127,9,0,9),t.addMany(a(28,32),9,0,9),t.addMany(a(32,48),9,9,12),t.add(58,9,0,11),t.addMany(a(48,58),9,8,10),t.add(59,9,8,10),t.addMany([60,61,62,63],9,9,10),t.addMany(h,11,0,11),t.addMany(a(32,128),11,0,11),t.addMany(a(28,32),11,0,11),t.addMany(h,10,0,10),t.add(127,10,0,10),t.addMany(a(28,32),10,0,10),t.addMany(a(48,58),10,8,10),t.add(59,10,8,10),t.addMany([58,60,61,62,63],10,0,11),t.addMany(a(32,48),10,9,12),t.addMany(h,12,0,12),t.add(127,12,0,12),t.addMany(a(28,32),12,0,12),t.addMany(a(32,48),12,9,12),t.addMany(a(48,64),12,0,11),t.addMany(a(64,127),12,12,13),t.addMany(a(64,127),10,12,13),t.addMany(a(64,127),9,12,13),t.addMany(h,13,13,13),t.addMany(c,13,13,13),t.add(127,13,0,13),t.addMany([27,156],13,14,0),t.add(160,8,5,8),t}();var u=function(){function e(){}return e.prototype.hook=function(e,t,r){},e.prototype.put=function(e,t,r){},e.prototype.unhook=function(){},e}(),f=function(e){function r(r){void 0===r&&(r=t.VT500_TRANSITION_TABLE);var i=e.call(this)||this;return i.TRANSITIONS=r,i.initialState=0,i.currentState=i.initialState,i._osc="",i._params=[0],i._collect="",i._printHandlerFb=function(e,t,r){},i._executeHandlerFb=function(e){},i._csiHandlerFb=function(e,t,r){},i._escHandlerFb=function(e,t){},i._oscHandlerFb=function(e,t){},i._dcsHandlerFb=new u,i._errorHandlerFb=function(e){return e},i._printHandler=i._printHandlerFb,i._executeHandlers=Object.create(null),i._csiHandlers=Object.create(null),i._escHandlers=Object.create(null),i._oscHandlers=Object.create(null),i._dcsHandlers=Object.create(null),i._activeDcsHandler=null,i._errorHandler=i._errorHandlerFb,i.setEscHandler("\\",function(){}),i}return n(r,e),r.prototype.dispose=function(){this._printHandlerFb=null,this._executeHandlerFb=null,this._csiHandlerFb=null,this._escHandlerFb=null,this._oscHandlerFb=null,this._dcsHandlerFb=null,this._errorHandlerFb=null,this._printHandler=null,this._executeHandlers=null,this._escHandlers=null,this._csiHandlers=null,this._oscHandlers=null,this._dcsHandlers=null,this._activeDcsHandler=null,this._errorHandler=null},r.prototype.setPrintHandler=function(e){this._printHandler=e},r.prototype.clearPrintHandler=function(){this._printHandler=this._printHandlerFb},r.prototype.setExecuteHandler=function(e,t){this._executeHandlers[e.charCodeAt(0)]=t},r.prototype.clearExecuteHandler=function(e){this._executeHandlers[e.charCodeAt(0)]&&delete this._executeHandlers[e.charCodeAt(0)]},r.prototype.setExecuteHandlerFallback=function(e){this._executeHandlerFb=e},r.prototype.addCsiHandler=function(e,t){var r=e.charCodeAt(0);void 0===this._csiHandlers[r]&&(this._csiHandlers[r]=[]);var i=this._csiHandlers[r];return i.push(t),{dispose:function(){var e=i.indexOf(t);-1!==e&&i.splice(e,1)}}},r.prototype.setCsiHandler=function(e,t){this._csiHandlers[e.charCodeAt(0)]=[t]},r.prototype.clearCsiHandler=function(e){this._csiHandlers[e.charCodeAt(0)]&&delete this._csiHandlers[e.charCodeAt(0)]},r.prototype.setCsiHandlerFallback=function(e){this._csiHandlerFb=e},r.prototype.setEscHandler=function(e,t){this._escHandlers[e]=t},r.prototype.clearEscHandler=function(e){this._escHandlers[e]&&delete this._escHandlers[e]},r.prototype.setEscHandlerFallback=function(e){this._escHandlerFb=e},r.prototype.addOscHandler=function(e,t){void 0===this._oscHandlers[e]&&(this._oscHandlers[e]=[]);var r=this._oscHandlers[e];return r.push(t),{dispose:function(){var e=r.indexOf(t);-1!==e&&r.splice(e,1)}}},r.prototype.setOscHandler=function(e,t){this._oscHandlers[e]=[t]},r.prototype.clearOscHandler=function(e){this._oscHandlers[e]&&delete this._oscHandlers[e]},r.prototype.setOscHandlerFallback=function(e){this._oscHandlerFb=e},r.prototype.setDcsHandler=function(e,t){this._dcsHandlers[e]=t},r.prototype.clearDcsHandler=function(e){this._dcsHandlers[e]&&delete this._dcsHandlers[e]},r.prototype.setDcsHandlerFallback=function(e){this._dcsHandlerFb=e},r.prototype.setErrorHandler=function(e){this._errorHandler=e},r.prototype.clearErrorHandler=function(){this._errorHandler=this._errorHandlerFb},r.prototype.reset=function(){this.currentState=this.initialState,this._osc="",this._params=[0],this._collect="",this._activeDcsHandler=null},r.prototype.parse=function(e,t){for(var r=0,i=0,n=!1,o=this.currentState,a=-1,l=-1,c=this._osc,h=this._collect,u=this._params,f=this.TRANSITIONS.table,d=this._activeDcsHandler,p=null,m=0;m<t;++m)if(r=e[m],0===o&&r>31&&r<128){a=~a?a:m;do{m++}while(m<t&&e[m]>31&&e[m]<128);m--}else if(4===o&&r>47&&r<57)u[u.length-1]=10*u[u.length-1]+r-48;else{switch((i=f[o<<8|(r<160?r:160)])>>4){case 2:a=~a?a:m;break;case 3:~a&&(this._printHandler(e,a,m),a=-1),(p=this._executeHandlers[r])?p():this._executeHandlerFb(r);break;case 0:~a?(this._printHandler(e,a,m),a=-1):~l&&(d.put(e,l,m),l=-1);break;case 1:if(r>159)switch(o){case 0:a=~a?a:m;break;case 6:i|=6;break;case 11:i|=11;break;case 13:l=~l?l:m,i|=13;break;default:n=!0}else n=!0;if(n){if(this._errorHandler({position:m,code:r,currentState:o,print:a,dcs:l,osc:c,collect:h,params:u,abort:!1}).abort)return;n=!1}break;case 7:for(var g=this._csiHandlers[r],_=g?g.length-1:-1;_>=0&&!1===g[_](u,h);_--);_<0&&this._csiHandlerFb(h,u,r);break;case 8:59===r?u.push(0):u[u.length-1]=10*u[u.length-1]+r-48;break;case 9:h+=String.fromCharCode(r);break;case 10:(p=this._escHandlers[h+String.fromCharCode(r)])?p(h,r):this._escHandlerFb(h,r);break;case 11:~a&&(this._printHandler(e,a,m),a=-1),c="",u=[0],h="",l=-1;break;case 12:(d=this._dcsHandlers[h+String.fromCharCode(r)])||(d=this._dcsHandlerFb),d.hook(h,u,r);break;case 13:l=~l?l:m;break;case 14:d&&(~l&&d.put(e,l,m),d.unhook(),d=null),27===r&&(i|=1),c="",u=[0],h="",l=-1;break;case 4:~a&&(this._printHandler(e,a,m),a=-1),c="";break;case 5:for(var v=m+1;;v++)if(v>=t||(r=e[v])<32||r>127&&r<=159){c+=s.utf32ToString(e,m,v),m=v-1;break}break;case 6:if(c&&24!==r&&26!==r){var y=c.indexOf(";");if(-1===y)this._oscHandlerFb(-1,c);else{for(var C=parseInt(c.substring(0,y)),b=c.substring(y+1),w=this._oscHandlers[C],x=w?w.length-1:-1;x>=0&&!1===w[x](b);x--);x<0&&this._oscHandlerFb(C,b)}}27===r&&(i|=1),c="",u=[0],h="",l=-1}o=15&i}0===o&&~a?this._printHandler(e,a,t):13===o&&~l&&d&&d.put(e,l,t),this._osc=c,this._collect=h,this._params=u,this._activeDcsHandler=d,this.currentState=o},r}(o.Disposable);t.EscapeSequenceParser=f},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(47),s=r(53),a=r(54),l=r(55),c=r(26),h=function(e){function t(t,r){var i=e.call(this)||this;i._terminal=t,i._colors=r;var n=i._terminal.options.allowTransparency;return i._characterJoinerRegistry=new c.CharacterJoinerRegistry(t),i._renderLayers=[new o.TextRenderLayer(i._terminal.screenElement,0,i._colors,i._characterJoinerRegistry,n),new s.SelectionRenderLayer(i._terminal.screenElement,1,i._colors),new l.LinkRenderLayer(i._terminal.screenElement,2,i._colors,i._terminal),new a.CursorRenderLayer(i._terminal.screenElement,3,i._colors)],i.dimensions={scaledCharWidth:null,scaledCharHeight:null,scaledCellWidth:null,scaledCellHeight:null,scaledCharLeft:null,scaledCharTop:null,scaledCanvasWidth:null,scaledCanvasHeight:null,canvasWidth:null,canvasHeight:null,actualCellWidth:null,actualCellHeight:null},i._devicePixelRatio=window.devicePixelRatio,i._updateDimensions(),i.onOptionsChanged(),i}return n(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._renderLayers.forEach(function(e){return e.dispose()})},t.prototype.onDevicePixelRatioChange=function(){this._devicePixelRatio!==window.devicePixelRatio&&(this._devicePixelRatio=window.devicePixelRatio,this.onResize(this._terminal.cols,this._terminal.rows))},t.prototype.setColors=function(e){var t=this;this._colors=e,this._renderLayers.forEach(function(e){e.setColors(t._terminal,t._colors),e.reset(t._terminal)})},t.prototype.onResize=function(e,t){var r=this;this._updateDimensions(),this._renderLayers.forEach(function(e){return e.resize(r._terminal,r.dimensions)}),this._terminal.screenElement.style.width=this.dimensions.canvasWidth+"px",this._terminal.screenElement.style.height=this.dimensions.canvasHeight+"px"},t.prototype.onCharSizeChanged=function(){this.onResize(this._terminal.cols,this._terminal.rows)},t.prototype.onBlur=function(){var e=this;this._runOperation(function(t){return t.onBlur(e._terminal)})},t.prototype.onFocus=function(){var e=this;this._runOperation(function(t){return t.onFocus(e._terminal)})},t.prototype.onSelectionChanged=function(e,t,r){var i=this;void 0===r&&(r=!1),this._runOperation(function(n){return n.onSelectionChanged(i._terminal,e,t,r)})},t.prototype.onCursorMove=function(){var e=this;this._runOperation(function(t){return t.onCursorMove(e._terminal)})},t.prototype.onOptionsChanged=function(){var e=this;this._runOperation(function(t){return t.onOptionsChanged(e._terminal)})},t.prototype.clear=function(){var e=this;this._runOperation(function(t){return t.reset(e._terminal)})},t.prototype._runOperation=function(e){this._renderLayers.forEach(function(t){return e(t)})},t.prototype.renderRows=function(e,t){var r=this;this._renderLayers.forEach(function(i){return i.onGridChanged(r._terminal,e,t)})},t.prototype._updateDimensions=function(){this._terminal.charMeasure.width&&this._terminal.charMeasure.height&&(this.dimensions.scaledCharWidth=Math.floor(this._terminal.charMeasure.width*window.devicePixelRatio),this.dimensions.scaledCharHeight=Math.ceil(this._terminal.charMeasure.height*window.devicePixelRatio),this.dimensions.scaledCellHeight=Math.floor(this.dimensions.scaledCharHeight*this._terminal.options.lineHeight),this.dimensions.scaledCharTop=1===this._terminal.options.lineHeight?0:Math.round((this.dimensions.scaledCellHeight-this.dimensions.scaledCharHeight)/2),this.dimensions.scaledCellWidth=this.dimensions.scaledCharWidth+Math.round(this._terminal.options.letterSpacing),this.dimensions.scaledCharLeft=Math.floor(this._terminal.options.letterSpacing/2),this.dimensions.scaledCanvasHeight=this._terminal.rows*this.dimensions.scaledCellHeight,this.dimensions.scaledCanvasWidth=this._terminal.cols*this.dimensions.scaledCellWidth,this.dimensions.canvasHeight=Math.round(this.dimensions.scaledCanvasHeight/window.devicePixelRatio),this.dimensions.canvasWidth=Math.round(this.dimensions.scaledCanvasWidth/window.devicePixelRatio),this.dimensions.actualCellHeight=this.dimensions.canvasHeight/this._terminal.rows,this.dimensions.actualCellWidth=this.dimensions.canvasWidth/this._terminal.cols)},t.prototype.registerCharacterJoiner=function(e){return this._characterJoinerRegistry.registerCharacterJoiner(e)},t.prototype.deregisterCharacterJoiner=function(e){return this._characterJoinerRegistry.deregisterCharacterJoiner(e)},t}(r(6).Disposable);t.Renderer=h},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(48),s=r(14),a=r(7),l=r(26),c=function(e){function t(t,r,i,n,s){var l=e.call(this,t,"text",r,s,i)||this;return l._characterOverlapCache={},l._workCell=new a.CellData,l._state=new o.GridCache,l._characterJoinerRegistry=n,l}return n(t,e),t.prototype.resize=function(t,r){e.prototype.resize.call(this,t,r);var i=this._getFont(t,!1,!1);this._characterWidth===r.scaledCharWidth&&this._characterFont===i||(this._characterWidth=r.scaledCharWidth,this._characterFont=i,this._characterOverlapCache={}),this._state.clear(),this._state.resize(t.cols,t.rows)},t.prototype.reset=function(e){this._state.clear(),this.clearAll()},t.prototype._forEachCell=function(e,t,r,i,n){for(var o=t;o<=r;o++)for(var s=o+e.buffer.ydisp,c=e.buffer.lines.get(s),h=i?i.getJoinedCharacters(s):[],u=0;u<e.cols;u++){c.loadCell(u,this._workCell);var f=this._workCell,d=!1,p=u;if(0!==f.getWidth()){if(h.length>0&&u===h[0][0]){d=!0;var m=h.shift();f=new l.JoinedCellData(this._workCell,c.translateToString(!0,m[0],m[1]),m[1]-m[0]),p=m[1]-1}!d&&this._isOverlapping(f)&&p<c.length-1&&c.getCodePoint(p+1)===a.NULL_CELL_CODE&&(f.content&=-12582913,f.content|=2<<22),n(f,u,o),u=p}}},t.prototype._drawBackground=function(e,t,r){var i=this,n=this._ctx,o=e.cols,s=0,l=0,c=null;n.save(),this._forEachCell(e,t,r,null,function(e,t,r){var h=null;e.isInverse()?h=e.isFgDefault()?i._colors.foreground.css:e.isFgRGB()?"rgb("+a.AttributeData.toColorRGB(e.getFgColor()).join(",")+")":i._colors.ansi[e.getFgColor()].css:e.isBgRGB()?h="rgb("+a.AttributeData.toColorRGB(e.getBgColor()).join(",")+")":e.isBgPalette()&&(h=i._colors.ansi[e.getBgColor()].css),null===c&&(s=t,l=r),r!==l?(n.fillStyle=c,i.fillCells(s,l,o-s,1),s=t,l=r):c!==h&&(n.fillStyle=c,i.fillCells(s,l,t-s,1),s=t,l=r),c=h}),null!==c&&(n.fillStyle=c,this.fillCells(s,l,o-s,1)),n.restore()},t.prototype._drawForeground=function(e,t,r){var i=this;this._forEachCell(e,t,r,this._characterJoinerRegistry,function(t,r,n){if(!t.isInvisible()&&(i.drawChars(e,t,r,n),t.isUnderline())){if(i._ctx.save(),t.isInverse())t.isBgDefault()?i._ctx.fillStyle=i._colors.background.css:t.isBgRGB()?i._ctx.fillStyle="rgb("+a.AttributeData.toColorRGB(t.getBgColor()).join(",")+")":i._ctx.fillStyle=i._colors.ansi[t.getBgColor()].css;else if(t.isFgDefault())i._ctx.fillStyle=i._colors.foreground.css;else if(t.isFgRGB())i._ctx.fillStyle="rgb("+a.AttributeData.toColorRGB(t.getFgColor()).join(",")+")";else{var o=t.getFgColor();e.options.drawBoldTextInBrightColors&&t.isBold()&&o<8&&(o+=8),i._ctx.fillStyle=i._colors.ansi[o].css}i.fillBottomLineAtCells(r,n,t.getWidth()),i._ctx.restore()}})},t.prototype.onGridChanged=function(e,t,r){0!==this._state.cache.length&&(this._charAtlas&&this._charAtlas.beginFrame(),this.clearCells(0,t,e.cols,r-t+1),this._drawBackground(e,t,r),this._drawForeground(e,t,r))},t.prototype.onOptionsChanged=function(e){this.setTransparency(e,e.options.allowTransparency)},t.prototype._isOverlapping=function(e){if(1!==e.getWidth())return!1;if(e.getCode()<256)return!1;var t=e.getChars();if(this._characterOverlapCache.hasOwnProperty(t))return this._characterOverlapCache[t];this._ctx.save(),this._ctx.font=this._characterFont;var r=Math.floor(this._ctx.measureText(t).width)>this._characterWidth;return this._ctx.restore(),this._characterOverlapCache[t]=r,r},t}(s.BaseRenderLayer);t.TextRenderLayer=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.cache=[]}return e.prototype.resize=function(e,t){for(var r=0;r<e;r++){this.cache.length<=r&&this.cache.push([]);for(var i=this.cache[r].length;i<t;i++)this.cache[r].push(null);this.cache[r].length=t}this.cache.length=e},e.prototype.clear=function(){for(var e=0;e<this.cache.length;e++)for(var t=0;t<this.cache[e].length;t++)this.cache[e][t]=null},e}();t.GridCache=i},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(9),s=r(18),a=r(24),l=r(25),c=r(50),h=r(11),u=1024,f=1024,d={css:"rgba(0, 0, 0, 0)",rgba:0};function p(e){return e.code<<21|e.bg<<12|e.fg<<3|(e.bold?0:4)+(e.dim?0:2)+(e.italic?0:1)}t.getGlyphCacheKey=p;var m=function(e){function t(t,r){var i=e.call(this)||this;i._config=r,i._drawToCacheCount=0,i._glyphsWaitingOnBitmap=[],i._bitmapCommitTimeout=null,i._bitmap=null,i._cacheCanvas=t.createElement("canvas"),i._cacheCanvas.width=u,i._cacheCanvas.height=f,i._cacheCtx=i._cacheCanvas.getContext("2d",{alpha:!0});var n=t.createElement("canvas");n.width=i._config.scaledCharWidth,n.height=i._config.scaledCharHeight,i._tmpCtx=n.getContext("2d",{alpha:i._config.allowTransparency}),i._width=Math.floor(u/i._config.scaledCharWidth),i._height=Math.floor(f/i._config.scaledCharHeight);var o=i._width*i._height;return i._cacheMap=new c.default(o),i._cacheMap.prealloc(o),i}return n(t,e),t.prototype.dispose=function(){null!==this._bitmapCommitTimeout&&(window.clearTimeout(this._bitmapCommitTimeout),this._bitmapCommitTimeout=null)},t.prototype.beginFrame=function(){this._drawToCacheCount=0},t.prototype.draw=function(e,t,r,i){if(32===t.code)return!0;if(!this._canCache(t))return!1;var n=p(t),o=this._cacheMap.get(n);if(null!=o)return this._drawFromCache(e,o,r,i),!0;if(this._drawToCacheCount<100){var s=void 0;s=this._cacheMap.size<this._cacheMap.capacity?this._cacheMap.size:this._cacheMap.peek().index;var a=this._drawToCache(t,s);return this._cacheMap.set(n,a),this._drawFromCache(e,a,r,i),!0}return!1},t.prototype._canCache=function(e){return e.code<256},t.prototype._toCoordinateX=function(e){return e%this._width*this._config.scaledCharWidth},t.prototype._toCoordinateY=function(e){return Math.floor(e/this._width)*this._config.scaledCharHeight},t.prototype._drawFromCache=function(e,t,r,i){if(!t.isEmpty){var n=this._toCoordinateX(t.index),o=this._toCoordinateY(t.index);e.drawImage(t.inBitmap?this._bitmap:this._cacheCanvas,n,o,this._config.scaledCharWidth,this._config.scaledCharHeight,r,i,this._config.scaledCharWidth,this._config.scaledCharHeight)}},t.prototype._getColorFromAnsiIndex=function(e){return e<this._config.colors.ansi.length?this._config.colors.ansi[e]:a.DEFAULT_ANSI_COLORS[e]},t.prototype._getBackgroundColor=function(e){return this._config.allowTransparency?d:e.bg===o.INVERTED_DEFAULT_COLOR?this._config.colors.foreground:e.bg<256?this._getColorFromAnsiIndex(e.bg):this._config.colors.background},t.prototype._getForegroundColor=function(e){return e.fg===o.INVERTED_DEFAULT_COLOR?this._config.colors.background:e.fg<256?this._getColorFromAnsiIndex(e.fg):this._config.colors.foreground},t.prototype._drawToCache=function(e,t){this._drawToCacheCount++,this._tmpCtx.save();var r=this._getBackgroundColor(e);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=r.css,this._tmpCtx.fillRect(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight),this._tmpCtx.globalCompositeOperation="source-over";var i=e.bold?this._config.fontWeightBold:this._config.fontWeight,n=e.italic?"italic":"";this._tmpCtx.font=n+" "+i+" "+this._config.fontSize*this._config.devicePixelRatio+"px "+this._config.fontFamily,this._tmpCtx.textBaseline="middle",this._tmpCtx.fillStyle=this._getForegroundColor(e).css,e.dim&&(this._tmpCtx.globalAlpha=o.DIM_OPACITY),this._tmpCtx.fillText(e.chars,0,this._config.scaledCharHeight/2),this._tmpCtx.restore();var s=this._tmpCtx.getImageData(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight),a=!1;this._config.allowTransparency||(a=l.clearColor(s,r));var c=this._toCoordinateX(t),h=this._toCoordinateY(t);this._cacheCtx.putImageData(s,c,h);var u={index:t,isEmpty:a,inBitmap:!1};return this._addGlyphToBitmap(u),u},t.prototype._addGlyphToBitmap=function(e){var t=this;"createImageBitmap"in window&&!h.isFirefox&&!h.isSafari&&(this._glyphsWaitingOnBitmap.push(e),null===this._bitmapCommitTimeout&&(this._bitmapCommitTimeout=window.setTimeout(function(){return t._generateBitmap()},100)))},t.prototype._generateBitmap=function(){var e=this,t=this._glyphsWaitingOnBitmap;this._glyphsWaitingOnBitmap=[],window.createImageBitmap(this._cacheCanvas).then(function(r){e._bitmap=r;for(var i=0;i<t.length;i++){t[i].inBitmap=!0}}),this._bitmapCommitTimeout=null},t}(s.default);t.default=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.capacity=e,this._map={},this._head=null,this._tail=null,this._nodePool=[],this.size=0}return e.prototype._unlinkNode=function(e){var t=e.prev,r=e.next;e===this._head&&(this._head=r),e===this._tail&&(this._tail=t),null!==t&&(t.next=r),null!==r&&(r.prev=t)},e.prototype._appendNode=function(e){var t=this._tail;null!==t&&(t.next=e),e.prev=t,e.next=null,this._tail=e,null===this._head&&(this._head=e)},e.prototype.prealloc=function(e){for(var t=this._nodePool,r=0;r<e;r++)t.push({prev:null,next:null,key:null,value:null})},e.prototype.get=function(e){var t=this._map[e];return void 0!==t?(this._unlinkNode(t),this._appendNode(t),t.value):null},e.prototype.peekValue=function(e){var t=this._map[e];return void 0!==t?t.value:null},e.prototype.peek=function(){var e=this._head;return null===e?null:e.value},e.prototype.set=function(e,t){var r=this._map[e];if(void 0!==r)r=this._map[e],this._unlinkNode(r),r.value=t;else if(this.size>=this.capacity)r=this._head,this._unlinkNode(r),delete this._map[r.key],r.key=e,r.value=t,this._map[e]=r;else{var i=this._nodePool;i.length>0?((r=i.pop()).key=e,r.value=t):r={prev:null,next:null,key:e,value:t},this._map[e]=r,this.size++}this._appendNode(r)},e}();t.default=i},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r){return e.call(this)||this}return n(t,e),t.prototype.draw=function(e,t,r,i){return!1},t}(r(18).default);t.default=o},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(9),s=r(25),a=r(18),l=r(17),c=r(12),h=function(e){function t(t,r){var i=e.call(this)||this;return i._document=t,i._config=r,i._canvasFactory=function(e,t){var r=i._document.createElement("canvas");return r.width=e,r.height=t,r},i}return n(t,e),t.prototype._doWarmUp=function(){var e=this,t=s.generateStaticCharAtlasTexture(window,this._canvasFactory,this._config);t instanceof HTMLCanvasElement?this._texture=t:t.then(function(t){e._texture=t})},t.prototype._isCached=function(e,t){var r=e.code<256,i=e.fg<16,n=e.fg===c.DEFAULT_COLOR,o=e.bg===c.DEFAULT_COLOR;return r&&(i||n)&&o&&!e.italic},t.prototype.draw=function(e,t,r,i){if(null===this._texture||void 0===this._texture)return!1;var n=0;if(l.is256Color(t.fg)?n=2+t.fg+(t.bold?16:0):t.fg===c.DEFAULT_COLOR&&t.bold&&(n=1),!this._isCached(t,n))return!1;e.save();var s=this._config.scaledCharWidth+o.CHAR_ATLAS_CELL_SPACING,a=this._config.scaledCharHeight+o.CHAR_ATLAS_CELL_SPACING;return t.dim&&(e.globalAlpha=o.DIM_OPACITY),e.drawImage(this._texture,t.code*s,n*a,s,this._config.scaledCharHeight,r,i,s,this._config.scaledCharHeight),e.restore(),!0},t}(a.default);t.default=h},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,i){var n=e.call(this,t,"selection",r,!0,i)||this;return n._clearState(),n}return n(t,e),t.prototype._clearState=function(){this._state={start:null,end:null,columnSelectMode:null,ydisp:null}},t.prototype.resize=function(t,r){e.prototype.resize.call(this,t,r),this._clearState()},t.prototype.reset=function(e){this._state.start&&this._state.end&&(this._clearState(),this.clearAll())},t.prototype.onSelectionChanged=function(e,t,r,i){if(this._didStateChange(t,r,i,e.buffer.ydisp))if(this.clearAll(),t&&r){var n=t[1]-e.buffer.ydisp,o=r[1]-e.buffer.ydisp,s=Math.max(n,0),a=Math.min(o,e.rows-1);if(!(s>=e.rows||a<0)){if(this._ctx.fillStyle=this._colors.selection.css,i){var l=t[0],c=r[0]-l,h=a-s+1;this.fillCells(l,s,c,h)}else{l=n===s?t[0]:0;var u=s===a?r[0]:e.cols;this.fillCells(l,s,u-l,1);var f=Math.max(a-s-1,0);if(this.fillCells(0,s+1,e.cols,f),s!==a){var d=o===a?r[0]:e.cols;this.fillCells(0,a,d,1)}}this._state.start=[t[0],t[1]],this._state.end=[r[0],r[1]],this._state.columnSelectMode=i,this._state.ydisp=e.buffer.ydisp}}else this._clearState()},t.prototype._didStateChange=function(e,t,r,i){return!this._areCoordinatesEqual(e,this._state.start)||!this._areCoordinatesEqual(t,this._state.end)||r!==this._state.columnSelectMode||i!==this._state.ydisp},t.prototype._areCoordinatesEqual=function(e,t){return!(!e||!t)&&(e[0]===t[0]&&e[1]===t[1])},t}(r(14).BaseRenderLayer);t.SelectionRenderLayer=o},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(14),s=r(7),a=function(e){function t(t,r,i){var n=e.call(this,t,"cursor",r,!0,i)||this;return n._cell=new s.CellData,n._state={x:null,y:null,isFocused:null,style:null,width:null},n._cursorRenderers={bar:n._renderBarCursor.bind(n),block:n._renderBlockCursor.bind(n),underline:n._renderUnderlineCursor.bind(n)},n}return n(t,e),t.prototype.resize=function(t,r){e.prototype.resize.call(this,t,r),this._state={x:null,y:null,isFocused:null,style:null,width:null}},t.prototype.reset=function(e){this._clearCursor(),this._cursorBlinkStateManager&&(this._cursorBlinkStateManager.dispose(),this._cursorBlinkStateManager=null,this.onOptionsChanged(e))},t.prototype.onBlur=function(e){this._cursorBlinkStateManager&&this._cursorBlinkStateManager.pause(),e.refresh(e.buffer.y,e.buffer.y)},t.prototype.onFocus=function(e){this._cursorBlinkStateManager?this._cursorBlinkStateManager.resume(e):e.refresh(e.buffer.y,e.buffer.y)},t.prototype.onOptionsChanged=function(e){var t=this;e.options.cursorBlink?this._cursorBlinkStateManager||(this._cursorBlinkStateManager=new l(e,function(){t._render(e,!0)})):(this._cursorBlinkStateManager&&(this._cursorBlinkStateManager.dispose(),this._cursorBlinkStateManager=null),e.refresh(e.buffer.y,e.buffer.y))},t.prototype.onCursorMove=function(e){this._cursorBlinkStateManager&&this._cursorBlinkStateManager.restartBlinkAnimation(e)},t.prototype.onGridChanged=function(e,t,r){!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isPaused?this._render(e,!1):this._cursorBlinkStateManager.restartBlinkAnimation(e)},t.prototype._render=function(e,t){if(e.cursorState&&!e.cursorHidden){var r=e.buffer.ybase+e.buffer.y,i=r-e.buffer.ydisp;if(i<0||i>=e.rows)this._clearCursor();else if(e.buffer.lines.get(r).loadCell(e.buffer.x,this._cell),void 0!==this._cell.content){if(!e.isFocused)return this._clearCursor(),this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._renderBlurCursor(e,e.buffer.x,i,this._cell),this._ctx.restore(),this._state.x=e.buffer.x,this._state.y=i,this._state.isFocused=!1,this._state.style=e.options.cursorStyle,void(this._state.width=this._cell.getWidth());if(!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isCursorVisible){if(this._state){if(this._state.x===e.buffer.x&&this._state.y===i&&this._state.isFocused===e.isFocused&&this._state.style===e.options.cursorStyle&&this._state.width===this._cell.getWidth())return;this._clearCursor()}this._ctx.save(),this._cursorRenderers[e.options.cursorStyle||"block"](e,e.buffer.x,i,this._cell),this._ctx.restore(),this._state.x=e.buffer.x,this._state.y=i,this._state.isFocused=!1,this._state.style=e.options.cursorStyle,this._state.width=this._cell.getWidth()}else this._clearCursor()}}else this._clearCursor()},t.prototype._clearCursor=function(){this._state&&(this.clearCells(this._state.x,this._state.y,this._state.width,1),this._state={x:null,y:null,isFocused:null,style:null,width:null})},t.prototype._renderBarCursor=function(e,t,r,i){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this.fillLeftLineAtCell(t,r),this._ctx.restore()},t.prototype._renderBlockCursor=function(e,t,r,i){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this.fillCells(t,r,i.getWidth(),1),this._ctx.fillStyle=this._colors.cursorAccent.css,this.fillCharTrueColor(e,i,t,r),this._ctx.restore()},t.prototype._renderUnderlineCursor=function(e,t,r,i){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this.fillBottomLineAtCells(t,r),this._ctx.restore()},t.prototype._renderBlurCursor=function(e,t,r,i){this._ctx.save(),this._ctx.strokeStyle=this._colors.cursor.css,this.strokeRectAtCell(t,r,i.getWidth(),1),this._ctx.restore()},t}(o.BaseRenderLayer);t.CursorRenderLayer=a;var l=function(){function e(e,t){this._renderCallback=t,this.isCursorVisible=!0,e.isFocused&&this._restartInterval()}return Object.defineProperty(e.prototype,"isPaused",{get:function(){return!(this._blinkStartTimeout||this._blinkInterval)},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=null),this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=null),this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=null)},e.prototype.restartBlinkAnimation=function(e){var t=this;this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=window.requestAnimationFrame(function(){t._renderCallback(),t._animationFrame=null})))},e.prototype._restartInterval=function(e){var t=this;void 0===e&&(e=600),this._blinkInterval&&window.clearInterval(this._blinkInterval),this._blinkStartTimeout=setTimeout(function(){if(t._animationTimeRestarted){var e=600-(Date.now()-t._animationTimeRestarted);if(t._animationTimeRestarted=null,e>0)return void t._restartInterval(e)}t.isCursorVisible=!1,t._animationFrame=window.requestAnimationFrame(function(){t._renderCallback(),t._animationFrame=null}),t._blinkInterval=setInterval(function(){if(t._animationTimeRestarted){var e=600-(Date.now()-t._animationTimeRestarted);return t._animationTimeRestarted=null,void t._restartInterval(e)}t.isCursorVisible=!t.isCursorVisible,t._animationFrame=window.requestAnimationFrame(function(){t._renderCallback(),t._animationFrame=null})},600)},e)},e.prototype.pause=function(){this.isCursorVisible=!0,this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=null),this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=null),this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=null)},e.prototype.resume=function(e){this._animationTimeRestarted=null,this._restartInterval(),this.restartBlinkAnimation(e)},e}()},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(14),s=r(9),a=r(17),l=function(e){function t(t,r,i,n){var o=e.call(this,t,"link",r,!0,i)||this;return o._state=null,n.linkifier.onLinkHover(function(e){return o._onLinkHover(e)}),n.linkifier.onLinkLeave(function(e){return o._onLinkLeave(e)}),o}return n(t,e),t.prototype.resize=function(t,r){e.prototype.resize.call(this,t,r),this._state=null},t.prototype.reset=function(e){this._clearCurrentLink()},t.prototype._clearCurrentLink=function(){if(this._state){this.clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);var e=this._state.y2-this._state.y1-1;e>0&&this.clearCells(0,this._state.y1+1,this._state.cols,e),this.clearCells(0,this._state.y2,this._state.x2,1),this._state=null}},t.prototype._onLinkHover=function(e){if(e.fg===s.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._colors.background.css:a.is256Color(e.fg)?this._ctx.fillStyle=this._colors.ansi[e.fg].css:this._ctx.fillStyle=this._colors.foreground.css,e.y1===e.y2)this.fillBottomLineAtCells(e.x1,e.y1,e.x2-e.x1);else{this.fillBottomLineAtCells(e.x1,e.y1,e.cols-e.x1);for(var t=e.y1+1;t<e.y2;t++)this.fillBottomLineAtCells(0,t,e.cols);this.fillBottomLineAtCells(0,e.y2,e.x2)}this._state=e},t.prototype._onLinkLeave=function(e){this._clearCurrentLink()},t}(o.BaseRenderLayer);t.LinkRenderLayer=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(27),n=r(21),o=r(8),s=function(){function e(e){this._terminal=e,this._linkMatchers=[],this._nextLinkMatcherId=0,this._onLinkHover=new o.EventEmitter2,this._onLinkLeave=new o.EventEmitter2,this._onLinkTooltip=new o.EventEmitter2,this._rowsToLinkify={start:null,end:null}}return Object.defineProperty(e.prototype,"onLinkHover",{get:function(){return this._onLinkHover.event},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onLinkLeave",{get:function(){return this._onLinkLeave.event},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onLinkTooltip",{get:function(){return this._onLinkTooltip.event},enumerable:!0,configurable:!0}),e.prototype.attachToDom=function(e){this._mouseZoneManager=e},e.prototype.linkifyRows=function(t,r){var i=this;this._mouseZoneManager&&(null===this._rowsToLinkify.start?(this._rowsToLinkify.start=t,this._rowsToLinkify.end=r):(this._rowsToLinkify.start=Math.min(this._rowsToLinkify.start,t),this._rowsToLinkify.end=Math.max(this._rowsToLinkify.end,r)),this._mouseZoneManager.clearAll(t,r),this._rowsTimeoutId&&clearTimeout(this._rowsTimeoutId),this._rowsTimeoutId=setTimeout(function(){return i._linkifyRows()},e.TIME_BEFORE_LINKIFY))},e.prototype._linkifyRows=function(){this._rowsTimeoutId=null;var t=this._terminal.buffer,r=t.ydisp+this._rowsToLinkify.start;if(!(r>=t.lines.length)){for(var i=t.ydisp+Math.min(this._rowsToLinkify.end,this._terminal.rows)+1,n=Math.ceil(e.OVERSCAN_CHAR_LIMIT/this._terminal.cols),o=this._terminal.buffer.iterator(!1,r,i,n,n);o.hasNext();)for(var s=o.next(),a=0;a<this._linkMatchers.length;a++)this._doLinkifyRow(s.range.first,s.content,this._linkMatchers[a]);this._rowsToLinkify.start=null,this._rowsToLinkify.end=null}},e.prototype.registerLinkMatcher=function(e,t,r){if(void 0===r&&(r={}),!t)throw new Error("handler must be defined");var i={id:this._nextLinkMatcherId++,regex:e,handler:t,matchIndex:r.matchIndex,validationCallback:r.validationCallback,hoverTooltipCallback:r.tooltipCallback,hoverLeaveCallback:r.leaveCallback,willLinkActivate:r.willLinkActivate,priority:r.priority||0};return this._addLinkMatcherToList(i),i.id},e.prototype._addLinkMatcherToList=function(e){if(0!==this._linkMatchers.length){for(var t=this._linkMatchers.length-1;t>=0;t--)if(e.priority<=this._linkMatchers[t].priority)return void this._linkMatchers.splice(t+1,0,e);this._linkMatchers.splice(0,0,e)}else this._linkMatchers.push(e)},e.prototype.deregisterLinkMatcher=function(e){for(var t=0;t<this._linkMatchers.length;t++)if(this._linkMatchers[t].id===e)return this._linkMatchers.splice(t,1),!0;return!1},e.prototype._doLinkifyRow=function(e,t,r){for(var i,n=this,o=new RegExp(r.regex.source,r.regex.flags+"g"),s=-1,a=function(){var a=i["number"!=typeof r.matchIndex?0:r.matchIndex];if(!a){if(l._terminal.debug)throw console.log({match:i,matcher:r}),new Error("match found without corresponding matchIndex");return"break"}if(s=t.indexOf(a,s+1),o.lastIndex=s+a.length,s<0)return"break";var c=l._terminal.buffer.stringIndexToBufferIndex(e,s);if(c[0]<0)return"break";var h,u=l._terminal.buffer.lines.get(c[0]).getFg(c[1]);u&&(h=u>>9&511),r.validationCallback?r.validationCallback(a,function(e){n._rowsTimeoutId||e&&n._addLink(c[1],c[0]-n._terminal.buffer.ydisp,a,r,h)}):l._addLink(c[1],c[0]-l._terminal.buffer.ydisp,a,r,h)},l=this;null!==(i=o.exec(t));){if("break"===a())break}},e.prototype._addLink=function(e,t,r,o,s){var a=this,l=n.getStringCellWidth(r),c=e%this._terminal.cols,h=t+Math.floor(e/this._terminal.cols),u=(c+l)%this._terminal.cols,f=h+Math.floor((c+l)/this._terminal.cols);0===u&&(u=this._terminal.cols,f--),this._mouseZoneManager.add(new i.MouseZone(c+1,h+1,u+1,f+1,function(e){if(o.handler)return o.handler(e,r);window.open(r,"_blank")},function(){a._onLinkHover.fire(a._createLinkHoverEvent(c,h,u,f,s)),a._terminal.element.classList.add("xterm-cursor-pointer")},function(e){a._onLinkTooltip.fire(a._createLinkHoverEvent(c,h,u,f,s)),o.hoverTooltipCallback&&o.hoverTooltipCallback(e,r)},function(){a._onLinkLeave.fire(a._createLinkHoverEvent(c,h,u,f,s)),a._terminal.element.classList.remove("xterm-cursor-pointer"),o.hoverLeaveCallback&&o.hoverLeaveCallback()},function(e){return!o.willLinkActivate||o.willLinkActivate(e,r)}))},e.prototype._createLinkHoverEvent=function(e,t,r,i,n){return{x1:e,y1:t,x2:r,y2:i,cols:this._terminal.cols,fg:n}},e.TIME_BEFORE_LINKIFY=200,e.OVERSCAN_CHAR_LIMIT=2e3,e}();t.Linkifier=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(28),n=r(11),o=r(58),s=r(59),a=r(7),l=r(8),c=String.fromCharCode(160),h=new RegExp(c,"g"),u=function(){function e(e,t){this._terminal=e,this._charMeasure=t,this._enabled=!0,this._workCell=new a.CellData,this._onLinuxMouseSelection=new l.EventEmitter2,this._onRedrawRequest=new l.EventEmitter2,this._onSelectionChange=new l.EventEmitter2,this._initListeners(),this.enable(),this._model=new o.SelectionModel(e),this._activeSelectionMode=0}return Object.defineProperty(e.prototype,"onLinuxMouseSelection",{get:function(){return this._onLinuxMouseSelection.event},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onRedrawRequest",{get:function(){return this._onRedrawRequest.event},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onSelectionChange",{get:function(){return this._onSelectionChange.event},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._removeMouseDownListeners()},Object.defineProperty(e.prototype,"_buffer",{get:function(){return this._terminal.buffers.active},enumerable:!0,configurable:!0}),e.prototype._initListeners=function(){var e=this;this._mouseMoveListener=function(t){return e._onMouseMove(t)},this._mouseUpListener=function(t){return e._onMouseUp(t)},this.initBuffersListeners()},e.prototype.initBuffersListeners=function(){var e=this;this._trimListener=this._terminal.buffer.lines.onTrim(function(t){return e._onTrim(t)}),this._terminal.buffers.onBufferActivate(function(t){return e._onBufferActivate(t)})},e.prototype.disable=function(){this.clearSelection(),this._enabled=!1},e.prototype.enable=function(){this._enabled=!0},Object.defineProperty(e.prototype,"selectionStart",{get:function(){return this._model.finalSelectionStart},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionEnd",{get:function(){return this._model.finalSelectionEnd},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasSelection",{get:function(){var e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;return!(!e||!t)&&(e[0]!==t[0]||e[1]!==t[1])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionText",{get:function(){var e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;if(!e||!t)return"";var r=[];if(3===this._activeSelectionMode){if(e[0]===t[0])return"";for(var i=e[1];i<=t[1];i++){var o=this._buffer.translateBufferLineToString(i,!0,e[0],t[0]);r.push(o)}}else{var s=e[1]===t[1]?t[0]:void 0;r.push(this._buffer.translateBufferLineToString(e[1],!0,e[0],s));for(i=e[1]+1;i<=t[1]-1;i++){var a=this._buffer.lines.get(i);o=this._buffer.translateBufferLineToString(i,!0);a.isWrapped?r[r.length-1]+=o:r.push(o)}if(e[1]!==t[1]){a=this._buffer.lines.get(t[1]),o=this._buffer.translateBufferLineToString(t[1],!0,0,t[0]);a.isWrapped?r[r.length-1]+=o:r.push(o)}}return r.map(function(e){return e.replace(h," ")}).join(n.isMSWindows?"\r\n":"\n")},enumerable:!0,configurable:!0}),e.prototype.clearSelection=function(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()},e.prototype.refresh=function(e){var t=this;(this._refreshAnimationFrame||(this._refreshAnimationFrame=window.requestAnimationFrame(function(){return t._refresh()})),n.isLinux&&e)&&(this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText))},e.prototype._refresh=function(){this._refreshAnimationFrame=null,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:3===this._activeSelectionMode})},e.prototype.isClickInSelection=function(e){var t=this._getMouseBufferCoords(e),r=this._model.finalSelectionStart,i=this._model.finalSelectionEnd;return!(!r||!i)&&this._areCoordsInSelection(t,r,i)},e.prototype._areCoordsInSelection=function(e,t,r){return e[1]>t[1]&&e[1]<r[1]||t[1]===r[1]&&e[1]===t[1]&&e[0]>=t[0]&&e[0]<r[0]||t[1]<r[1]&&e[1]===r[1]&&e[0]<r[0]||t[1]<r[1]&&e[1]===t[1]&&e[0]>=t[0]},e.prototype.selectWordAtCursor=function(e){var t=this._getMouseBufferCoords(e);t&&(this._selectWordAt(t,!1),this._model.selectionEnd=null,this.refresh(!0))},e.prototype.selectAll=function(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()},e.prototype.selectLines=function(e,t){this._model.clearSelection(),e=Math.max(e,0),t=Math.min(t,this._terminal.buffer.lines.length-1),this._model.selectionStart=[0,e],this._model.selectionEnd=[this._terminal.cols,t],this.refresh(),this._onSelectionChange.fire()},e.prototype._onTrim=function(e){this._model.onTrim(e)&&this.refresh()},e.prototype._getMouseBufferCoords=function(e){var t=this._terminal.mouseHelper.getCoords(e,this._terminal.screenElement,this._charMeasure,this._terminal.cols,this._terminal.rows,!0);return t?(t[0]--,t[1]--,t[1]+=this._terminal.buffer.ydisp,t):null},e.prototype._getMouseEventScrollAmount=function(e){var t=i.MouseHelper.getCoordsRelativeToElement(e,this._terminal.screenElement)[1],r=this._terminal.rows*Math.ceil(this._charMeasure.height*this._terminal.options.lineHeight);return t>=0&&t<=r?0:(t>r&&(t-=r),t=Math.min(Math.max(t,-50),50),(t/=50)/Math.abs(t)+Math.round(14*t))},e.prototype.shouldForceSelection=function(e){return n.isMac?e.altKey&&this._terminal.options.macOptionClickForcesSelection:e.shiftKey},e.prototype.onMouseDown=function(e){if(this._mouseDownTimeStamp=e.timeStamp,(2!==e.button||!this.hasSelection)&&0===e.button){if(!this._enabled){if(!this.shouldForceSelection(e))return;e.stopPropagation()}e.preventDefault(),this._dragScrollAmount=0,this._enabled&&e.shiftKey?this._onIncrementalClick(e):1===e.detail?this._onSingleClick(e):2===e.detail?this._onDoubleClick(e):3===e.detail&&this._onTripleClick(e),this._addMouseDownListeners(),this.refresh(!0)}},e.prototype._addMouseDownListeners=function(){var e=this;this._terminal.element.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._terminal.element.ownerDocument.addEventListener("mouseup",this._mouseUpListener),this._dragScrollIntervalTimer=setInterval(function(){return e._dragScroll()},50)},e.prototype._removeMouseDownListeners=function(){this._terminal.element.ownerDocument&&(this._terminal.element.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._terminal.element.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=null},e.prototype._onIncrementalClick=function(e){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(e))},e.prototype._onSingleClick=function(e){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(e)?3:0,this._model.selectionStart=this._getMouseBufferCoords(e),this._model.selectionStart){this._model.selectionEnd=null;var t=this._buffer.lines.get(this._model.selectionStart[1]);t&&(t.length>=this._model.selectionStart[0]||0===t.hasWidth(this._model.selectionStart[0])&&this._model.selectionStart[0]++)}},e.prototype._onDoubleClick=function(e){var t=this._getMouseBufferCoords(e);t&&(this._activeSelectionMode=1,this._selectWordAt(t,!0))},e.prototype._onTripleClick=function(e){var t=this._getMouseBufferCoords(e);t&&(this._activeSelectionMode=2,this._selectLineAt(t[1]))},e.prototype.shouldColumnSelect=function(e){return e.altKey&&!(n.isMac&&this._terminal.options.macOptionClickForcesSelection)},e.prototype._onMouseMove=function(e){e.stopImmediatePropagation();var t=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;this._model.selectionEnd=this._getMouseBufferCoords(e),this._model.selectionEnd?(2===this._activeSelectionMode?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._terminal.cols:1===this._activeSelectionMode&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(e),3!==this._activeSelectionMode&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._terminal.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0)),this._model.selectionEnd[1]<this._buffer.lines.length&&0===this._buffer.lines.get(this._model.selectionEnd[1]).hasWidth(this._model.selectionEnd[0])&&this._model.selectionEnd[0]++,t&&t[0]===this._model.selectionEnd[0]&&t[1]===this._model.selectionEnd[1]||this.refresh(!0)):this.refresh(!0)},e.prototype._dragScroll=function(){this._dragScrollAmount&&(this._terminal.scrollLines(this._dragScrollAmount,!1),this._dragScrollAmount>0?(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=this._terminal.cols),this._model.selectionEnd[1]=Math.min(this._terminal.buffer.ydisp+this._terminal.rows,this._terminal.buffer.lines.length-1)):(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=this._terminal.buffer.ydisp),this.refresh())},e.prototype._onMouseUp=function(e){var t=e.timeStamp-this._mouseDownTimeStamp;this._removeMouseDownListeners(),this.selectionText.length<=1&&t<500?new s.AltClickHandler(e,this._terminal).move():this.hasSelection&&this._onSelectionChange.fire()},e.prototype._onBufferActivate=function(e){var t=this;this.clearSelection(),this._trimListener&&this._trimListener.dispose(),this._trimListener=e.activeBuffer.lines.onTrim(function(e){return t._onTrim(e)})},e.prototype._convertViewportColToCharacterIndex=function(e,t){for(var r=t[0],i=0;t[0]>=i;i++){var n=e.loadCell(i,this._workCell).getChars().length;0===this._workCell.getWidth()?r--:n>1&&t[0]!==i&&(r+=n-1)}return r},e.prototype.setSelection=function(e,t,r){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[e,t],this._model.selectionStartLength=r,this.refresh()},e.prototype._getWordAt=function(e,t,r,i){if(void 0===r&&(r=!0),void 0===i&&(i=!0),e[0]>=this._terminal.cols)return null;var n=this._buffer.lines.get(e[1]);if(!n)return null;var o=this._buffer.translateBufferLineToString(e[1],!1),s=this._convertViewportColToCharacterIndex(n,e),a=s,l=e[0]-s,c=0,h=0,u=0,f=0;if(" "===o.charAt(s)){for(;s>0&&" "===o.charAt(s-1);)s--;for(;a<o.length&&" "===o.charAt(a+1);)a++}else{var d=e[0],p=e[0];0===n.getWidth(d)&&(c++,d--),2===n.getWidth(p)&&(h++,p++);var m=n.getString(p).length;for(m>1&&(f+=m-1,a+=m-1);d>0&&s>0&&!this._isCharWordSeparator(n.loadCell(d-1,this._workCell));){n.loadCell(d-1,this._workCell);var g=this._workCell.getChars().length;0===this._workCell.getWidth()?(c++,d--):g>1&&(u+=g-1,s-=g-1),s--,d--}for(;p<n.length&&a+1<o.length&&!this._isCharWordSeparator(n.loadCell(p+1,this._workCell));){n.loadCell(p+1,this._workCell);var _=this._workCell.getChars().length;2===this._workCell.getWidth()?(h++,p++):_>1&&(f+=_-1,a+=_-1),a++,p++}}a++;var v=s+l-c+u,y=Math.min(this._terminal.cols,a-s+c+h-u-f);if(!t&&""===o.slice(s,a).trim())return null;if(r&&0===v&&32!==n.getCodePoint(0)){var C=this._buffer.lines.get(e[1]-1);if(C&&n.isWrapped&&32!==C.getCodePoint(this._terminal.cols-1)){var b=this._getWordAt([this._terminal.cols-1,e[1]-1],!1,!0,!1);if(b){var w=this._terminal.cols-b.start;v-=w,y+=w}}}if(i&&v+y===this._terminal.cols&&32!==n.getCodePoint(this._terminal.cols-1)){var x=this._buffer.lines.get(e[1]+1);if(x&&x.isWrapped&&32!==x.getCodePoint(0)){var S=this._getWordAt([0,e[1]+1],!1,!1,!0);S&&(y+=S.length)}}return{start:v,length:y}},e.prototype._selectWordAt=function(e,t){var r=this._getWordAt(e,t);if(r){for(;r.start<0;)r.start+=this._terminal.cols,e[1]--;this._model.selectionStart=[r.start,e[1]],this._model.selectionStartLength=r.length}},e.prototype._selectToWordAt=function(e){var t=this._getWordAt(e,!0);if(t){for(var r=e[1];t.start<0;)t.start+=this._terminal.cols,r--;if(!this._model.areSelectionValuesReversed())for(;t.start+t.length>this._terminal.cols;)t.length-=this._terminal.cols,r++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?t.start:t.start+t.length,r]}},e.prototype._isCharWordSeparator=function(e){return 0!==e.getWidth()&&" ()[]{}'\"".indexOf(e.getChars())>=0},e.prototype._selectLineAt=function(e){var t=this._buffer.getWrappedRangeForLine(e);this._model.selectionStart=[0,t.first],this._model.selectionEnd=[this._terminal.cols,t.last],this._model.selectionStartLength=0},e}();t.SelectionManager=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._terminal=e,this.clearSelection()}return e.prototype.clearSelection=function(){this.selectionStart=null,this.selectionEnd=null,this.isSelectAllActive=!1,this.selectionStartLength=0},Object.defineProperty(e.prototype,"finalSelectionStart",{get:function(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"finalSelectionEnd",{get:function(){if(this.isSelectAllActive)return[this._terminal.cols,this._terminal.buffer.ybase+this._terminal.rows-1];if(!this.selectionStart)return null;if(!this.selectionEnd||this.areSelectionValuesReversed()){var e=this.selectionStart[0]+this.selectionStartLength;return e>this._terminal.cols?[e%this._terminal.cols,this.selectionStart[1]+Math.floor(e/this._terminal.cols)]:[e,this.selectionStart[1]]}return this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]?[Math.max(this.selectionStart[0]+this.selectionStartLength,this.selectionEnd[0]),this.selectionEnd[1]]:this.selectionEnd},enumerable:!0,configurable:!0}),e.prototype.areSelectionValuesReversed=function(){var e=this.selectionStart,t=this.selectionEnd;return!(!e||!t)&&(e[1]>t[1]||e[1]===t[1]&&e[0]>t[0])},e.prototype.onTrim=function(e){return this.selectionStart&&(this.selectionStart[1]-=e),this.selectionEnd&&(this.selectionEnd[1]-=e),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)},e}();t.SelectionModel=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(13),n=function(){function e(e,t){var r;this._mouseEvent=e,this._terminal=t,this._lines=this._terminal.buffer.lines,this._startCol=this._terminal.buffer.x,this._startRow=this._terminal.buffer.y;var i=this._terminal.mouseHelper.getCoords(this._mouseEvent,this._terminal.element,this._terminal.charMeasure,this._terminal.cols,this._terminal.rows,!1);i&&(r=i.map(function(e){return e-1}),this._endCol=r[0],this._endRow=r[1])}return e.prototype.move=function(){this._mouseEvent.altKey&&void 0!==this._endCol&&void 0!==this._endRow&&this._terminal.handler(this._arrowSequences())},e.prototype._arrowSequences=function(){return this._terminal.buffer.hasScrollback?this._moveHorizontallyOnly():this._resetStartingRow()+this._moveToRequestedRow()+this._moveToRequestedCol()},e.prototype._resetStartingRow=function(){return 0===this._moveToRequestedRow().length?"":o(this._bufferLine(this._startCol,this._startRow,this._startCol,this._startRow-this._wrappedRowsForRow(this._startRow),!1).length,this._sequence("D"))},e.prototype._moveToRequestedRow=function(){var e=this._startRow-this._wrappedRowsForRow(this._startRow),t=this._endRow-this._wrappedRowsForRow(this._endRow);return o(Math.abs(e-t)-this._wrappedRowsCount(),this._sequence(this._verticalDirection()))},e.prototype._moveToRequestedCol=function(){var e;e=this._moveToRequestedRow().length>0?this._endRow-this._wrappedRowsForRow(this._endRow):this._startRow;var t=this._endRow,r=this._horizontalDirection();return o(this._bufferLine(this._startCol,e,this._endCol,t,"C"===r).length,this._sequence(r))},e.prototype._moveHorizontallyOnly=function(){var e=this._horizontalDirection();return o(Math.abs(this._startCol-this._endCol),this._sequence(e))},e.prototype._wrappedRowsCount=function(){for(var e=0,t=this._startRow-this._wrappedRowsForRow(this._startRow),r=this._endRow-this._wrappedRowsForRow(this._endRow),i=0;i<Math.abs(t-r);i++){var n="A"===this._verticalDirection()?-1:1;this._lines.get(t+n*i).isWrapped&&e++}return e},e.prototype._wrappedRowsForRow=function(e){for(var t=0,r=this._lines.get(e).isWrapped;r&&e>=0&&e<this._terminal.rows;)t++,e--,r=this._lines.get(e).isWrapped;return t},e.prototype._horizontalDirection=function(){var e;return e=this._moveToRequestedRow().length>0?this._endRow-this._wrappedRowsForRow(this._endRow):this._startRow,this._startCol<this._endCol&&e<=this._endRow||this._startCol>=this._endCol&&e<this._endRow?"C":"D"},e.prototype._verticalDirection=function(){return this._startRow>this._endRow?"A":"B"},e.prototype._bufferLine=function(e,t,r,i,n){for(var o=e,s=t,a="";o!==r||s!==i;)o+=n?1:-1,n&&o>this._terminal.cols-1?(a+=this._terminal.buffer.translateBufferLineToString(s,!1,e,o),o=0,e=0,s++):!n&&o<0&&(a+=this._terminal.buffer.translateBufferLineToString(s,!1,0,e+1),e=o=this._terminal.cols-1,s--);return a+this._terminal.buffer.translateBufferLineToString(s,!1,e,o)},e.prototype._sequence=function(e){var t=this._terminal.applicationCursor?"O":"[";return i.C0.ESC+t+e},e}();function o(e,t){e=Math.floor(e);for(var r="",i=0;i<e;i++)r+=t;return r}t.AltClickHandler=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(8),n=function(){function e(e,t){this._onCharSizeChanged=new i.EventEmitter2,this._document=e,this._parentElement=t,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}return Object.defineProperty(e.prototype,"onCharSizeChanged",{get:function(){return this._onCharSizeChanged.event},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.measure=function(e){this._measureElement.style.fontFamily=e.fontFamily,this._measureElement.style.fontSize=e.fontSize+"px";var t=this._measureElement.getBoundingClientRect();if(0!==t.width&&0!==t.height){var r=Math.ceil(t.height);this._width===t.width&&this._height===r||(this._width=t.width,this._height=r,this._onCharSizeChanged.fire())}},e}();t.CharMeasure=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_BELL_SOUND="data:audio/wav;base64,UklGRigBAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQBAADpAFgCwAMlBZoG/wdmCcoKRAypDQ8PbRDBEQQTOxRtFYcWlBePGIUZXhoiG88bcBz7HHIdzh0WHlMeZx51HmkeUx4WHs8dah0AHXwc3hs9G4saxRnyGBIYGBcQFv8U4RPAEoYRQBACD70NWwwHC6gJOwjWBloF7gOBAhABkf8b/qv8R/ve+Xf4Ife79W/0JfPZ8Z/wde9N7ijtE+wU6xvqM+lb6H7nw+YX5mrlxuQz5Mzje+Ma49fioeKD4nXiYeJy4pHitOL04j/jn+MN5IPkFOWs5U3mDefM55/ogOl36m7rdOyE7abuyu8D8Unyj/Pg9D/2qfcb+Yn6/vuK/Qj/lAAlAg==";var i=function(){function e(e){this._terminal=e}return Object.defineProperty(e,"audioContext",{get:function(){if(!e._audioContext){var t=window.AudioContext||window.webkitAudioContext;if(!t)return console.warn("Web Audio API is not supported by this browser. Consider upgrading to the latest version"),null;e._audioContext=new t}return e._audioContext},enumerable:!0,configurable:!0}),e.prototype.playBellSound=function(){var t=e.audioContext;if(t){var r=t.createBufferSource();t.decodeAudioData(this._base64ToArrayBuffer(this._removeMimeType(this._terminal.options.bellSound)),function(e){r.buffer=e,r.connect(t.destination),r.start(0)})}},e.prototype._base64ToArrayBuffer=function(e){for(var t=window.atob(e),r=t.length,i=new Uint8Array(r),n=0;n<r;n++)i[n]=t.charCodeAt(n);return i.buffer},e.prototype._removeMimeType=function(e){return e.split(",")[1]},e}();t.SoundManager=i},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(19),s=r(11),a=r(29),l=r(10),c=r(6),h=r(30),u=function(e){function t(t,r){var i=e.call(this)||this;i._terminal=t,i._dimensions=r,i._liveRegionLineCount=0,i._charsToConsume=[],i._charsToAnnounce="",i._accessibilityTreeRoot=document.createElement("div"),i._accessibilityTreeRoot.classList.add("xterm-accessibility"),i._rowContainer=document.createElement("div"),i._rowContainer.classList.add("xterm-accessibility-tree"),i._rowElements=[];for(var n=0;n<i._terminal.rows;n++)i._rowElements[n]=i._createAccessibilityTreeNode(),i._rowContainer.appendChild(i._rowElements[n]);return i._topBoundaryFocusListener=function(e){return i._onBoundaryFocus(e,0)},i._bottomBoundaryFocusListener=function(e){return i._onBoundaryFocus(e,1)},i._rowElements[0].addEventListener("focus",i._topBoundaryFocusListener),i._rowElements[i._rowElements.length-1].addEventListener("focus",i._bottomBoundaryFocusListener),i._refreshRowsDimensions(),i._accessibilityTreeRoot.appendChild(i._rowContainer),i._renderRowsDebouncer=new a.RenderDebouncer(i._renderRows.bind(i)),i._refreshRows(),i._liveRegion=document.createElement("div"),i._liveRegion.classList.add("live-region"),i._liveRegion.setAttribute("aria-live","assertive"),i._accessibilityTreeRoot.appendChild(i._liveRegion),i._terminal.element.insertAdjacentElement("afterbegin",i._accessibilityTreeRoot),i.register(i._renderRowsDebouncer),i.register(i._terminal.onResize(function(e){return i._onResize(e.rows)})),i.register(i._terminal.onRender(function(e){return i._refreshRows(e.start,e.end)})),i.register(i._terminal.onScroll(function(){return i._refreshRows()})),i.register(i._terminal.addDisposableListener("a11y.char",function(e){return i._onChar(e)})),i.register(i._terminal.onLineFeed(function(){return i._onChar("\n")})),i.register(i._terminal.addDisposableListener("a11y.tab",function(e){return i._onTab(e)})),i.register(i._terminal.onKey(function(e){return i._onKey(e.key)})),i.register(i._terminal.addDisposableListener("blur",function(){return i._clearLiveRegion()})),i._screenDprMonitor=new h.ScreenDprMonitor,i.register(i._screenDprMonitor),i._screenDprMonitor.setListener(function(){return i._refreshRowsDimensions()}),i.register(l.addDisposableDomListener(window,"resize",function(){return i._refreshRowsDimensions()})),i}return n(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._terminal.element.removeChild(this._accessibilityTreeRoot),this._rowElements.length=0},t.prototype._onBoundaryFocus=function(e,t){var r=e.target,i=this._rowElements[0===t?1:this._rowElements.length-2];if(r.getAttribute("aria-posinset")!==(0===t?"1":""+this._terminal.buffer.lines.length)&&e.relatedTarget===i){var n,o;if(0===t?(n=r,o=this._rowElements.pop(),this._rowContainer.removeChild(o)):(n=this._rowElements.shift(),o=r,this._rowContainer.removeChild(n)),n.removeEventListener("focus",this._topBoundaryFocusListener),o.removeEventListener("focus",this._bottomBoundaryFocusListener),0===t){var s=this._createAccessibilityTreeNode();this._rowElements.unshift(s),this._rowContainer.insertAdjacentElement("afterbegin",s)}else{s=this._createAccessibilityTreeNode();this._rowElements.push(s),this._rowContainer.appendChild(s)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(0===t?-1:1),this._rowElements[0===t?1:this._rowElements.length-2].focus(),e.preventDefault(),e.stopImmediatePropagation()}},t.prototype._onResize=function(e){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(var t=this._rowContainer.children.length;t<this._terminal.rows;t++)this._rowElements[t]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[t]);for(;this._rowElements.length>e;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()},t.prototype._createAccessibilityTreeNode=function(){var e=document.createElement("div");return e.setAttribute("role","listitem"),e.tabIndex=-1,this._refreshRowDimensions(e),e},t.prototype._onTab=function(e){for(var t=0;t<e;t++)this._onChar(" ")},t.prototype._onChar=function(e){var t=this;if(this._liveRegionLineCount<21){if(this._charsToConsume.length>0)this._charsToConsume.shift()!==e&&(this._charsToAnnounce+=e);else this._charsToAnnounce+=e;"\n"===e&&(this._liveRegionLineCount++,21===this._liveRegionLineCount&&(this._liveRegion.textContent+=o.tooMuchOutput)),s.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(function(){t._accessibilityTreeRoot.appendChild(t._liveRegion)},0)}},t.prototype._clearLiveRegion=function(){this._liveRegion.textContent="",this._liveRegionLineCount=0,s.isMac&&this._liveRegion.parentNode&&this._accessibilityTreeRoot.removeChild(this._liveRegion)},t.prototype._onKey=function(e){this._clearLiveRegion(),this._charsToConsume.push(e)},t.prototype._refreshRows=function(e,t){this._renderRowsDebouncer.refresh(e,t,this._terminal.rows)},t.prototype._renderRows=function(e,t){for(var r=this._terminal.buffer,i=r.lines.length.toString(),n=e;n<=t;n++){var s=r.translateBufferLineToString(r.ydisp+n,!0),a=(r.ydisp+n+1).toString(),l=this._rowElements[n];l&&(l.textContent=0===s.length?o.blankLine:s,l.setAttribute("aria-posinset",a),l.setAttribute("aria-setsize",i))}this._announceCharacters()},t.prototype._refreshRowsDimensions=function(){if(this._dimensions.actualCellHeight){this._rowElements.length!==this._terminal.rows&&this._onResize(this._terminal.rows);for(var e=0;e<this._terminal.rows;e++)this._refreshRowDimensions(this._rowElements[e])}},t.prototype.setDimensions=function(e){this._dimensions=e,this._refreshRowsDimensions()},t.prototype._refreshRowDimensions=function(e){e.style.height=this._dimensions.actualCellHeight+"px"},t.prototype._announceCharacters=function(){0!==this._charsToAnnounce.length&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")},t}(c.Disposable);t.AccessibilityManager=u},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(64),s=r(9),a=r(6),l="xterm-dom-renderer-owner-",c="xterm-rows",h="xterm-selection",u=1,f=function(e){function t(t,r){var i=e.call(this)||this;return i._terminal=t,i._colors=r,i._terminalClass=u++,i._rowElements=[],i._rowContainer=document.createElement("div"),i._rowContainer.classList.add(c),i._rowContainer.style.lineHeight="normal",i._rowContainer.setAttribute("aria-hidden","true"),i._refreshRowElements(i._terminal.cols,i._terminal.rows),i._selectionContainer=document.createElement("div"),i._selectionContainer.classList.add(h),i._selectionContainer.setAttribute("aria-hidden","true"),i.dimensions={scaledCharWidth:null,scaledCharHeight:null,scaledCellWidth:null,scaledCellHeight:null,scaledCharLeft:null,scaledCharTop:null,scaledCanvasWidth:null,scaledCanvasHeight:null,canvasWidth:null,canvasHeight:null,actualCellWidth:null,actualCellHeight:null},i._updateDimensions(),i._injectCss(),i._rowFactory=new o.DomRendererRowFactory(t.options,document),i._terminal.element.classList.add(l+i._terminalClass),i._terminal.screenElement.appendChild(i._rowContainer),i._terminal.screenElement.appendChild(i._selectionContainer),i._terminal.linkifier.onLinkHover(function(e){return i._onLinkHover(e)}),i._terminal.linkifier.onLinkLeave(function(e){return i._onLinkLeave(e)}),i}return n(t,e),t.prototype.dispose=function(){this._terminal.element.classList.remove(l+this._terminalClass),this._terminal.screenElement.removeChild(this._rowContainer),this._terminal.screenElement.removeChild(this._selectionContainer),this._terminal.screenElement.removeChild(this._themeStyleElement),this._terminal.screenElement.removeChild(this._dimensionsStyleElement),e.prototype.dispose.call(this)},t.prototype._updateDimensions=function(){var e=this;this.dimensions.scaledCharWidth=this._terminal.charMeasure.width*window.devicePixelRatio,this.dimensions.scaledCharHeight=Math.ceil(this._terminal.charMeasure.height*window.devicePixelRatio),this.dimensions.scaledCellWidth=this.dimensions.scaledCharWidth+Math.round(this._terminal.options.letterSpacing),this.dimensions.scaledCellHeight=Math.floor(this.dimensions.scaledCharHeight*this._terminal.options.lineHeight),this.dimensions.scaledCharLeft=0,this.dimensions.scaledCharTop=0,this.dimensions.scaledCanvasWidth=this.dimensions.scaledCellWidth*this._terminal.cols,this.dimensions.scaledCanvasHeight=this.dimensions.scaledCellHeight*this._terminal.rows,this.dimensions.canvasWidth=Math.round(this.dimensions.scaledCanvasWidth/window.devicePixelRatio),this.dimensions.canvasHeight=Math.round(this.dimensions.scaledCanvasHeight/window.devicePixelRatio),this.dimensions.actualCellWidth=this.dimensions.canvasWidth/this._terminal.cols,this.dimensions.actualCellHeight=this.dimensions.canvasHeight/this._terminal.rows,this._rowElements.forEach(function(t){t.style.width=e.dimensions.canvasWidth+"px",t.style.height=e.dimensions.actualCellHeight+"px",t.style.lineHeight=e.dimensions.actualCellHeight+"px",t.style.overflow="hidden"}),this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._terminal.screenElement.appendChild(this._dimensionsStyleElement));var t=this._terminalSelector+" ."+c+" span { display: inline-block; height: 100%; vertical-align: top; width: "+this.dimensions.actualCellWidth+"px}";this._dimensionsStyleElement.innerHTML=t,this._selectionContainer.style.height=this._terminal._viewportElement.style.height,this._terminal.screenElement.style.width=this.dimensions.canvasWidth+"px",this._terminal.screenElement.style.height=this.dimensions.canvasHeight+"px"},t.prototype.setColors=function(e){this._colors=e,this._injectCss()},t.prototype._injectCss=function(){var e=this;this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._terminal.screenElement.appendChild(this._themeStyleElement));var t=this._terminalSelector+" ."+c+" { color: "+this._colors.foreground.css+"; background-color: "+this._colors.background.css+"; font-family: "+this._terminal.options.fontFamily+"; font-size: "+this._terminal.options.fontSize+"px;}";t+=this._terminalSelector+" span:not(."+o.BOLD_CLASS+") { font-weight: "+this._terminal.options.fontWeight+";}"+this._terminalSelector+" span."+o.BOLD_CLASS+" { font-weight: "+this._terminal.options.fontWeightBold+";}"+this._terminalSelector+" span."+o.ITALIC_CLASS+" { font-style: italic;}",t+="@keyframes blink { 0% { opacity: 1.0; } 50% { opacity: 0.0; } 100% { opacity: 1.0; }}",t+=this._terminalSelector+" ."+c+":not(.xterm-focus) ."+o.CURSOR_CLASS+" { outline: 1px solid "+this._colors.cursor.css+"; outline-offset: -1px;}"+this._terminalSelector+" ."+c+".xterm-focus ."+o.CURSOR_CLASS+"."+o.CURSOR_BLINK_CLASS+" { animation: blink 1s step-end infinite;}"+this._terminalSelector+" ."+c+".xterm-focus ."+o.CURSOR_CLASS+"."+o.CURSOR_STYLE_BLOCK_CLASS+" { background-color: "+this._colors.cursor.css+"; color: "+this._colors.cursorAccent.css+";}"+this._terminalSelector+" ."+c+".xterm-focus ."+o.CURSOR_CLASS+"."+o.CURSOR_STYLE_BAR_CLASS+" { box-shadow: 1px 0 0 "+this._colors.cursor.css+" inset;}"+this._terminalSelector+" ."+c+".xterm-focus ."+o.CURSOR_CLASS+"."+o.CURSOR_STYLE_UNDERLINE_CLASS+" { box-shadow: 0 -1px 0 "+this._colors.cursor.css+" inset;}",t+=this._terminalSelector+" ."+h+" { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}"+this._terminalSelector+" ."+h+" div { position: absolute; background-color: "+this._colors.selection.css+";}",this._colors.ansi.forEach(function(r,i){t+=e._terminalSelector+" .xterm-fg-"+i+" { color: "+r.css+"; }"+e._terminalSelector+" .xterm-bg-"+i+" { background-color: "+r.css+"; }"}),t+=this._terminalSelector+" .xterm-fg-"+s.INVERTED_DEFAULT_COLOR+" { color: "+this._colors.background.css+"; }"+this._terminalSelector+" .xterm-bg-"+s.INVERTED_DEFAULT_COLOR+" { background-color: "+this._colors.foreground.css+"; }",this._themeStyleElement.innerHTML=t},t.prototype.onDevicePixelRatioChange=function(){this._updateDimensions()},t.prototype._refreshRowElements=function(e,t){for(var r=this._rowElements.length;r<=t;r++){var i=document.createElement("div");this._rowContainer.appendChild(i),this._rowElements.push(i)}for(;this._rowElements.length>t;)this._rowContainer.removeChild(this._rowElements.pop())},t.prototype.onResize=function(e,t){this._refreshRowElements(e,t),this._updateDimensions()},t.prototype.onCharSizeChanged=function(){this._updateDimensions()},t.prototype.onBlur=function(){this._rowContainer.classList.remove("xterm-focus")},t.prototype.onFocus=function(){this._rowContainer.classList.add("xterm-focus")},t.prototype.onSelectionChanged=function(e,t,r){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(e&&t){var i=e[1]-this._terminal.buffer.ydisp,n=t[1]-this._terminal.buffer.ydisp,o=Math.max(i,0),s=Math.min(n,this._terminal.rows-1);if(!(o>=this._terminal.rows||s<0)){var a=document.createDocumentFragment();if(r)a.appendChild(this._createSelectionElement(o,e[0],t[0],s-o+1));else{var l=i===o?e[0]:0,c=o===s?t[0]:this._terminal.cols;a.appendChild(this._createSelectionElement(o,l,c));var h=s-o-1;if(a.appendChild(this._createSelectionElement(o+1,0,this._terminal.cols,h)),o!==s){var u=n===s?t[0]:this._terminal.cols;a.appendChild(this._createSelectionElement(s,0,u))}}this._selectionContainer.appendChild(a)}}},t.prototype._createSelectionElement=function(e,t,r,i){void 0===i&&(i=1);var n=document.createElement("div");return n.style.height=i*this.dimensions.actualCellHeight+"px",n.style.top=e*this.dimensions.actualCellHeight+"px",n.style.left=t*this.dimensions.actualCellWidth+"px",n.style.width=this.dimensions.actualCellWidth*(r-t)+"px",n},t.prototype.onCursorMove=function(){},t.prototype.onOptionsChanged=function(){this._updateDimensions(),this._injectCss(),this._terminal.refresh(0,this._terminal.rows-1)},t.prototype.clear=function(){this._rowElements.forEach(function(e){return e.innerHTML=""})},t.prototype.renderRows=function(e,t){for(var r=this._terminal,i=r.buffer.ybase+r.buffer.y,n=this._terminal.buffer.x,o=this._terminal.options.cursorBlink,s=e;s<=t;s++){var a=this._rowElements[s];a.innerHTML="";var l=s+r.buffer.ydisp,c=r.buffer.lines.get(l),h=r.options.cursorStyle;a.appendChild(this._rowFactory.createRow(c,l===i,h,n,o,this.dimensions.actualCellWidth,r.cols))}},Object.defineProperty(t.prototype,"_terminalSelector",{get:function(){return"."+l+this._terminalClass},enumerable:!0,configurable:!0}),t.prototype.registerCharacterJoiner=function(e){return-1},t.prototype.deregisterCharacterJoiner=function(e){return!1},t.prototype._onLinkHover=function(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!0)},t.prototype._onLinkLeave=function(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!1)},t.prototype._setCellUnderline=function(e,t,r,i,n,o){for(;e!==t||r!==i;){var s=this._rowElements[r];if(!s)return;var a=s.children[e];a&&(a.style.textDecoration=o?"underline":"none"),++e>=n&&(e=0,r++)}},t}(a.Disposable);t.DomRenderer=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(9),n=r(7);t.BOLD_CLASS="xterm-bold",t.DIM_CLASS="xterm-dim",t.ITALIC_CLASS="xterm-italic",t.UNDERLINE_CLASS="xterm-underline",t.CURSOR_CLASS="xterm-cursor",t.CURSOR_BLINK_CLASS="xterm-cursor-blink",t.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",t.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",t.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";var o=function(){function e(e,t){this._terminalOptions=e,this._document=t,this._workCell=new n.CellData}return e.prototype.createRow=function(e,r,o,s,a,l,c){for(var h=this._document.createDocumentFragment(),u=0,f=Math.min(e.length,c)-1;f>=0;f--)if(e.loadCell(f,this._workCell).getCode()!==n.NULL_CELL_CODE||r&&f===s){u=f+1;break}for(f=0;f<u;f++){e.loadCell(f,this._workCell);var d=this._workCell.getWidth();if(0!==d){var p=this._document.createElement("span");if(d>1&&(p.style.width=l*d+"px"),r&&f===s)switch(p.classList.add(t.CURSOR_CLASS),a&&p.classList.add(t.CURSOR_BLINK_CLASS),o){case"bar":p.classList.add(t.CURSOR_STYLE_BAR_CLASS);break;case"underline":p.classList.add(t.CURSOR_STYLE_UNDERLINE_CLASS);break;default:p.classList.add(t.CURSOR_STYLE_BLOCK_CLASS)}this._workCell.isBold()&&this._terminalOptions.enableBold&&p.classList.add(t.BOLD_CLASS),this._workCell.isItalic()&&p.classList.add(t.ITALIC_CLASS),this._workCell.isDim()&&p.classList.add(t.DIM_CLASS),this._workCell.isUnderline()&&p.classList.add(t.UNDERLINE_CLASS),p.textContent=this._workCell.getChars()||n.WHITESPACE_CELL_CHAR;var m=this._workCell.isInverse();if(this._workCell.isFgRGB()){var g=p.getAttribute("style")||"";g+=(m?"background-":"")+"color:rgb("+n.AttributeData.toColorRGB(this._workCell.getFgColor()).join(",")+");",p.setAttribute("style",g)}else if(this._workCell.isFgPalette()){var _=this._workCell.getFgColor();this._workCell.isBold()&&_<8&&!m&&this._terminalOptions.enableBold&&this._terminalOptions.drawBoldTextInBrightColors&&(_+=8),p.classList.add("xterm-"+(m?"b":"f")+"g-"+_)}else m&&p.classList.add("xterm-bg-"+i.INVERTED_DEFAULT_COLOR);if(this._workCell.isBgRGB()){g=p.getAttribute("style")||"";g+=(m?"":"background-")+"color:rgb("+n.AttributeData.toColorRGB(this._workCell.getBgColor()).join(",")+");",p.setAttribute("style",g)}else this._workCell.isBgPalette()?p.classList.add("xterm-"+(m?"f":"b")+"g-"+this._workCell.getBgColor()):m&&p.classList.add("xterm-fg-"+i.INVERTED_DEFAULT_COLOR);h.appendChild(p)}}return h},e}();t.DomRendererRowFactory=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(13),n={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};t.evaluateKeyboardEvent=function(e,t,r,o){var s={type:0,cancel:!1,key:void 0},a=(e.shiftKey?1:0)|(e.altKey?2:0)|(e.ctrlKey?4:0)|(e.metaKey?8:0);switch(e.keyCode){case 0:"UIKeyInputUpArrow"===e.key?s.key=t?i.C0.ESC+"OA":i.C0.ESC+"[A":"UIKeyInputLeftArrow"===e.key?s.key=t?i.C0.ESC+"OD":i.C0.ESC+"[D":"UIKeyInputRightArrow"===e.key?s.key=t?i.C0.ESC+"OC":i.C0.ESC+"[C":"UIKeyInputDownArrow"===e.key&&(s.key=t?i.C0.ESC+"OB":i.C0.ESC+"[B");break;case 8:if(e.shiftKey){s.key=i.C0.BS;break}if(e.altKey){s.key=i.C0.ESC+i.C0.DEL;break}s.key=i.C0.DEL;break;case 9:if(e.shiftKey){s.key=i.C0.ESC+"[Z";break}s.key=i.C0.HT,s.cancel=!0;break;case 13:s.key=i.C0.CR,s.cancel=!0;break;case 27:s.key=i.C0.ESC,s.cancel=!0;break;case 37:a?(s.key=i.C0.ESC+"[1;"+(a+1)+"D",s.key===i.C0.ESC+"[1;3D"&&(s.key=r?i.C0.ESC+"b":i.C0.ESC+"[1;5D")):s.key=t?i.C0.ESC+"OD":i.C0.ESC+"[D";break;case 39:a?(s.key=i.C0.ESC+"[1;"+(a+1)+"C",s.key===i.C0.ESC+"[1;3C"&&(s.key=r?i.C0.ESC+"f":i.C0.ESC+"[1;5C")):s.key=t?i.C0.ESC+"OC":i.C0.ESC+"[C";break;case 38:a?(s.key=i.C0.ESC+"[1;"+(a+1)+"A",s.key===i.C0.ESC+"[1;3A"&&(s.key=i.C0.ESC+"[1;5A")):s.key=t?i.C0.ESC+"OA":i.C0.ESC+"[A";break;case 40:a?(s.key=i.C0.ESC+"[1;"+(a+1)+"B",s.key===i.C0.ESC+"[1;3B"&&(s.key=i.C0.ESC+"[1;5B")):s.key=t?i.C0.ESC+"OB":i.C0.ESC+"[B";break;case 45:e.shiftKey||e.ctrlKey||(s.key=i.C0.ESC+"[2~");break;case 46:s.key=a?i.C0.ESC+"[3;"+(a+1)+"~":i.C0.ESC+"[3~";break;case 36:s.key=a?i.C0.ESC+"[1;"+(a+1)+"H":t?i.C0.ESC+"OH":i.C0.ESC+"[H";break;case 35:s.key=a?i.C0.ESC+"[1;"+(a+1)+"F":t?i.C0.ESC+"OF":i.C0.ESC+"[F";break;case 33:e.shiftKey?s.type=2:s.key=i.C0.ESC+"[5~";break;case 34:e.shiftKey?s.type=3:s.key=i.C0.ESC+"[6~";break;case 112:s.key=a?i.C0.ESC+"[1;"+(a+1)+"P":i.C0.ESC+"OP";break;case 113:s.key=a?i.C0.ESC+"[1;"+(a+1)+"Q":i.C0.ESC+"OQ";break;case 114:s.key=a?i.C0.ESC+"[1;"+(a+1)+"R":i.C0.ESC+"OR";break;case 115:s.key=a?i.C0.ESC+"[1;"+(a+1)+"S":i.C0.ESC+"OS";break;case 116:s.key=a?i.C0.ESC+"[15;"+(a+1)+"~":i.C0.ESC+"[15~";break;case 117:s.key=a?i.C0.ESC+"[17;"+(a+1)+"~":i.C0.ESC+"[17~";break;case 118:s.key=a?i.C0.ESC+"[18;"+(a+1)+"~":i.C0.ESC+"[18~";break;case 119:s.key=a?i.C0.ESC+"[19;"+(a+1)+"~":i.C0.ESC+"[19~";break;case 120:s.key=a?i.C0.ESC+"[20;"+(a+1)+"~":i.C0.ESC+"[20~";break;case 121:s.key=a?i.C0.ESC+"[21;"+(a+1)+"~":i.C0.ESC+"[21~";break;case 122:s.key=a?i.C0.ESC+"[23;"+(a+1)+"~":i.C0.ESC+"[23~";break;case 123:s.key=a?i.C0.ESC+"[24;"+(a+1)+"~":i.C0.ESC+"[24~";break;default:if(!e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)if(r&&!o||!e.altKey||e.metaKey)r&&!e.altKey&&!e.ctrlKey&&e.metaKey?65===e.keyCode&&(s.type=1):e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&e.keyCode>=48&&1===e.key.length?s.key=e.key:e.key&&e.ctrlKey&&"_"===e.key&&(s.key=i.C0.US);else{var l=n[e.keyCode],c=l&&l[e.shiftKey?1:0];if(c)s.key=i.C0.ESC+c;else if(e.keyCode>=65&&e.keyCode<=90){var h=e.ctrlKey?e.keyCode-64:e.keyCode+32;s.key=i.C0.ESC+String.fromCharCode(h)}}else e.keyCode>=65&&e.keyCode<=90?s.key=String.fromCharCode(e.keyCode-64):32===e.keyCode?s.key=String.fromCharCode(0):e.keyCode>=51&&e.keyCode<=55?s.key=String.fromCharCode(e.keyCode-51+27):56===e.keyCode?s.key=String.fromCharCode(127):219===e.keyCode?s.key=String.fromCharCode(27):220===e.keyCode?s.key=String.fromCharCode(28):221===e.keyCode&&(s.key=String.fromCharCode(29))}return s}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clone=function e(t,r){if(void 0===r&&(r=5),"object"!=typeof t)return t;if(null===t)return null;var i=Array.isArray(t)?[]:{};for(var n in t)i[n]=r<=1?t[n]:e(t[n],r-1);return i}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(7);t.applyWindowsMode=function(e){return e.onLineFeed(function(){var t=e.buffer.lines.get(e.buffer.ybase+e.buffer.y-1).get(e.cols-1);e.buffer.lines.get(e.buffer.ybase+e.buffer.y).isWrapped=t[i.CHAR_DATA_CODE_INDEX]!==i.NULL_CELL_CODE&&t[i.CHAR_DATA_CODE_INDEX]!==i.WHITESPACE_CELL_CODE})}},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(29),s=r(8),a=r(6),l=r(30),c=r(10),h=function(e){function t(t,r,i){var n=e.call(this)||this;if(n._renderer=t,n._rowCount=r,n._isPaused=!1,n._needsFullRefresh=!1,n._canvasWidth=0,n._canvasHeight=0,n._onDimensionsChange=new s.EventEmitter2,n._onRender=new s.EventEmitter2,n._onRefreshRequest=new s.EventEmitter2,n._renderDebouncer=new o.RenderDebouncer(function(e,t){return n._renderRows(e,t)}),n.register(n._renderDebouncer),n._screenDprMonitor=new l.ScreenDprMonitor,n._screenDprMonitor.setListener(function(){return n._renderer.onDevicePixelRatioChange()}),n.register(n._screenDprMonitor),n.register(c.addDisposableDomListener(window,"resize",function(){return n._renderer.onDevicePixelRatioChange()})),"IntersectionObserver"in window){var a=new IntersectionObserver(function(e){return n._onIntersectionChange(e[e.length-1])},{threshold:0});a.observe(i),n.register({dispose:function(){return a.disconnect()}})}return n}return n(t,e),Object.defineProperty(t.prototype,"onDimensionsChange",{get:function(){return this._onDimensionsChange.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onRender",{get:function(){return this._onRender.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onRefreshRequest",{get:function(){return this._onRefreshRequest.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dimensions",{get:function(){return this._renderer.dimensions},enumerable:!0,configurable:!0}),t.prototype._onIntersectionChange=function(e){this._isPaused=0===e.intersectionRatio,!this._isPaused&&this._needsFullRefresh&&(this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)},t.prototype.refreshRows=function(e,t){this._isPaused?this._needsFullRefresh=!0:this._renderDebouncer.refresh(e,t,this._rowCount)},t.prototype._renderRows=function(e,t){this._renderer.renderRows(e,t),this._onRender.fire({start:e,end:t})},t.prototype.resize=function(e,t){this._rowCount=t,this._fireOnCanvasResize()},t.prototype.changeOptions=function(){this._renderer.onOptionsChanged(),this._fireOnCanvasResize()},t.prototype._fireOnCanvasResize=function(){this._renderer.dimensions.canvasWidth===this._canvasWidth&&this._renderer.dimensions.canvasHeight===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions)},t.prototype.setRenderer=function(e){this._renderer.dispose(),this._renderer=e},t.prototype._fullRefresh=function(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount)},t.prototype.setColors=function(e){this._renderer.setColors(e),this._fullRefresh()},t.prototype.onDevicePixelRatioChange=function(){this._renderer.onDevicePixelRatioChange()},t.prototype.onResize=function(e,t){this._renderer.onResize(e,t),this._fullRefresh()},t.prototype.onCharSizeChanged=function(){this._renderer.onCharSizeChanged()},t.prototype.onBlur=function(){this._renderer.onBlur()},t.prototype.onFocus=function(){this._renderer.onFocus()},t.prototype.onSelectionChanged=function(e,t,r){this._renderer.onSelectionChanged(e,t,r)},t.prototype.onCursorMove=function(){this._renderer.onCursorMove()},t.prototype.onOptionsChanged=function(){this._renderer.onOptionsChanged()},t.prototype.clear=function(){this._renderer.clear()},t.prototype.registerCharacterJoiner=function(e){return this._renderer.registerCharacterJoiner(e)},t.prototype.deregisterCharacterJoiner=function(e){return this._renderer.deregisterCharacterJoiner(e)},t}(a.Disposable);t.RenderCoordinator=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._addons=[]}return e.prototype.dispose=function(){for(var e=this._addons.length-1;e>=0;e--)this._addons[e].instance.dispose()},e.prototype.loadAddon=function(e,t){var r=this,i={instance:t,dispose:t.dispose,isDisposed:!1};this._addons.push(i),t.dispose=function(){return r._wrappedAddonDispose(i)},t.activate(e)},e.prototype._wrappedAddonDispose=function(e){if(!e.isDisposed){for(var t=-1,r=0;r<this._addons.length;r++)if(this._addons[r]===e){t=r;break}if(-1===t)throw new Error("Could not dispose an addon that has not been loaded");e.isDisposed=!0,e.dispose.apply(e.instance),this._addons.splice(t,1)}},e}();t.AddonManager=i},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r}]]);